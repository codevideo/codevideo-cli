{"version":3,"file":"fafb94f6-fa111aa5471a68a21972.js","mappings":"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","sources":["webpack://codevideo-ide-react-examples/./node_modules/@fullstackcraftllc/codevideo-ide-react/dist/index.js"],"sourcesContent":["import { jsx, jsxs, Fragment } from 'react/jsx-runtime';\nimport { useState, useRef, useEffect, useMemo } from 'react';\nimport { Editor } from '@monaco-editor/react';\nimport { Box, Flex, Text, TextField, Link, Kbd, Code, Button } from '@radix-ui/themes';\nimport { extractActionsFromProject, isRepeatableAction } from '@fullstackcraftllc/codevideo-types';\nimport { CodeGray, License, Markdown, PDF, Text as Text$1, Rust, Python, Git, Gear, Reactts, Reactjs, Cplus, Csharp, Yaml, Shell, Go, TypeScript, Js, Folder } from '@react-symbols/icons';\nimport { ExclamationTriangleIcon } from '@radix-ui/react-icons';\nimport { Marked } from 'marked';\nimport { markedHighlight } from 'marked-highlight';\nimport hljs from 'highlight.js';\nimport DOMPurify from 'dompurify';\nimport * as esbuild from 'esbuild-wasm';\nimport { VirtualIDE } from '@fullstackcraftllc/codevideo-virtual-ide';\n\nvar CODEVIDEO_IDE_ID = 'codevideo-ide-react'; // real HTML ID used to identify the root element of the IDE\nvar LONG_PAUSE_MS = 5000;\nvar STANDARD_PAUSE_MS = 1000;\nvar KEYBOARD_TYPING_PAUSE_MS = 50;\nvar DEFAULT_CARET_POSITION = { row: 1, col: 1 };\nvar DEFAULT_MOUSE_POSITION = { x: 960, y: 540 }; // assuming screen is always 1920x1080, default position is center of screen\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\r\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nfunction __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\ntypeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\n\nfunction EditorTabs(props) {\n    var editors = props.editors, theme = props.theme, currentEditor = props.currentEditor;\n    // if editors are empty, render fixed height to prevent layout shift\n    if (editors.length === 0) {\n        return jsx(Box, { style: {\n                backgroundColor: theme === 'light' ? 'var(--gray-5)' : 'var(--gray-4)',\n                height: '30px',\n                borderBottom: '1px solid var(--gray-7)',\n            } });\n    }\n    return (jsx(Flex, { \"data-testid\": \"editor-tabs\", style: {\n            backgroundColor: theme === 'light' ? 'var(--gray-5)' : 'var(--gray-4)',\n            height: '40px',\n            borderBottom: '1px solid var(--gray-7)',\n            pointerEvents: 'none',\n            userSelect: 'none',\n        }, children: editors.map(function (editor) {\n            var absoluteFileName = editor.filename;\n            var baseFileName = absoluteFileName.split('/').pop();\n            var isActive = (currentEditor === null || currentEditor === void 0 ? void 0 : currentEditor.filename) === editor.filename;\n            return (jsxs(Flex, { \"data-codevideo-id\": \"editor-tab-\".concat(absoluteFileName), align: \"center\", px: \"4\", py: \"3\", style: {\n                    borderRight: '1px solid var(--gray-7)',\n                    backgroundColor: isActive\n                        ? (theme === 'light' ? 'var(--gray-3)' : 'var(--gray-6)')\n                        : 'transparent',\n                    borderBottom: isActive ? '2px solid var(--mint-9)' : 'none',\n                    position: 'relative'\n                }, children: [jsx(Text, { style: {\n                            fontFamily: 'Fira Code, monospace',\n                            color: isActive\n                                ? (theme === 'light' ? 'var(--gray-12)' : 'var(--gray-12)')\n                                : '#CCCECC',\n                            fontWeight: isActive ? '500' : '400'\n                        }, children: baseFileName }), editor.isSaved ? (jsx(Box, { \"data-codevideo-id\": \"editor-tab-close-\".concat(absoluteFileName), ml: \"2\", style: {\n                            color: isActive ? 'var(--gray-10)' : 'var(--gray-8)',\n                            padding: 0,\n                            lineHeight: 1,\n                            minWidth: 'auto',\n                        }, children: \"\\u00D7\" })) : (jsx(Box, { \"data-codevideo-id\": \"editor-tab-close-\".concat(absoluteFileName), ml: \"2\", style: {\n                            width: '8px',\n                            height: '8px',\n                            backgroundColor: isActive ? 'var(--mint-9)' : 'var(--gray-8)',\n                            borderRadius: '9999px'\n                        } }))] }, editor.filename));\n        }) }));\n}\n\nvar FILE_EXPLORER_ID = 'file-explorer';\nvar EDITOR_AREA_ID = 'editor-area'; // includes both the editor tabs and the currently opened editor\nvar EDITOR_ID = 'editor';\nvar TERMINAL_ID = 'terminal';\nvar SLIDE_ID = 'slide';\nvar EXTERNAL_WEB_VIEWER_ID = 'external-web-viewer';\n\nvar ExternalWebViewer = function (props) {\n    var url = props.url, mode = props.mode, scrollPosition = props.scrollPosition, _a = props.scrollDuration, scrollDuration = _a === void 0 ? 1000 : _a;\n    var _b = useState(false), hasError = _b[0], setHasError = _b[1];\n    var _c = useState(false), hasLoaded = _c[0], setHasLoaded = _c[1];\n    var iframeRef = useRef(null);\n    var prevScrollPositionRef = useRef(0);\n    // Start a timeout to detect load failures\n    useEffect(function () {\n        // If the iframe hasn't loaded after 10 seconds, assume it failed\n        var timer = setTimeout(function () {\n            if (!hasLoaded) {\n                setHasError(true);\n            }\n        }, 10000);\n        return function () { return clearTimeout(timer); };\n    }, [hasLoaded]);\n    // Handle scrolling when scrollPosition changes\n    useEffect(function () {\n        if (!hasLoaded || !iframeRef.current)\n            return;\n        try {\n            var iframeWindow_1 = iframeRef.current.contentWindow;\n            if (!iframeWindow_1)\n                return;\n            if (mode === 'step') {\n                // Immediate scroll for step mode\n                iframeWindow_1.scrollTo({\n                    top: scrollPosition,\n                    behavior: 'auto'\n                });\n            }\n            else {\n                // Smooth scroll for replay mode\n                var startPosition_1 = prevScrollPositionRef.current;\n                var startTime_1 = performance.now();\n                var animateScroll_1 = function (currentTime) {\n                    var elapsedTime = currentTime - startTime_1;\n                    if (elapsedTime >= scrollDuration) {\n                        iframeWindow_1.scrollTo({\n                            top: scrollPosition,\n                            behavior: 'auto'\n                        });\n                        return;\n                    }\n                    // Calculate scroll position using easeInOutCubic\n                    var progress = elapsedTime / scrollDuration;\n                    var t = progress < 0.5\n                        ? 4 * progress * progress * progress\n                        : 1 - Math.pow(-2 * progress + 2, 3) / 2;\n                    var newPosition = startPosition_1 + (scrollPosition - startPosition_1) * t;\n                    iframeWindow_1.scrollTo({\n                        top: newPosition,\n                        behavior: 'auto'\n                    });\n                    requestAnimationFrame(animateScroll_1);\n                };\n                requestAnimationFrame(animateScroll_1);\n            }\n            // Store current scroll position for next animation\n            prevScrollPositionRef.current = scrollPosition;\n        }\n        catch (error) {\n            console.error(\"Failed to scroll iframe content:\", JSON.stringify(error));\n        }\n    }, [scrollPosition, mode, hasLoaded, scrollDuration]);\n    return (jsx(Box, { \"data-codevideo-id\": EXTERNAL_WEB_VIEWER_ID, \"data-testid\": \"external-web-viewer\", style: { width: '100%', height: '100vh' }, children: hasError ? (jsx(Flex, { align: \"center\", justify: \"center\", style: { height: '100%' }, children: jsxs(Text, { size: \"5\", style: { color: 'var(--gray-10)' }, children: [\"Failed to load external content from \", url, \". The site may be invalid or not allow iframes.\"] }) })) : (jsx(\"iframe\", { ref: iframeRef, src: url, title: \"External Web Viewer\", style: { width: '100%', height: '100%', border: 0 }, sandbox: \"allow-same-origin allow-scripts allow-popups\", onLoad: function () { return setHasLoaded(true); }, onError: function () { return setHasError(true); } })) }));\n};\n\nvar sleep = function (ms) { return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n        return [2 /*return*/, new Promise(function (resolve) { return setTimeout(resolve, ms); })];\n    });\n}); };\n\n/**\n * Speaks the text using the local koroko speech at localhost:3000\n * @param text\n * @param volume\n */\nvar speakText = function (text, volume, mp3Url) { return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n        // // Initialize the TTS instance if it doesn't exist\n        // if (!tts) {\n        //   tts = await KokoroTTS.from_pretrained(model_id, {\n        //     dtype: \"fp32\", // Options: \"fp32\", \"fp16\", \"q8\", \"q4\", \"q4f16\"\n        //     device: \"webgpu\", // Options: \"wasm\", \"webgpu\" (web) or \"cpu\" (node). If using \"webgpu\", we recommend using dtype=\"fp32\".\n        //   });\n        // }\n        // if there is an mp3Url, use the fallback method\n        if (mp3Url) {\n            return [2 /*return*/, speakTextFallback(text, volume, mp3Url)];\n        }\n        // const audio = await tts.generate(text, {\n        //   voice: \"af_sky\",\n        // });\n        // // First, stop any ongoing speech\n        // stopSpeaking();\n        // // Convert RawAudio to Blob\n        // const audioBlob = new Blob([audio.audio], { type: 'audio/wav' });\n        // // Create an audio URL from the generated audio\n        // const audioUrl = URL.createObjectURL(audioBlob);\n        // // Create and play the audio\n        // const audioElement = new Audio(audioUrl);\n        // audioElement.volume = volume;\n        // // Set up event listeners\n        // return new Promise<void>((resolve, reject) => {\n        //   audioElement.onended = () => {\n        //     URL.revokeObjectURL(audioUrl); // Clean up the object URL\n        //     resolve();\n        //   };\n        //   audioElement.onerror = (event) => {\n        //     URL.revokeObjectURL(audioUrl); // Clean up the object URL\n        //     reject(new Error(`Audio playback error: ${event}`));\n        //   };\n        //   // Play the audio\n        //   audioElement.play().catch(error => {\n        //     console.error(\"Failed to play audio:\", error);\n        //     reject(error);\n        //   });\n        // });\n        // if no mp3Url is provided, use the local koroko speech API\n        return [2 /*return*/, new Promise(function (resolve, reject) { return __awaiter(void 0, void 0, void 0, function () {\n                var response, audioBlob, audioUrl_1, audio, error_1, fallbackError_1;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            _a.trys.push([0, 4, , 9]);\n                            // First, stop any ongoing speech\n                            stopSpeaking();\n                            return [4 /*yield*/, fetch('http://localhost:3000/api/v1/audio/speech', {\n                                    method: 'POST',\n                                    headers: {\n                                        'accept': '*/*',\n                                        'Authorization': 'Bearer 123456',\n                                        'Content-Type': 'application/json',\n                                    },\n                                    body: JSON.stringify({\n                                        model: \"model\",\n                                        voice: \"af_sky\",\n                                        input: text,\n                                        response_format: \"mp3\",\n                                        speed: 1.1\n                                    })\n                                })];\n                        case 1:\n                            response = _a.sent();\n                            if (!response.ok) {\n                                throw new Error(\"HTTP error! status: \".concat(response.status));\n                            }\n                            return [4 /*yield*/, response.blob()];\n                        case 2:\n                            audioBlob = _a.sent();\n                            audioUrl_1 = URL.createObjectURL(audioBlob);\n                            audio = new Audio(audioUrl_1);\n                            audio.volume = volume;\n                            // Set up event listeners\n                            audio.onended = function () {\n                                URL.revokeObjectURL(audioUrl_1); // Clean up the object URL\n                                resolve();\n                            };\n                            audio.onerror = function (event) {\n                                URL.revokeObjectURL(audioUrl_1); // Clean up the object URL\n                                reject(new Error(\"Audio playback error: \".concat(event)));\n                            };\n                            // Play the audio\n                            return [4 /*yield*/, audio.play()];\n                        case 3:\n                            // Play the audio\n                            _a.sent();\n                            return [3 /*break*/, 9];\n                        case 4:\n                            error_1 = _a.sent();\n                            // If the API call fails, fall back to the browser's speech synthesis\n                            console.warn('Local speech API failed, falling back to browser speech synthesis:', error_1);\n                            _a.label = 5;\n                        case 5:\n                            _a.trys.push([5, 7, , 8]);\n                            return [4 /*yield*/, speakTextFallback(text, volume)];\n                        case 6:\n                            _a.sent();\n                            resolve();\n                            return [3 /*break*/, 8];\n                        case 7:\n                            fallbackError_1 = _a.sent();\n                            reject(fallbackError_1);\n                            return [3 /*break*/, 8];\n                        case 8: return [3 /*break*/, 9];\n                        case 9: return [2 /*return*/];\n                    }\n                });\n            }); })];\n    });\n}); };\n/**\n * Speaks the given text, canceling any currently playing speech first\n * @param text The text to speak\n * @returns A promise that resolves when speech is finished\n */\nvar speakTextFallback = function (text, volume, mp3Url) { return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n        return [2 /*return*/, new Promise(function (resolve, reject) {\n                // First, cancel any ongoing speech or audio playback\n                stopSpeaking();\n                // if a url to an mp3 is provided, play the audio\n                if (mp3Url) {\n                    console.log(\"Creating audio element for MP3 URL:\", mp3Url);\n                    console.log(\"Volume\", volume);\n                    var audioElement = new Audio(mp3Url);\n                    audioElement.volume = volume;\n                    audioElement.onended = function () {\n                        resolve();\n                    };\n                    audioElement.onerror = function (e) {\n                        if (typeof e === 'string') {\n                            console.error(\"Audio playback error:\", e);\n                        }\n                        else {\n                            try {\n                                // e is an Event\n                                console.error(\"Audio error event:\", e.type);\n                                // Access specific properties if available, for instance:\n                                if (e.target && e.target.error) {\n                                    console.error(\"Error details:\", e.target.error);\n                                }\n                            }\n                            catch (e) {\n                                console.error(\"Failed to extract error details:\", e);\n                            }\n                        }\n                        resolve(); // Resolve instead of rejecting to prevent errors from bubbling up\n                    };\n                    audioElement.play().catch(function (error) { return __awaiter(void 0, void 0, void 0, function () {\n                        var messageHandle, message, e_1;\n                        return __generator(this, function (_a) {\n                            switch (_a.label) {\n                                case 0:\n                                    _a.trys.push([0, 3, , 4]);\n                                    if (error instanceof Error) {\n                                        console.error(\"\".concat(error.name, \": \").concat(error.message, \"\\nStack: \").concat(error.stack));\n                                    }\n                                    else {\n                                        console.error(String(error));\n                                    }\n                                    // Option 1: Convert error to string directly\n                                    console.error(String(error));\n                                    return [4 /*yield*/, error.getProperty('message')];\n                                case 1:\n                                    messageHandle = _a.sent();\n                                    return [4 /*yield*/, messageHandle.jsonValue()];\n                                case 2:\n                                    message = _a.sent();\n                                    console.error(\"Failed to play audio:\", message);\n                                    return [3 /*break*/, 4];\n                                case 3:\n                                    e_1 = _a.sent();\n                                    console.error(\"Failed to extract error message:\", e_1);\n                                    return [3 /*break*/, 4];\n                                case 4:\n                                    resolve(); // Resolve despite the error\n                                    return [2 /*return*/];\n                            }\n                        });\n                    }); });\n                    return;\n                }\n                // else default to speech synthesis\n                var speechSynthesis = window.speechSynthesis;\n                // Create a new SpeechSynthesisUtterance object\n                var utterance = new SpeechSynthesisUtterance(text);\n                // Set the volume\n                utterance.volume = volume;\n                // Resolve the promise when speech is done\n                utterance.onend = function () {\n                    resolve();\n                };\n                // Handle any errors\n                utterance.onerror = function (event) {\n                    // reject(`Speech synthesis error: ${event.error}`);\n                    resolve();\n                };\n                // Speak the text\n                speechSynthesis.speak(utterance);\n            })];\n    });\n}); };\n/**\n * Immediately stops any ongoing speech synthesis or audio playback\n */\nvar stopSpeaking = function () {\n    // stop speech synthesis\n    var speechSynthesis = window.speechSynthesis;\n    // Cancel all queued utterances\n    speechSynthesis.cancel();\n    // stop all audio playbacks\n    var audioElements = document.getElementsByTagName('audio');\n    for (var i = 0; i < audioElements.length; i++) {\n        audioElements[i].pause();\n    }\n};\n\nfunction getLanguageFromFilename(filename) {\n    var _a;\n    if (!filename)\n        return 'plaintext';\n    var extension = (_a = filename.split('.').pop()) === null || _a === void 0 ? void 0 : _a.toLowerCase();\n    var extensionMap = {\n        'js': 'javascript',\n        'jsx': 'javascript',\n        'ts': 'typescript',\n        'tsx': 'typescript',\n        'py': 'python',\n        'html': 'html',\n        'css': 'css',\n        'json': 'json',\n        'md': 'markdown',\n        'php': 'php',\n        'java': 'java',\n        'c': 'c',\n        'cpp': 'cpp',\n        'cs': 'csharp',\n        'go': 'go',\n        'rb': 'ruby',\n        'rs': 'rust',\n        'sh': 'shell',\n        'sql': 'sql',\n        'yaml': 'yaml',\n        'yml': 'yaml',\n        // Add more mappings as needed\n    };\n    return extension && extension in extensionMap ? extensionMap[extension] : 'plaintext';\n}\n\nfunction FileIcon(props) {\n    var _a;\n    var filename = props.filename;\n    if (!filename) {\n        return jsx(CodeGray, { height: \"20\" });\n    }\n    var ext = (_a = filename.split('.').pop()) === null || _a === void 0 ? void 0 : _a.toLowerCase();\n    if (filename.toUpperCase() === 'LICENSE') {\n        return jsx(License, { height: \"20\" });\n    }\n    if (filename.toUpperCase() === 'README') {\n        return jsx(Markdown, { height: \"20\" });\n    }\n    switch (ext) {\n        case 'js':\n            return jsx(Js, { height: \"20\" });\n        case 'ts':\n            return jsx(TypeScript, { height: \"20\" });\n        case 'go':\n            return jsx(Go, { height: \"20\" });\n        case 'sh':\n        case 'zsh':\n            return jsx(Shell, { height: \"20\" });\n        case 'yaml':\n            return jsx(Yaml, { height: \"20\" });\n        case 'cs':\n            return jsx(Csharp, { height: \"20\" });\n        case 'cpp':\n            return jsx(Cplus, { height: \"20\" });\n        case 'jsx':\n            return jsx(Reactjs, { height: \"20\" });\n        case 'tsx':\n            return jsx(Reactts, { height: \"20\" });\n        case 'env':\n        case 'toml':\n            return jsx(Gear, { height: \"20\" });\n        case 'gitignore':\n            return jsx(Git, { height: \"20\" });\n        case 'md':\n            return jsx(Markdown, { height: \"20\" });\n        case 'py':\n            return jsx(Python, { height: \"20\" });\n        case 'rs':\n            return jsx(Rust, { height: \"20\" });\n        case \"txt\":\n            return jsx(Text$1, { height: \"20\" });\n        case \"md\":\n            return jsx(Markdown, { height: \"20\" });\n        case \"pdf\":\n            return jsx(PDF, { height: \"20\" });\n        default:\n            return jsx(CodeGray, { height: \"20\" });\n    }\n}\n\nvar FileExplorerContextMenu = function (props) {\n    var isVisible = props.isVisible, currentMousePosition = props.currentMousePosition;\n    var newFileRef = useRef(null);\n    var newFolderRef = useRef(null);\n    var _a = useState(null), hoveredItem = _a[0], setHoveredItem = _a[1];\n    var _b = useState(DEFAULT_MOUSE_POSITION), menuPosition = _b[0], setMenuPosition = _b[1];\n    // when is visible is true, set the menu position to the current mouse position\n    useEffect(function () {\n        if (isVisible && currentMousePosition &&\n            currentMousePosition.x !== undefined && currentMousePosition.y !== undefined) {\n            setMenuPosition({\n                x: currentMousePosition.x,\n                y: currentMousePosition.y\n            });\n        }\n    }, [isVisible]); // Only depend on isVisible, not currentMousePosition\n    useEffect(function () {\n        if (!isVisible || !currentMousePosition ||\n            currentMousePosition.x === undefined || currentMousePosition.y === undefined)\n            return;\n        // Check if mouse coordinates intersect with menu items\n        var checkIntersection = function () {\n            if (newFileRef.current) {\n                var fileRect = newFileRef.current.getBoundingClientRect();\n                var isFileHovered = currentMousePosition.x >= fileRect.left &&\n                    currentMousePosition.x <= fileRect.right &&\n                    currentMousePosition.y >= fileRect.top &&\n                    currentMousePosition.y <= fileRect.bottom;\n                if (isFileHovered) {\n                    setHoveredItem('file');\n                    return;\n                }\n            }\n            if (newFolderRef.current) {\n                var folderRect = newFolderRef.current.getBoundingClientRect();\n                var isFolderHovered = currentMousePosition.x >= folderRect.left &&\n                    currentMousePosition.x <= folderRect.right &&\n                    currentMousePosition.y >= folderRect.top &&\n                    currentMousePosition.y <= folderRect.bottom;\n                if (isFolderHovered) {\n                    setHoveredItem('folder');\n                    return;\n                }\n            }\n            setHoveredItem(null);\n        };\n        checkIntersection();\n    }, [isVisible, currentMousePosition]);\n    if (!isVisible)\n        return null;\n    return (jsx(Box, { style: {\n            position: 'fixed',\n            left: \"\".concat(menuPosition.x, \"px\"),\n            top: \"\".concat(menuPosition.y, \"px\"),\n            backgroundColor: 'var(--gray-4)',\n            border: '1px solid var(--mint-7)',\n            borderRadius: 'var(--radius-2)',\n            width: '180px',\n            boxShadow: 'var(--shadow-3)',\n            zIndex: 1000,\n            overflow: 'hidden',\n        }, children: jsxs(Flex, { direction: \"column\", children: [jsx(Box, { \"data-codevideo-id\": \"file-explorer-context-menu-new-file\", ref: newFileRef, style: {\n                        padding: '8px 12px',\n                        cursor: 'pointer',\n                        backgroundColor: hoveredItem === 'file' ? 'var(--mint-3)' : 'transparent',\n                        userSelect: 'none',\n                    }, children: jsx(Text, { size: \"2\", children: \"New File...\" }) }), jsx(Box, { \"data-codevideo-id\": \"file-explorer-context-menu-new-folder\", ref: newFolderRef, style: {\n                        padding: '8px 12px',\n                        cursor: 'pointer',\n                        backgroundColor: hoveredItem === 'folder' ? 'var(--mint-3)' : 'transparent',\n                        userSelect: 'none',\n                    }, children: jsx(Text, { size: \"2\", children: \"New Folder...\" }) })] }) }));\n};\n\nvar FileContextMenu = function (props) {\n    var isVisible = props.isVisible, currentMousePosition = props.currentMousePosition;\n    var renameRef = useRef(null);\n    var deleteRef = useRef(null);\n    var _a = useState(null), hoveredItem = _a[0], setHoveredItem = _a[1];\n    var _b = useState(DEFAULT_MOUSE_POSITION), menuPosition = _b[0], setMenuPosition = _b[1];\n    // Set the menu position when it becomes visible\n    useEffect(function () {\n        if (isVisible && currentMousePosition &&\n            currentMousePosition.x !== undefined && currentMousePosition.y !== undefined) {\n            setMenuPosition({\n                x: currentMousePosition.x,\n                y: currentMousePosition.y\n            });\n        }\n    }, [isVisible]);\n    useEffect(function () {\n        if (!isVisible || !currentMousePosition ||\n            currentMousePosition.x === undefined || currentMousePosition.y === undefined)\n            return;\n        // Check if mouse coordinates intersect with menu items\n        var checkIntersection = function () {\n            if (renameRef.current) {\n                var fileRect = renameRef.current.getBoundingClientRect();\n                var isFileHovered = currentMousePosition.x >= fileRect.left &&\n                    currentMousePosition.x <= fileRect.right &&\n                    currentMousePosition.y >= fileRect.top &&\n                    currentMousePosition.y <= fileRect.bottom;\n                if (isFileHovered) {\n                    setHoveredItem('rename');\n                    return;\n                }\n            }\n            if (deleteRef.current) {\n                var folderRect = deleteRef.current.getBoundingClientRect();\n                var isFolderHovered = currentMousePosition.x >= folderRect.left &&\n                    currentMousePosition.x <= folderRect.right &&\n                    currentMousePosition.y >= folderRect.top &&\n                    currentMousePosition.y <= folderRect.bottom;\n                if (isFolderHovered) {\n                    setHoveredItem('delete');\n                    return;\n                }\n            }\n            setHoveredItem(null);\n        };\n        checkIntersection();\n    }, [isVisible, currentMousePosition]);\n    if (!isVisible)\n        return null;\n    return (jsx(Box, { style: {\n            position: 'fixed',\n            left: \"\".concat(menuPosition.x, \"px\"),\n            top: \"\".concat(menuPosition.y, \"px\"),\n            backgroundColor: 'var(--gray-4)',\n            border: '1px solid var(--mint-7)',\n            borderRadius: 'var(--radius-2)',\n            width: '180px',\n            boxShadow: 'var(--shadow-3)',\n            zIndex: 1000,\n            overflow: 'hidden',\n        }, children: jsxs(Flex, { direction: \"column\", children: [jsx(Box, { \"data-codevideo-id\": \"file-explorer-file-context-menu-rename\", ref: renameRef, style: {\n                        padding: '8px 12px',\n                        cursor: 'pointer',\n                        backgroundColor: hoveredItem === 'rename' ? 'var(--mint-3)' : 'transparent',\n                        userSelect: 'none',\n                    }, children: jsx(Text, { size: \"2\", children: \"Rename...\" }) }), jsx(Box, { \"data-codevideo-id\": \"file-explorer-file-context-menu-delete\", ref: deleteRef, style: {\n                        padding: '8px 12px',\n                        cursor: 'pointer',\n                        backgroundColor: hoveredItem === 'delete' ? 'var(--mint-3)' : 'transparent',\n                        userSelect: 'none',\n                    }, children: jsx(Text, { size: \"2\", children: \"Delete\" }) })] }) }));\n};\n\nvar FolderContextMenu = function (props) {\n    var isVisible = props.isVisible, currentMousePosition = props.currentMousePosition;\n    var newFileRef = useRef(null);\n    var newFolderRef = useRef(null);\n    var renameRef = useRef(null);\n    var deleteRef = useRef(null);\n    var _a = useState(null), hoveredItem = _a[0], setHoveredItem = _a[1];\n    var _b = useState(DEFAULT_MOUSE_POSITION), menuPosition = _b[0], setMenuPosition = _b[1];\n    // Set the menu position when it becomes visible\n    useEffect(function () {\n        if (isVisible && currentMousePosition &&\n            currentMousePosition.x !== undefined && currentMousePosition.y !== undefined) {\n            setMenuPosition({\n                x: currentMousePosition.x,\n                y: currentMousePosition.y\n            });\n        }\n    }, [isVisible]);\n    useEffect(function () {\n        if (!isVisible || !currentMousePosition ||\n            currentMousePosition.x === undefined || currentMousePosition.y === undefined)\n            return;\n        // Check if mouse coordinates intersect with menu items\n        var checkIntersection = function () {\n            if (newFileRef.current) {\n                var fileRect = newFileRef.current.getBoundingClientRect();\n                var isFileHovered = currentMousePosition.x >= fileRect.left &&\n                    currentMousePosition.x <= fileRect.right &&\n                    currentMousePosition.y >= fileRect.top &&\n                    currentMousePosition.y <= fileRect.bottom;\n                if (isFileHovered) {\n                    setHoveredItem('file');\n                    return;\n                }\n            }\n            if (newFolderRef.current) {\n                var folderRect = newFolderRef.current.getBoundingClientRect();\n                var isFolderHovered = currentMousePosition.x >= folderRect.left &&\n                    currentMousePosition.x <= folderRect.right &&\n                    currentMousePosition.y >= folderRect.top &&\n                    currentMousePosition.y <= folderRect.bottom;\n                if (isFolderHovered) {\n                    setHoveredItem('folder');\n                    return;\n                }\n            }\n            if (renameRef.current) {\n                var deleteRect = renameRef.current.getBoundingClientRect();\n                var isRenameHovered = currentMousePosition.x >= deleteRect.left &&\n                    currentMousePosition.x <= deleteRect.right &&\n                    currentMousePosition.y >= deleteRect.top &&\n                    currentMousePosition.y <= deleteRect.bottom;\n                if (isRenameHovered) {\n                    setHoveredItem('rename');\n                    return;\n                }\n            }\n            if (deleteRef.current) {\n                var deleteRect = deleteRef.current.getBoundingClientRect();\n                var isDeleteHovered = currentMousePosition.x >= deleteRect.left &&\n                    currentMousePosition.x <= deleteRect.right &&\n                    currentMousePosition.y >= deleteRect.top &&\n                    currentMousePosition.y <= deleteRect.bottom;\n                if (isDeleteHovered) {\n                    setHoveredItem('delete');\n                    return;\n                }\n            }\n            setHoveredItem(null);\n        };\n        checkIntersection();\n    }, [isVisible, currentMousePosition]);\n    if (!isVisible)\n        return null;\n    return (jsx(Box, { style: {\n            position: 'fixed',\n            left: \"\".concat(menuPosition.x, \"px\"),\n            top: \"\".concat(menuPosition.y, \"px\"),\n            backgroundColor: 'var(--gray-4)',\n            border: '1px solid var(--mint-7)',\n            borderRadius: 'var(--radius-2)',\n            width: '180px',\n            boxShadow: 'var(--shadow-3)',\n            zIndex: 1000,\n            overflow: 'hidden',\n        }, children: jsxs(Flex, { direction: \"column\", children: [jsx(Box, { \"data-codevideo-id\": \"file-explorer-folder-context-menu-new-file\", ref: newFileRef, style: {\n                        padding: '8px 12px',\n                        cursor: 'pointer',\n                        backgroundColor: hoveredItem === 'file' ? 'var(--mint-3)' : 'transparent',\n                        userSelect: 'none',\n                    }, children: jsx(Text, { size: \"2\", children: \"New File...\" }) }), jsx(Box, { \"data-codevideo-id\": \"file-explorer-folder-context-menu-new-folder\", ref: newFolderRef, style: {\n                        padding: '8px 12px',\n                        cursor: 'pointer',\n                        backgroundColor: hoveredItem === 'folder' ? 'var(--mint-3)' : 'transparent',\n                        userSelect: 'none',\n                    }, children: jsx(Text, { size: \"2\", children: \"New Folder...\" }) }), jsx(Box, { \"data-codevideo-id\": \"file-explorer-folder-context-menu-rename\", ref: renameRef, style: {\n                        padding: '8px 12px',\n                        cursor: 'pointer',\n                        backgroundColor: hoveredItem === 'rename' ? 'var(--mint-3)' : 'transparent',\n                        userSelect: 'none',\n                    }, children: jsx(Text, { size: \"2\", children: \"Rename...\" }) }), jsx(Box, { \"data-codevideo-id\": \"file-explorer-folder-context-menu-delete\", ref: deleteRef, style: {\n                        padding: '8px 12px',\n                        cursor: 'pointer',\n                        backgroundColor: hoveredItem === 'delete' ? 'var(--mint-3)' : 'transparent',\n                        userSelect: 'none',\n                    }, children: jsx(Text, { size: \"2\", children: \"Delete\" }) })] }) }));\n};\n\nfunction FileExplorer(props) {\n    var theme = props.theme, isFileExplorerContextMenuVisible = props.isFileExplorerContextMenuVisible, isFileContextMenuVisible = props.isFileContextMenuVisible, isFolderContextMenuVisible = props.isFolderContextMenuVisible, isNewFileInputVisible = props.isNewFileInputVisible, isNewFolderInputVisible = props.isNewFolderInputVisible, currentMousePosition = props.currentMousePosition, newFolderInputValue = props.newFolderInputValue, newFileInputValue = props.newFileInputValue, currentFileName = props.currentFileName, originalFileBeingRenamed = props.originalFileBeingRenamed, originalFolderBeingRenamed = props.originalFolderBeingRenamed, renameFileInputValue = props.renameFileInputValue, renameFolderInputValue = props.renameFolderInputValue, currentHoveredFileName = props.currentHoveredFileName, currentHoveredFolderName = props.currentHoveredFolderName, fileStructure = props.fileStructure, fileExplorerWidth = props.fileExplorerWidth, newFileParentPath = props.newFileParentPath, newFolderParentPath = props.newFolderParentPath;\n    // For debugging\n    // console.log('[FileExplorer] Props state:');\n    // console.log('- isNewFileInputVisible:', isNewFileInputVisible);\n    // console.log('- isNewFolderInputVisible:', isNewFolderInputVisible);\n    // console.log('- newFileInputValue:', newFileInputValue);\n    // console.log('- newFolderInputValue:', newFolderInputValue);\n    // console.log('- newFileParentPath:', newFileParentPath);\n    // console.log('- newFolderParentPath:', newFolderParentPath);\n    var getEffectiveParentPath = function (inputType) {\n        if (inputType === 'file') {\n            // If newFileParentPath is set, use it\n            if (newFileParentPath) {\n                return newFileParentPath;\n            }\n            // Otherwise, if only newFolderParentPath is set, use that instead\n            // (happens when right-clicking a folder and selecting \"New File...\")\n            else if (newFolderParentPath) {\n                console.log('[FileExplorer] Using newFolderParentPath for file input:', newFolderParentPath);\n                return newFolderParentPath;\n            }\n            // Fallback to empty string (root level)\n            return '';\n        }\n        else {\n            // For folders, similar logic but prioritize newFolderParentPath\n            if (newFolderParentPath) {\n                return newFolderParentPath;\n            }\n            else if (newFileParentPath) {\n                console.log('[FileExplorer] Using newFileParentPath for folder input:', newFileParentPath);\n                return newFileParentPath;\n            }\n            return '';\n        }\n    };\n    var resolveFileOrFolderText = function (name) {\n        // if we're currently renaming this file, show as input of the renamefileinputvalue\n        if (name === originalFileBeingRenamed) {\n            return (jsx(TextField.Root, { value: renameFileInputValue, readOnly: true }));\n        }\n        // if we're currently renaming this folder, show as input of the renamefolderinputvalue\n        if (name === originalFolderBeingRenamed) {\n            return (jsx(TextField.Root, { value: renameFolderInputValue, readOnly: true }));\n        }\n        // return non-input text of the folder or file\n        return (jsx(Text, { style: { fontFamily: 'Fira Code, monospace', color: '#CCCECC', fontSize: '0.9em' }, children: name }));\n    };\n    // Single instance of file input to be used throughout the component\n    var renderNewFileInput = function () {\n        if (!isNewFileInputVisible)\n            return null;\n        // Use getEffectiveParentPath instead of directly using newFileParentPath\n        var effectiveParentPath = getEffectiveParentPath('file');\n        var inputId = \"new-file-input-\".concat(effectiveParentPath || 'root');\n        console.log(\"[FileExplorer] Rendering file input with ID: \".concat(inputId, \", value: \").concat(newFileInputValue, \", effectiveParentPath: \").concat(effectiveParentPath));\n        return (jsxs(Flex, { \"data-codevideo-id\": inputId, align: \"center\", gap: \"2\", mt: \"1\", children: [jsx(Text$1, { height: \"20\" }), jsx(TextField.Root, { value: newFileInputValue, readOnly: true, autoFocus: true })] }));\n    };\n    // Single instance of folder input to be used throughout the component\n    var renderNewFolderInput = function () {\n        if (!isNewFolderInputVisible)\n            return null;\n        // Use getEffectiveParentPath instead of directly using newFolderParentPath\n        var effectiveParentPath = getEffectiveParentPath('folder');\n        var inputId = \"new-folder-input-\".concat(effectiveParentPath || 'root');\n        console.log(\"[FileExplorer] Rendering folder input with ID: \".concat(inputId, \", value: \").concat(newFolderInputValue, \", effectiveParentPath: \").concat(effectiveParentPath));\n        return (jsxs(Flex, { \"data-codevideo-id\": inputId, align: \"center\", gap: \"2\", mt: \"1\", children: [jsx(Folder, { height: \"20\" }), jsx(TextField.Root, { value: newFolderInputValue, readOnly: true, autoFocus: true })] }));\n    };\n    var renderFileTree = function (structure, path, level) {\n        if (path === void 0) { path = ''; }\n        // Sort entries alphabetically, with directories first, then files\n        var sortedEntries = Object.entries(structure).sort(function (a, b) {\n            var aIsDir = a[1].type === 'directory';\n            var bIsDir = b[1].type === 'directory';\n            // If both are directories or both are files, sort alphabetically\n            if (aIsDir === bIsDir) {\n                return a[0].localeCompare(b[0]);\n            }\n            // Otherwise, directories come first\n            return aIsDir ? -1 : 1;\n        });\n        return sortedEntries.map(function (_a) {\n            var name = _a[0], item = _a[1];\n            var fullPath = path ? \"\".concat(path, \"/\").concat(name) : name;\n            var isDirectory = item.type === 'directory';\n            var leftMargin = level === 0 ? \"0\" : \"4\";\n            var nextLevel = level + 1;\n            // Fix highlighting logic to properly distinguish between files and folders\n            // Prioritize hover states over selected/active states to prevent overlap during transitions\n            var isHovered = (isDirectory && currentHoveredFolderName === fullPath) ||\n                (!isDirectory && currentHoveredFileName === fullPath);\n            var isSelected = currentFileName === fullPath;\n            var isHighlight = isHovered || (isSelected && !currentHoveredFileName && !currentHoveredFolderName);\n            // Check if this directory should show the new file/folder inputs\n            var effectiveFileParentPath = getEffectiveParentPath('file');\n            var effectiveFolderParentPath = getEffectiveParentPath('folder');\n            var shouldShowFileInput = isNewFileInputVisible && effectiveFileParentPath === fullPath && isDirectory;\n            var shouldShowFolderInput = isNewFolderInputVisible && effectiveFolderParentPath === fullPath && isDirectory;\n            if (shouldShowFileInput || shouldShowFolderInput) {\n                console.log(\"[FileExplorer] Directory \".concat(fullPath, \" should show inputs:\"), {\n                    file: shouldShowFileInput,\n                    folder: shouldShowFolderInput\n                });\n            }\n            return (jsxs(Box, { ml: leftMargin, children: [jsxs(Flex, { \"data-codevideo-id\": \"file-explorer-\".concat(fullPath), align: \"center\", gap: \"2\", style: {\n                            backgroundColor: isHighlight\n                                ? (theme === 'light' ? 'var(--gray-3)' : 'var(--gray-6)')\n                                : 'transparent',\n                            width: '100%',\n                            padding: '2px 4px',\n                            borderRadius: '4px',\n                        }, children: [isDirectory ? jsx(Folder, { height: \"20\" }) : jsx(FileIcon, { filename: name }), resolveFileOrFolderText(name)] }), isDirectory && (jsxs(Box, { ml: \"4\", children: [shouldShowFileInput && renderNewFileInput(), shouldShowFolderInput && renderNewFolderInput(), item.children && renderFileTree(item.children, fullPath, nextLevel)] }))] }, fullPath));\n        });\n    };\n    // Handle the root level inputs separately\n    var renderRootLevelInputs = function () {\n        var effectiveFileParentPath = getEffectiveParentPath('file');\n        var effectiveFolderParentPath = getEffectiveParentPath('folder');\n        var isRoot = effectiveFileParentPath === '' || effectiveFileParentPath === null || effectiveFileParentPath === undefined;\n        var isRootFolder = effectiveFolderParentPath === '' || effectiveFolderParentPath === null || effectiveFolderParentPath === undefined;\n        var shouldShowRootFileInput = isNewFileInputVisible && isRoot;\n        var shouldShowRootFolderInput = isNewFolderInputVisible && isRootFolder;\n        if (shouldShowRootFileInput || shouldShowRootFolderInput) {\n            console.log('[FileExplorer] Showing root level inputs:', {\n                file: shouldShowRootFileInput,\n                folder: shouldShowRootFolderInput,\n                effectiveFileParentPath: effectiveFileParentPath,\n                effectiveFolderParentPath: effectiveFolderParentPath\n            });\n        }\n        return (jsxs(Fragment, { children: [shouldShowRootFileInput && renderNewFileInput(), shouldShowRootFolderInput && renderNewFolderInput()] }));\n    };\n    if (!fileStructure) {\n        return jsx(Fragment, {});\n    }\n    return (jsxs(Box, { p: \"1\", \"data-testid\": \"file-explorer\", style: {\n            height: '100%',\n            width: fileExplorerWidth ? \"\".concat(fileExplorerWidth, \"px\") : '250px',\n            borderRight: '1px solid var(--gray-7)',\n            backgroundColor: theme === 'light' ? 'var(--gray-5)' : 'var(--gray-4)',\n            pointerEvents: 'none',\n            userSelect: 'none',\n        }, children: [jsxs(Box, { p: \"2\", children: [renderFileTree(fileStructure, '', 0), renderRootLevelInputs()] }), jsx(Box, { \"data-codevideo-id\": FILE_EXPLORER_ID, style: {\n                    flexGrow: 1,\n                    minHeight: '20px',\n                } }), jsx(FileExplorerContextMenu, { isVisible: isFileExplorerContextMenuVisible, currentMousePosition: currentMousePosition }), jsx(FileContextMenu, { isVisible: isFileContextMenuVisible, currentMousePosition: currentMousePosition }), jsx(FolderContextMenu, { isVisible: isFolderContextMenuVisible, currentMousePosition: currentMousePosition })] }));\n}\n\nfunction Terminal(props) {\n    var theme = props.theme, terminalBuffer = props.terminalBuffer, terminalHeight = props.terminalHeight, _a = props.fontSizePx, fontSizePx = _a === void 0 ? 14 : _a, _b = props.showBlockCaret, showBlockCaret = _b === void 0 ? false : _b;\n    var terminalRef = useRef(null);\n    // always auto-scroll to the bottom whenever the terminal buffer changes\n    useEffect(function () {\n        if (terminalRef.current) {\n            terminalRef.current.scrollTop = terminalRef.current.scrollHeight;\n        }\n    }, [terminalBuffer]);\n    // if the terminal buffer has no length, return a placeholder <Box/>\n    if (terminalBuffer.length === 0) {\n        return (jsx(Box, { style: {\n                backgroundColor: theme === 'light' ? 'var(--gray-5)' : 'var(--gray-4)',\n                height: terminalHeight ? \"\".concat(terminalHeight, \"px\") : '150px',\n                borderTop: '1px solid var(--gray-7)'\n            } }));\n    }\n    return (jsx(Box, { \"data-codevideo-id\": TERMINAL_ID, \"data-testid\": \"terminal\", ref: terminalRef, style: {\n            borderTop: '1px solid var(--gray-7)',\n            height: terminalHeight ? \"\".concat(terminalHeight, \"px\") : '150px',\n            backgroundColor: theme === 'light' ? 'var(--gray-5)' : 'var(--gray-4)',\n            fontFamily: 'Fira Code, monospace',\n            fontSize: \"\".concat(fontSizePx, \"px\"),\n            padding: '8px',\n            position: 'relative',\n            overflow: 'auto',\n            scrollBehavior: 'smooth',\n        }, children: jsxs(Box, { style: {\n                whiteSpace: 'pre-wrap',\n                wordBreak: 'break-word',\n                fontWeight: 'bold',\n                width: '100%',\n            }, children: [terminalBuffer, jsx(Box, { style: {\n                        display: 'inline-block',\n                        width: \"\".concat(fontSizePx * 0.6, \"px\"),\n                        height: \"\".concat(fontSizePx, \"px\"),\n                        marginBottom: '-2px',\n                        backgroundColor: showBlockCaret ? 'var(--gray-12)' : 'transparent',\n                        border: showBlockCaret ? 'none' : \"1px solid var(--gray-12)\",\n                        boxSizing: 'border-box',\n                    } })] }) }));\n}\n\n// Function to calculate a point on a cubic Bezier curve\nvar calculateCubicBezierPoint = function (t, p0, p1, p2, p3) {\n    // Safety checks for invalid points\n    var points = [p0, p1, p2, p3];\n    for (var _i = 0, points_1 = points; _i < points_1.length; _i++) {\n        var point = points_1[_i];\n        if (!point || point.x === undefined || point.y === undefined ||\n            isNaN(point.x) || isNaN(point.y)) {\n            console.warn('Invalid point provided to calculateCubicBezierPoint:', { p0: p0, p1: p1, p2: p2, p3: p3 });\n            return { x: 0, y: 0 };\n        }\n    }\n    var mt = 1 - t;\n    var mt2 = mt * mt;\n    var mt3 = mt2 * mt;\n    var t2 = t * t;\n    var t3 = t2 * t;\n    var x = mt3 * p0.x + 3 * mt2 * t * p1.x + 3 * mt * t2 * p2.x + t3 * p3.x;\n    var y = mt3 * p0.y + 3 * mt2 * t * p1.y + 3 * mt * t2 * p2.y + t3 * p3.y;\n    return { x: x, y: y };\n};\n\n// Function to sample points along a complex path for animation\nvar samplePathPoints = function (controlPoints, numSamples) {\n    var result = [];\n    for (var i = 0; i < numSamples; i++) {\n        var t = i / (numSamples - 1);\n        if (controlPoints.length === 4) {\n            // Cubic Bezier curve\n            result.push(calculateCubicBezierPoint(t, controlPoints[0], controlPoints[1], controlPoints[2], controlPoints[3]));\n        }\n        else if (controlPoints.length > 4) {\n            // For more complex paths, use De Casteljau's algorithm\n            // This is a simplification - for multiple bends we're treating \n            // the entire set of control points as a higher-order Bezier curve\n            var tmp = __spreadArray([], controlPoints, true);\n            var n = tmp.length;\n            for (var j = 1; j < n; j++) {\n                for (var k = 0; k < n - j; k++) {\n                    // Safety check to prevent NaN values from propagating\n                    var currentPoint = tmp[k];\n                    var nextPoint = tmp[k + 1];\n                    if (isNaN(currentPoint.x) || isNaN(currentPoint.y) ||\n                        isNaN(nextPoint.x) || isNaN(nextPoint.y)) {\n                        console.warn('NaN values detected in control points, skipping interpolation');\n                        continue;\n                    }\n                    tmp[k] = {\n                        x: (1 - t) * currentPoint.x + t * nextPoint.x,\n                        y: (1 - t) * currentPoint.y + t * nextPoint.y\n                    };\n                }\n            }\n            result.push(tmp[0]);\n        }\n    }\n    return result;\n};\n\n// Function to generate random control points for multi-bend curves\nvar generateControlPoints = function (start, end, numberOfCurves, arcHeight) {\n    var points = [];\n    var baseDistance = Math.hypot(end.x - start.x, end.y - start.y);\n    // Always include start and end points\n    points.push(start);\n    // Limit numberOfCurves to 1-3 range\n    var curveCount = Math.max(1, Math.min(3, numberOfCurves));\n    if (curveCount === 1) {\n        // Simple single curve - one control point above the midpoint\n        var controlPoint = {\n            x: (start.x + end.x) / 2,\n            y: Math.min(start.y, end.y) - baseDistance * arcHeight\n        };\n        points.push(controlPoint, controlPoint); // Duplicate for cubic bezier format\n    }\n    else {\n        // Multiple bends - create intermediate control points\n        var segment = 1 / (curveCount + 1);\n        for (var i = 1; i <= curveCount; i++) {\n            var progress = i * segment;\n            // Create a zig-zag pattern by alternating control point direction\n            var direction = i % 2 === 1 ? -1 : 1;\n            var perpFactor = Math.random() * 0.5 + 0.5; // Random factor between 0.5 and 1.0\n            // Linear interpolation for base position\n            var baseX = start.x + (end.x - start.x) * progress;\n            var baseY = start.y + (end.y - start.y) * progress;\n            // Apply perpendicular offset to create bends\n            // This creates the control points perpendicular to the path\n            var dx = -(end.y - start.y);\n            var dy = end.x - start.x;\n            var len = Math.hypot(dx, dy);\n            // Prevent division by zero when start and end points are the same\n            var controlPoint = len > 0 ? {\n                x: baseX + (dx / len) * baseDistance * arcHeight * direction * perpFactor,\n                y: baseY + (dy / len) * baseDistance * arcHeight * direction * perpFactor\n            } : {\n                x: baseX,\n                y: baseY\n            };\n            points.push(controlPoint);\n        }\n    }\n    points.push(end);\n    return points;\n};\n\nvar MouseOverlay = function (props) {\n    var mode = props.mode, mouseVisible = props.mouseVisible, targetMousePosition = props.targetMousePosition, maximumAnimationDuration = props.maximumAnimationDuration, mouseColor = props.mouseColor, _a = props.arcHeight, arcHeight = _a === void 0 ? 0.3 : _a, _b = props.numberOfCurves, numberOfCurves = _b === void 0 ? 1 : _b, onAnimationFinished = props.onAnimationFinished, onCurrentPositionChange = props.onCurrentPositionChange;\n    var overlayRef = useRef(null);\n    // Safe initialization with fallback to default position\n    var safeTargetPosition = targetMousePosition &&\n        targetMousePosition.x !== undefined && targetMousePosition.y !== undefined\n        ? targetMousePosition\n        : { x: 0, y: 0 };\n    var _c = useState(safeTargetPosition), currentPosition = _c[0], setCurrentPosition = _c[1];\n    var _d = useState(safeTargetPosition), prevPosition = _d[0], setPrevPosition = _d[1];\n    var _e = useState(false), isAnimating = _e[0], setIsAnimating = _e[1];\n    var _f = useState([]); _f[0]; var setPathPoints = _f[1];\n    var animationRef = useRef(null);\n    var lastTargetPositionRef = useRef(safeTargetPosition);\n    // Call the position change callback whenever currentPosition changes\n    useEffect(function () {\n        if (onCurrentPositionChange) {\n            onCurrentPositionChange(currentPosition);\n        }\n    }, [currentPosition, onCurrentPositionChange]);\n    useEffect(function () {\n        // Safety check: ensure targetMousePosition is valid\n        if (!targetMousePosition || targetMousePosition.x === undefined || targetMousePosition.y === undefined) {\n            console.warn('Invalid targetMousePosition provided to MouseOverlay:', targetMousePosition);\n            return;\n        }\n        // Skip if we're already animating to avoid double animations\n        if (isAnimating) {\n            return;\n        }\n        // Skip if target position hasn't changed\n        if (targetMousePosition && lastTargetPositionRef.current &&\n            targetMousePosition.x === lastTargetPositionRef.current.x &&\n            targetMousePosition.y === lastTargetPositionRef.current.y) {\n            return;\n        }\n        // Update the last target position ref\n        lastTargetPositionRef.current = targetMousePosition;\n        // Handle first render or non-replay mode with direct position update\n        if (mode !== 'replay') {\n            setCurrentPosition(targetMousePosition);\n            setPrevPosition(targetMousePosition);\n            return;\n        }\n        // Skip animation if positions are the same\n        if (prevPosition && targetMousePosition &&\n            prevPosition.x === targetMousePosition.x && prevPosition.y === targetMousePosition.y) {\n            setCurrentPosition(targetMousePosition);\n            setPrevPosition(targetMousePosition);\n            return;\n        }\n        // Always use the current position as the starting point for animation\n        // This ensures we start from where the mouse actually is\n        var startPosition = currentPosition;\n        // Safety check: ensure we have valid positions before generating control points\n        if (!startPosition || !targetMousePosition ||\n            startPosition.x === undefined || startPosition.y === undefined ||\n            targetMousePosition.x === undefined || targetMousePosition.y === undefined) {\n            console.warn('Invalid positions for animation, skipping:', { startPosition: startPosition, targetMousePosition: targetMousePosition });\n            return;\n        }\n        // Only animate in replay mode\n        var curvesToUse = numberOfCurves === 1 ?\n            Math.floor(Math.random() * 3) + 1 :\n            numberOfCurves;\n        // Generate control points for the path\n        var controlPoints = generateControlPoints(startPosition, targetMousePosition, curvesToUse, arcHeight);\n        // Store previous position before updating\n        setPrevPosition(startPosition);\n        // Pre-calculate points along the path for smoother animation\n        // Safety check: ensure control points are valid\n        if (!controlPoints || controlPoints.length === 0) {\n            console.warn('No valid control points generated, skipping animation');\n            return;\n        }\n        // Calculate distance-based animation parameters for consistent velocity\n        var distance = Math.hypot(targetMousePosition.x - startPosition.x, targetMousePosition.y - startPosition.y);\n        // Define consistent mouse velocity (pixels per second)\n        var MOUSE_VELOCITY = 600; // pixels per second - adjust for desired speed\n        var MIN_DURATION = 300; // minimum animation time in ms\n        var MAX_DURATION = maximumAnimationDuration; // respect the maximum limit\n        // Calculate duration based on distance and velocity\n        var calculatedDuration = Math.max(MIN_DURATION, Math.min(MAX_DURATION, (distance / MOUSE_VELOCITY) * 1000));\n        // Calculate dynamic point count based on duration for smooth animation\n        // Target ~120 fps for optimal smoothness, but scale with duration\n        var targetFps = 120;\n        var dynamicPointCount = Math.max(30, Math.min(240, Math.floor((calculatedDuration / 1000) * targetFps)));\n        var animationPoints = samplePathPoints(controlPoints, dynamicPointCount);\n        // Safety check: ensure animation points are valid\n        if (!animationPoints || animationPoints.length === 0) {\n            console.warn('No valid animation points generated, skipping animation');\n            return;\n        }\n        // Validate all animation points\n        var validAnimationPoints = animationPoints.filter(function (point) {\n            return point &&\n                typeof point.x === 'number' && !isNaN(point.x) && isFinite(point.x) &&\n                typeof point.y === 'number' && !isNaN(point.y) && isFinite(point.y);\n        });\n        if (validAnimationPoints.length === 0) {\n            console.warn('No valid animation points after filtering, skipping animation');\n            return;\n        }\n        console.log(\"\\uD83C\\uDFAC Distance: \".concat(distance.toFixed(1), \"px, Duration: \").concat(calculatedDuration, \"ms, Points: \").concat(validAnimationPoints.length, \", Velocity: \").concat((distance / (calculatedDuration / 1000)).toFixed(1), \"px/s\"));\n        setPathPoints(validAnimationPoints);\n        setIsAnimating(true);\n        // Animate along the pre-calculated path\n        var startTime = null;\n        // Use calculated duration for consistent velocity\n        var duration = calculatedDuration;\n        var animateFrame = function (timestamp) {\n            if (!startTime)\n                startTime = timestamp;\n            var elapsed = timestamp - startTime;\n            var progress = Math.min(elapsed / duration, 1);\n            // Get the point at the current progress\n            var frameIndex = Math.min(Math.floor(progress * (validAnimationPoints.length - 1)), validAnimationPoints.length - 1);\n            var newPosition = validAnimationPoints[frameIndex]; // Use validAnimationPoints instead\n            // Safety check: ensure the new position is valid\n            if (!newPosition || newPosition.x === undefined || newPosition.y === undefined) {\n                console.warn('Invalid animation position detected, ending animation:', newPosition);\n                setIsAnimating(false);\n                if (onAnimationFinished) {\n                    onAnimationFinished();\n                }\n                return;\n            }\n            setCurrentPosition(newPosition);\n            if (progress < 1) {\n                animationRef.current = requestAnimationFrame(animateFrame);\n            }\n            else {\n                setIsAnimating(false);\n                if (onAnimationFinished) {\n                    onAnimationFinished();\n                }\n            }\n        };\n        animationRef.current = requestAnimationFrame(animateFrame);\n        // Cleanup function to cancel animation if component unmounts during animation\n        return function () {\n            if (animationRef.current !== null) {\n                cancelAnimationFrame(animationRef.current);\n            }\n        };\n    }, [targetMousePosition === null || targetMousePosition === void 0 ? void 0 : targetMousePosition.x, targetMousePosition === null || targetMousePosition === void 0 ? void 0 : targetMousePosition.y, mode]);\n    // For step mode, always update position immediately\n    useEffect(function () {\n        if (mode === 'step' && targetMousePosition &&\n            targetMousePosition.x !== undefined && targetMousePosition.y !== undefined) {\n            setCurrentPosition(targetMousePosition);\n            setPrevPosition(targetMousePosition);\n            setIsAnimating(false);\n            lastTargetPositionRef.current = targetMousePosition;\n        }\n    }, [mode, targetMousePosition]);\n    if (!mouseVisible) {\n        return jsx(Fragment, {});\n    }\n    // Safety check to prevent undefined coordinates from causing transform errors\n    var safeCurrentPosition = {\n        x: isNaN(currentPosition.x) || currentPosition.x === undefined ? 0 : currentPosition.x,\n        y: isNaN(currentPosition.y) || currentPosition.y === undefined ? 0 : currentPosition.y\n    };\n    return (jsx(Box, { id: \"mouse-overlay\", \"data-testid\": \"mouse-overlay\", ref: overlayRef, style: {\n            transform: \"translate(\".concat(safeCurrentPosition.x, \"px, \").concat(safeCurrentPosition.y, \"px) scale(0.8)\"),\n            transition: isAnimating ? undefined : (mode === 'replay' ? 'transform 0.05s linear' : undefined),\n            zIndex: 10000,\n            position: 'absolute',\n            pointerEvents: 'none',\n            userSelect: 'none',\n        }, children: jsx(\"svg\", { width: \"24\", height: \"24\", viewBox: \"0 0 24 24\", version: \"1.1\", xmlns: \"http://www.w3.org/2000/svg\", children: jsx(\"path\", { d: \"M 0,0 L 0,20 L 4.5,15.5 L 8.75,23 L 11,22 L 6.75,15 L 13.75,15 Z\", fill: mouseColor ? mouseColor : 'black', stroke: \"white\", strokeWidth: \"1.5\", strokeLinejoin: \"round\" }) }) }));\n};\n\nfunction CaptionOverlay(props) {\n    var captionText = props.captionText, fontSizePx = props.fontSizePx;\n    return (jsx(Fragment, { children: captionText && (jsx(Box, { \"data-testid\": \"caption-overlay\", style: {\n                width: '100%',\n                color: 'white',\n                position: 'absolute',\n                bottom: 65,\n                zIndex: 10001,\n            }, children: jsx(Flex, { justify: \"center\", align: \"center\", children: jsx(Box, { style: {\n                        maxWidth: '80%',\n                        backgroundColor: 'var(--black-a9)',\n                        // borderRadius: 'var(--radius-3)',\n                        padding: '4px 8px',\n                    }, children: fontSizePx ? (jsx(Text, { style: { fontSize: fontSizePx * 1.5 }, children: captionText })) :\n                        (jsx(Text, { size: \"6\", children: captionText })) }) }) })) }));\n}\n\nfunction EmbedOverlay() {\n    return (jsx(Box, { \"data-testid\": \"embed-overlay\", style: {\n            zIndex: 10000000000,\n            position: 'absolute',\n            pointerEvents: 'none',\n            userSelect: 'none',\n            backgroundColor: 'var(--black-a9)',\n            inset: 0, // shorthand for top/right/bottom/left: 0\n        }, children: jsxs(Flex, { style: {\n                width: '100%',\n                height: '100%',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center'\n            }, direction: \"column\", gap: \"2\", children: [jsx(Box, { children: jsxs(Text, { size: \"9\", children: ['/>', \" CodeVideo Software Tutorial\"] }) }), jsx(Box, { children: jsxs(Text, { size: \"2\", mb: \"9\", children: [\"Create your own at \", jsx(Link, { href: 'https://studio.codevideo.io', target: \"_blank\", children: \"studio.codevideo.io\" })] }) }), jsx(Box, { children: jsxs(Text, { size: \"6\", children: [\"Press \", jsx(Kbd, { children: \"Space\" }), \" to playback\"] }) }), jsx(Box, { children: jsxs(Text, { size: \"6\", children: [\"Press the \", jsx(Kbd, { children: '\\u25C0' }), \" and \", jsx(Kbd, { children: '\\u25B6' }), \" arrow keys to move through the steps.\"] }) })] }) }));\n}\n\nfunction UnsavedChangesDialog(props) {\n    var isUnsavedChangesDialogOpen = props.isUnsavedChangesDialogOpen, unsavedFileName = props.unsavedFileName;\n    // if showUnsavedChangesDialog is false, return null\n    if (!isUnsavedChangesDialogOpen) {\n        return jsx(Fragment, {});\n    }\n    return (jsx(Box, { \"data-testid\": \"unsaved-changes-dialog\", style: {\n            zIndex: 9999,\n            position: 'absolute',\n            inset: 0, // shorthand for top/right/bottom/left: 0\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            pointerEvents: 'none',\n            userSelect: 'none',\n            backgroundColor: 'var(--black-a7)',\n        }, children: jsxs(Box, { style: {\n                backgroundColor: 'var(--gray-4)',\n                borderRadius: 'var(--radius-4)',\n                boxShadow: 'var(--shadow-5)',\n                padding: '24px',\n                maxWidth: '350px',\n                width: '100%',\n            }, children: [jsxs(Flex, { direction: \"column\", align: \"center\", justify: \"center\", children: [jsx(ExclamationTriangleIcon, { height: \"36\", width: \"36\" }), jsxs(Text, { size: \"2\", mt: \"4\", style: { textAlign: 'center' }, children: [\"Do you want to save the changes you made to \", jsx(Code, { children: unsavedFileName }), \"?\"] }), jsx(Text, { size: \"1\", mb: \"4\", style: { textAlign: 'center' }, children: \"Your changes will be lost if you don't save them.\" })] }), jsxs(Flex, { direction: \"column\", children: [jsx(Button, { \"data-codevideo-id\": 'unsaved-changes-dialog-button-save', color: 'mint', style: {\n                                outline: 'none',\n                            }, children: \"Save\" }), jsx(Button, { \"data-codevideo-id\": 'unsaved-changes-dialog-button-dont-save', color: 'gray', mt: \"1\", style: {\n                                outline: 'none',\n                            }, children: \"Don't Save\" }), jsx(Button, { \"data-codevideo-id\": 'unsaved-changes-dialog-button-cancel', color: 'gray', mt: \"4\", style: {\n                                outline: 'none',\n                            }, children: \"Cancel\" })] })] }) }));\n}\n\nfunction DevBox(_a) {\n    var variables = _a.variables;\n    return (jsx(Box, { style: {\n            position: 'absolute',\n            bottom: '16px',\n            left: '16px',\n            backgroundColor: 'rgba(0, 0, 0, 0.8)',\n            color: 'white',\n            fontFamily: 'Fira Code, Monaco, Consolas, \"Courier New\", monospace',\n            fontSize: '12px',\n            padding: '12px',\n            borderRadius: '6px',\n            maxWidth: '400px',\n            maxHeight: '300px',\n            overflow: 'auto',\n            zIndex: 1000,\n            border: '1px solid rgba(255, 255, 255, 0.1)',\n            boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)',\n        }, children: Object.entries(variables).map(function (_a) {\n            var key = _a[0], value = _a[1];\n            return (jsxs(\"div\", { style: { marginBottom: '4px', wordBreak: 'break-word' }, children: [jsx(\"span\", { style: { color: '#88c0d0' }, children: key }), jsx(\"span\", { style: { color: '#d8dee9' }, children: \": \" }), jsx(\"span\", { style: { color: '#a3be8c' }, children: typeof value === 'string'\n                            ? \"\\\"\".concat(value, \"\\\"\")\n                            : JSON.stringify(value, null, 0) })] }, key));\n        }) }));\n}\n\nvar marked = new Marked(markedHighlight({\n    async: false,\n    emptyLangClass: 'hljs',\n    langPrefix: 'hljs language-',\n    highlight: function (code, lang, info) {\n        var language = hljs.getLanguage(lang) ? lang : 'plaintext';\n        return hljs.highlight(code, { language: language }).value;\n    }\n}));\nmarked.setOptions({\n    gfm: true,\n    breaks: false,\n});\nvar SlideViewer = function (_a) {\n    var slideMarkdown = _a.slideMarkdown, _b = _a.hljsTheme, hljsTheme = _b === void 0 ? 'github' : _b, _c = _a.fontSize, fontSize = _c === void 0 ? '1rem' : _c, fontSizePx = _a.fontSizePx, _d = _a.fontFamily, fontFamily = _d === void 0 ? '-apple-system, BlinkMacSystemFont, \"Segoe UI (Custom)\", Roboto, \"Helvetica Neue\", \"Open Sans (Custom)\", system-ui, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\"' : _d, _e = _a.color, color = _e === void 0 ? 'black' : _e, _f = _a.backgroundColor, backgroundColor = _f === void 0 ? 'white' : _f, backgroundImage = _a.backgroundImage, _g = _a.backgroundSize, backgroundSize = _g === void 0 ? 'cover' : _g, _h = _a.padding, padding = _h === void 0 ? '2rem' : _h, _j = _a.maxWidth, maxWidth = _j === void 0 ? '800px' : _j, style = _a.style;\n    useEffect(function () {\n        var themeId = 'hljs-theme-stylesheet';\n        var existing = document.getElementById(themeId);\n        var version = hljs.versionString; // e.g. \"11.8.0\"\n        var href = \"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/\".concat(version, \"/styles/\").concat(hljsTheme, \".min.css\");\n        if (existing) {\n            existing.href = href;\n        }\n        else {\n            var link = document.createElement('link');\n            link.id = themeId;\n            link.rel = 'stylesheet';\n            link.href = href;\n            document.head.appendChild(link);\n        }\n        // (Optional) cleanup if you really want to remove it on unmount:\n        // return () => existing?.remove();\n    }, [hljsTheme]);\n    var html = useMemo(function () {\n        var raw = marked.parse(slideMarkdown, { async: false });\n        return DOMPurify.sanitize(raw);\n    }, [slideMarkdown]);\n    var slideContainerStyle = __assign(__assign({ fontSize: fontSizePx ? \"\".concat(fontSizePx, \"px\") : fontSize, fontFamily: fontFamily, color: color, backgroundColor: backgroundColor, padding: padding, margin: '0 auto' }, (backgroundImage\n        ? {\n            backgroundImage: \"url(\".concat(backgroundImage, \")\"),\n            backgroundSize: backgroundSize,\n            backgroundRepeat: 'no-repeat',\n            backgroundPosition: 'center',\n        }\n        : {})), style);\n    var slideStyle = {\n        minWidth: maxWidth, // shim for now, could be better\n        maxWidth: maxWidth,\n    };\n    return (jsx(Box, { \"data-codevideo-id\": SLIDE_ID, \"data-testid\": \"slide-viewer\", style: { width: '100%', height: '100vh' }, children: jsx(Box, { style: __assign(__assign({}, slideContainerStyle), { height: '100%', width: '100%', display: 'flex', alignItems: 'start', justifyContent: 'center' }), children: jsx(Box, { style: slideStyle, dangerouslySetInnerHTML: { __html: html } }) }) }));\n};\n\n// --- ESBUILD INITIALIZATION\nvar WASM_URLS = [\n    \"https://unpkg.com/esbuild-wasm@0.25.5/esbuild.wasm\",\n    \"https://cdn.jsdelivr.net/npm/esbuild-wasm@0.25.5/esbuild.wasm\"\n];\nvar REACT_CDN = \"https://esm.sh/react@18?bundle\";\nvar REACT_DOM_CDN = \"https://esm.sh/react-dom@18?bundle\";\nvar esbuildInitialized = false;\nvar esbuildInitializing = false;\nvar esbuildInitPromise = null;\nvar initializeEsbuild = function () { return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n        if (esbuildInitialized)\n            return [2 /*return*/];\n        if (esbuildInitializing && esbuildInitPromise)\n            return [2 /*return*/, esbuildInitPromise];\n        esbuildInitializing = true;\n        esbuildInitPromise = (function () { return __awaiter(void 0, void 0, void 0, function () {\n            var lastError, _i, WASM_URLS_1, wasmURL, error_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        lastError = null;\n                        _i = 0, WASM_URLS_1 = WASM_URLS;\n                        _a.label = 1;\n                    case 1:\n                        if (!(_i < WASM_URLS_1.length)) return [3 /*break*/, 6];\n                        wasmURL = WASM_URLS_1[_i];\n                        _a.label = 2;\n                    case 2:\n                        _a.trys.push([2, 4, , 5]);\n                        return [4 /*yield*/, esbuild.initialize({ wasmURL: wasmURL, worker: false })];\n                    case 3:\n                        _a.sent();\n                        console.log(\"Successfully initialized esbuild with \".concat(wasmURL));\n                        esbuildInitialized = true;\n                        esbuildInitializing = false;\n                        return [2 /*return*/];\n                    case 4:\n                        error_1 = _a.sent();\n                        console.warn(\"Failed to initialize esbuild with \".concat(wasmURL, \":\"), error_1);\n                        lastError = error_1 instanceof Error ? error_1 : new Error(String(error_1));\n                        return [3 /*break*/, 5];\n                    case 5:\n                        _i++;\n                        return [3 /*break*/, 1];\n                    case 6:\n                        esbuildInitializing = false;\n                        throw lastError || new Error('Failed to initialize esbuild with any WASM URL');\n                }\n            });\n        }); })();\n        return [2 /*return*/, esbuildInitPromise];\n    });\n}); };\n// --- VIRTUAL FILE PLUGIN ---\nvar createVirtualPlugin = function (vfs) { return ({\n    name: \"virtual-fs\",\n    setup: function (build) {\n        var _this = this;\n        build.onResolve({ filter: /.*/ }, function (args) {\n            if (args.path === \"react\" || args.path === \"react-dom\") {\n                return { path: args.path, external: true };\n            }\n            var path = args.path.startsWith(\"/\") ? args.path : \"/\".concat(args.path.replace(/^\\.\\//, \"\"));\n            if (vfs.has(path)) {\n                return { path: path, namespace: \"vfs\" };\n            }\n            return undefined;\n        });\n        build.onLoad({ filter: /.*/, namespace: \"vfs\" }, function (args) { return __awaiter(_this, void 0, void 0, function () {\n            var contents, ext, loader;\n            var _a, _b;\n            return __generator(this, function (_c) {\n                contents = (_a = vfs.get(args.path)) !== null && _a !== void 0 ? _a : \"\";\n                ext = (_b = args.path.split(\".\").pop()) !== null && _b !== void 0 ? _b : \"js\";\n                loader = (function () {\n                    if (ext === \"ts\")\n                        return \"ts\";\n                    if (ext === \"tsx\")\n                        return \"tsx\";\n                    if (ext === \"jsx\")\n                        return \"jsx\";\n                    return \"js\";\n                })();\n                return [2 /*return*/, { contents: contents, loader: loader }];\n            });\n        }); });\n    },\n}); };\n// +++ NEW: Added an enum for clarity +++\nvar ProjectType;\n(function (ProjectType) {\n    ProjectType[\"HTML\"] = \"html\";\n    ProjectType[\"JSX\"] = \"jsx\";\n    ProjectType[\"TSX\"] = \"tsx\";\n})(ProjectType || (ProjectType = {}));\nvar WebPreview = function (_a) {\n    var files = _a.files, _b = _a.height, height = _b === void 0 ? \"100vh\" : _b;\n    var iframeRef = useRef(null);\n    var _c = useState(esbuildInitialized), esbuildReady = _c[0], setEsbuildReady = _c[1];\n    var _d = useState(null), esbuildError = _d[0], setEsbuildError = _d[1];\n    // --- ESBUILD INITIALIZATION EFFECT ---\n    useEffect(function () {\n        if (esbuildInitialized) {\n            setEsbuildReady(true);\n            return;\n        }\n        var isMounted = true;\n        (function () { return __awaiter(void 0, void 0, void 0, function () {\n            var error_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, initializeEsbuild()];\n                    case 1:\n                        _a.sent();\n                        if (isMounted)\n                            setEsbuildReady(true);\n                        return [3 /*break*/, 3];\n                    case 2:\n                        error_2 = _a.sent();\n                        console.error('Failed to initialize esbuild:', JSON.stringify(error_2));\n                        if (isMounted)\n                            setEsbuildError(error_2 instanceof Error ? error_2.message : 'Unknown error');\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        }); })();\n        return function () { isMounted = false; };\n    }, []);\n    // --- BUNDLING EFFECT ---\n    useEffect(function () {\n        // Don't run if files are empty or esbuild isn't ready for JSX/TSX\n        if (files.length === 0)\n            return;\n        (function () { return __awaiter(void 0, void 0, void 0, function () {\n            var vfs_1, _i, files_1, f, path, entryHtmlFile, html, projectType, _a, scriptEntry, result, bundledCode_1, error_3;\n            var _b, _c;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0:\n                        _d.trys.push([0, 5, , 6]);\n                        vfs_1 = new Map();\n                        for (_i = 0, files_1 = files; _i < files_1.length; _i++) {\n                            f = files_1[_i];\n                            path = f.path.startsWith(\"/\") ? f.path : \"/\".concat(f.path);\n                            vfs_1.set(path, f.content);\n                        }\n                        entryHtmlFile = files.find(function (f) { return f.path.endsWith(\".html\"); });\n                        html = (entryHtmlFile === null || entryHtmlFile === void 0 ? void 0 : entryHtmlFile.content) || \"<!DOCTYPE html><html><head></head><body></body></html>\";\n                        projectType = ProjectType.HTML;\n                        if (files.some(function (f) { return f.path.endsWith(\".tsx\"); }))\n                            projectType = ProjectType.TSX;\n                        else if (files.some(function (f) { return f.path.endsWith(\".jsx\"); }))\n                            projectType = ProjectType.JSX;\n                        // +++ NEW: Wait for esbuild only if needed +++\n                        if (projectType !== ProjectType.HTML && !esbuildReady) {\n                            return [2 /*return*/]; // Wait for the next render when esbuild is ready\n                        }\n                        _a = projectType;\n                        switch (_a) {\n                            case ProjectType.HTML: return [3 /*break*/, 1];\n                            case ProjectType.JSX: return [3 /*break*/, 2];\n                            case ProjectType.TSX: return [3 /*break*/, 2];\n                        }\n                        return [3 /*break*/, 4];\n                    case 1:\n                        {\n                            // Replace <link> tags with <style> tags\n                            html = html.replace(/<link[^>]+href=\"([^\"]+\\.css)\"[^>]*>/g, function (match, cssPath) {\n                                var cssContent = vfs_1.get(\"/\".concat(cssPath.replace(/^\\.\\//, \"\")));\n                                return cssContent ? \"<style>\\n\".concat(cssContent, \"\\n</style>\") : match;\n                            });\n                            // Replace <script> tags with their inlined content\n                            html = html.replace(/<script[^>]+src=\"([^\"]+)\"[^>]*><\\/script>/g, function (match, scriptPath) {\n                                var jsContent = vfs_1.get(\"/\".concat(scriptPath.replace(/^\\.\\//, \"\")));\n                                return jsContent ? \"<script>\\n\".concat(jsContent, \"\\n</script>\") : match;\n                            });\n                            return [3 /*break*/, 4];\n                        }\n                    case 2:\n                        scriptEntry = (_c = (_b = files.find(function (f) { return /\\.(t|j)sx$/.test(f.path); })) === null || _b === void 0 ? void 0 : _b.path) !== null && _c !== void 0 ? _c : \"index.tsx\";\n                        return [4 /*yield*/, esbuild.build({\n                                bundle: true,\n                                write: false,\n                                format: \"iife\",\n                                platform: \"browser\",\n                                entryPoints: [\"/\".concat(scriptEntry)],\n                                plugins: [createVirtualPlugin(vfs_1)],\n                                external: [\"react\", \"react-dom\"],\n                                target: [\"es2020\"],\n                                define: { 'process.env.NODE_ENV': '\"development\"' }\n                            })];\n                    case 3:\n                        result = _d.sent();\n                        bundledCode_1 = result.outputFiles[0].text;\n                        // +++ FIX: Remove all script tags from the body before injecting the bundle +++\n                        html = html.replace(/<body[^>]*>[\\s\\S]*<\\/body>/i, function (bodyTag) {\n                            var cleanedBody = bodyTag.replace(/<script\\b[^>]*>[\\s\\S]*?<\\/script>/gi, '');\n                            return cleanedBody.replace(/<\\/body>/i, \"<script>\".concat(bundledCode_1, \"</script></body>\"));\n                        });\n                        // +++ FIX: Replace CSS links with style tags to prevent 404s +++\n                        html = html.replace(/<link[^>]+href=\"([^\"]+\\.css)\"[^>]*>/g, function (match, cssPath) {\n                            var cssContent = vfs_1.get(\"/\".concat(cssPath.replace(/^\\.\\//, \"\")));\n                            return cssContent ? \"<style>\\n\".concat(cssContent, \"\\n</style>\") : match;\n                        });\n                        // Inject React CDN if it's used\n                        html = html.replace(/<\\/head>/i, \"<script src=\\\"\".concat(REACT_CDN, \"\\\"></script><script src=\\\"\").concat(REACT_DOM_CDN, \"\\\"></script></head>\"));\n                        return [3 /*break*/, 4];\n                    case 4:\n                        // Write the final composed HTML to the iframe\n                        if (iframeRef.current) {\n                            iframeRef.current.srcdoc = html;\n                        }\n                        return [3 /*break*/, 6];\n                    case 5:\n                        error_3 = _d.sent();\n                        console.error('Bundle error:', JSON.stringify(error_3));\n                        if (iframeRef.current) {\n                            iframeRef.current.srcdoc = \"<body style=\\\"font-family: monospace; color: #e74c3c;\\\"><h3>Bundle Error:</h3><pre>\".concat(error_3 instanceof Error ? error_3.message : 'Unknown error', \"</pre></body>\");\n                        }\n                        return [3 /*break*/, 6];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        }); })();\n    }, [files, esbuildReady]); // Depend on esbuildReady\n    // --- LOADING AND ERROR STATES ---\n    if (esbuildError) {\n        return (jsxs(\"div\", { style: { padding: \"20px\", color: \"#e74c3c\", fontFamily: \"monospace\" }, children: [jsx(\"h3\", { children: \"WebPreview Error:\" }), jsx(\"pre\", { children: esbuildError })] }));\n    }\n    // Show a clearer loading state\n    if (!esbuildReady && files.some(function (f) { return /\\.(t|j)sx$/.test(f.path); })) {\n        return (jsx(\"div\", { style: { display: 'flex', alignItems: 'center', justifyContent: 'center', height: height, fontFamily: \"sans-serif\" }, children: \"Initializing Preview Environment...\" }));\n    }\n    return (jsx(\"div\", { style: { width: '100%', height: height }, \"data-testid\": \"web-preview\", children: jsx(\"iframe\", { ref: iframeRef, style: { width: \"100%\", height: \"100%\", border: \"0\" }, sandbox: \"allow-scripts allow-same-origin\", title: \"Web Preview\" }) }));\n};\n\nvar reconstituteAllPartsOfState = function (project, currentActionIndex, currentLessonIndex) {\n    var _a, _b;\n    var actions = extractActionsFromProject(project, currentLessonIndex);\n    var sanitizedCurrentActionIndex = currentActionIndex;\n    // action index can be maximum of actions.length - 1\n    if (currentActionIndex >= actions.length) {\n        sanitizedCurrentActionIndex = actions.length - 1;\n    }\n    // action index can be minimum of 0\n    if (currentActionIndex < 0) {\n        sanitizedCurrentActionIndex = 0;\n    }\n    var actionsToApply = actions.slice(0, sanitizedCurrentActionIndex + 1);\n    // activate verbose to true if debugging is needed\n    // the constructor should also handle if the project is a lesson with initial snapshot\n    var virtualIDE = new VirtualIDE(project, undefined, false);\n    virtualIDE.applyActions(actionsToApply);\n    var courseSnapshot = virtualIDE.getCourseSnapshot();\n    var editors = courseSnapshot.editorSnapshot.editors;\n    var currentEditor = (editors === null || editors === void 0 ? void 0 : editors.find(function (editor) { return editor.isActive; })) || (editors === null || editors === void 0 ? void 0 : editors[0]) || {\n        filename: '',\n        content: '',\n        caretPosition: DEFAULT_CARET_POSITION,\n        highlightCoordinates: null,\n        isActive: false,\n        isSaved: false\n    };\n    var currentFilename = currentEditor.filename;\n    var fileExplorerSnapshot = courseSnapshot.fileExplorerSnapshot;\n    var currentCode = currentEditor ? currentEditor.content : '';\n    var currentCaretPosition = currentEditor.caretPosition;\n    var currentTerminalBuffer = virtualIDE.virtualTerminals.length > 0 ? ((_a = virtualIDE.virtualTerminals[0]) === null || _a === void 0 ? void 0 : _a.getBuffer().join('\\n')) || '' : '';\n    var captionText = ((_b = courseSnapshot === null || courseSnapshot === void 0 ? void 0 : courseSnapshot.authorSnapshot.authors[0]) === null || _b === void 0 ? void 0 : _b.currentSpeechCaption) || '';\n    var mouseSnapshot = courseSnapshot === null || courseSnapshot === void 0 ? void 0 : courseSnapshot.mouseSnapshot;\n    var isUnsavedChangesDialogOpen = courseSnapshot.isUnsavedChangesDialogOpen;\n    var unsavedFileName = courseSnapshot.unsavedFileName;\n    return { editors: editors, currentEditor: currentEditor, currentFilename: currentFilename, fileExplorerSnapshot: fileExplorerSnapshot, currentCode: currentCode, currentCaretPosition: currentCaretPosition, currentTerminalBuffer: currentTerminalBuffer, captionText: captionText, actions: actions, mouseSnapshot: mouseSnapshot, isUnsavedChangesDialogOpen: isUnsavedChangesDialogOpen, unsavedFileName: unsavedFileName };\n};\n\nvar convertToContainerCoordinates = function (point, containerRef) {\n    if (!containerRef)\n        return DEFAULT_MOUSE_POSITION;\n    if (!(containerRef === null || containerRef === void 0 ? void 0 : containerRef.current))\n        return point;\n    if (!point || point.x === undefined || point.y === undefined || isNaN(point.x) || isNaN(point.y)) {\n        console.warn('Invalid point provided to convertToContainerCoordinates:', point);\n        return DEFAULT_MOUSE_POSITION;\n    }\n    var containerRect = containerRef.current.getBoundingClientRect();\n    console.log('🔧 [convertToContainerCoordinates] Container rect:', JSON.stringify({\n        left: containerRect.left,\n        top: containerRect.top,\n        width: containerRect.width,\n        height: containerRect.height\n    }));\n    console.log('🔧 [convertToContainerCoordinates] Input point:', JSON.stringify(point));\n    var x = point.x - containerRect.left;\n    var y = point.y - containerRect.top;\n    console.log('🔧 [convertToContainerCoordinates] Converted coordinates:', JSON.stringify({ x: x, y: y }));\n    return { x: x, y: y };\n};\n\nvar getCoordinatesOfEditor = function (containerRef) {\n    if (!containerRef)\n        return DEFAULT_MOUSE_POSITION;\n    var editor = document.querySelector('[data-codevideo-id=\"editor\"]');\n    if (!editor)\n        return DEFAULT_MOUSE_POSITION;\n    // console.log('editor element', editor);\n    var rect = editor.getBoundingClientRect();\n    return convertToContainerCoordinates({\n        x: rect.left + 50, // Position inside editor\n        y: rect.top + 50 // Position inside editor\n    }, containerRef);\n};\n\nvar debugDOMState = function () {\n    var _a, _b;\n    console.log('🔍 DOM Debug Info:');\n    console.log('- Document ready state:', document.readyState);\n    console.log('- Body children count:', ((_b = (_a = document.body) === null || _a === void 0 ? void 0 : _a.children) === null || _b === void 0 ? void 0 : _b.length) || 0);\n    console.log('- FileExplorer elements:', document.querySelectorAll('[data-codevideo-id=\"file-explorer\"]').length);\n    console.log('- All data-codevideo-id elements:', document.querySelectorAll('[data-codevideo-id]').length);\n    // Debug what file explorer elements actually exist\n    var allFileExplorerElements = document.querySelectorAll('[data-codevideo-id^=\"file-explorer-\"]');\n    console.log('📋 Available file explorer elements:');\n    allFileExplorerElements.forEach(function (el) {\n        console.log(\"  - \".concat(el.getAttribute('data-codevideo-id')));\n    });\n};\nvar getCoordinatesOfFileOrFolder = function (fileOrFolderPath, containerRef) {\n    try {\n        if (!containerRef)\n            return DEFAULT_MOUSE_POSITION;\n        console.log('🎯 [getCoordinatesOfFileOrFolder] Looking for:', fileOrFolderPath);\n        var selector = \"[data-codevideo-id=\\\"file-explorer-\".concat(fileOrFolderPath, \"\\\"]\");\n        console.log('🔍 [getCoordinatesOfFileOrFolder] Selector:', selector);\n        // Debugging DOM state\n        debugDOMState();\n        console.log('🔍 [getCoordinatesOfFileOrFolder] About to call document.querySelector...');\n        var fileElement = document.querySelector(selector);\n        console.log('🔍 [getCoordinatesOfFileOrFolder] document.querySelector completed successfully');\n        console.log('🔍 [getCoordinatesOfFileOrFolder] Element found:', !!fileElement);\n        // TODO: happens quite a lot, need to rearrange when the file tree is ready to be found.\n        if (!fileElement) {\n            console.log('❌ [getCoordinatesOfFileOrFolder] Element not found');\n            // Let's see what elements we do have\n            var allFileExplorerElements = document.querySelectorAll('[data-codevideo-id^=\"file-explorer-\"]');\n            console.log('📋 [getCoordinatesOfFileOrFolder] Available file explorer elements:');\n            allFileExplorerElements.forEach(function (el) {\n                console.log(\"  - \".concat(el.getAttribute('data-codevideo-id')));\n            });\n            return DEFAULT_MOUSE_POSITION;\n        }\n        console.log('✅ [getCoordinatesOfFileOrFolder] Found element, about to get bounding rect...');\n        var rect = fileElement.getBoundingClientRect();\n        console.log('✅ [getCoordinatesOfFileOrFolder] Got bounding rect successfully');\n        console.log('📐 [getCoordinatesOfFileOrFolder] Element rect:', JSON.stringify({\n            left: rect.left,\n            top: rect.top,\n            width: rect.width,\n            height: rect.height,\n            right: rect.right,\n            bottom: rect.bottom\n        }));\n        var absoluteCoords = {\n            x: rect.left + rect.width / 2,\n            y: rect.top + rect.height / 2\n        };\n        console.log('📍 [getCoordinatesOfFileOrFolder] Absolute center coords:', JSON.stringify(absoluteCoords));\n        console.log('🔍 [getCoordinatesOfFileOrFolder] About to call convertToContainerCoordinates...');\n        var result = convertToContainerCoordinates(absoluteCoords, containerRef);\n        console.log('🔍 [getCoordinatesOfFileOrFolder] convertToContainerCoordinates completed successfully');\n        console.log('🎯 [getCoordinatesOfFileOrFolder] Final container-relative coords:', JSON.stringify(result));\n        return result;\n    }\n    catch (error) {\n        console.error('❗ [getCoordinatesOfFileOrFolder] Error name:', error === null || error === void 0 ? void 0 : error.name);\n        console.error('❗ [getCoordinatesOfFileOrFolder] Error message:', error === null || error === void 0 ? void 0 : error.message);\n        console.error('❗ [getCoordinatesOfFileOrFolder] Error stack:', error === null || error === void 0 ? void 0 : error.stack);\n        console.error('❗ [getCoordinatesOfFileOrFolder] Full error object:', error);\n        return DEFAULT_MOUSE_POSITION;\n    }\n};\n\nvar getCoordinatesOfTerminalInput = function (containerRef) {\n    if (!containerRef)\n        return DEFAULT_MOUSE_POSITION;\n    var terminal = document.querySelector('[data-codevideo-id=\"terminal\"]');\n    if (!terminal)\n        return DEFAULT_MOUSE_POSITION;\n    // console.log('terminal element', terminal);\n    var rect = terminal.getBoundingClientRect();\n    return convertToContainerCoordinates({\n        x: rect.left + 20, // Add padding for prompt\n        y: rect.top + 20 // Position near top of terminal\n    }, containerRef);\n};\n\nvar parseCoordinatesFromMouseCoordinateAction = function (value, containerRef) {\n    if (!containerRef)\n        return DEFAULT_MOUSE_POSITION;\n    // try to get two parts\n    var parts = value.split(',');\n    if (parts.length == 2) {\n        return convertToContainerCoordinates({\n            x: parts[0] ? parseInt(parts[0]) : 0,\n            y: parts[1] ? parseInt(parts[1]) : 0\n        }, containerRef);\n    }\n    return {\n        x: 0,\n        y: 0,\n    };\n};\n\n// Box-Muller transform for generating normally distributed random numbers\nvar generateGaussian = function (mean, stdDev) {\n    // Box-Muller transform\n    var u1 = Math.random();\n    var u2 = Math.random();\n    var z0 = Math.sqrt(-2 * Math.log(u1)) * Math.cos(2.0 * Math.PI * u2);\n    return z0 * stdDev + mean;\n};\nvar getGaussianCoordinatesByCodeVideoDataID = function (dataId, containerRef, options) {\n    if (options === void 0) { options = {\n        randomize: true,\n        stdDevPercent: 0.15 // Standard deviation as percentage of element dimensions\n    }; }\n    if (!containerRef)\n        return DEFAULT_MOUSE_POSITION;\n    var element = document.querySelector(\"[data-codevideo-id=\\\"\".concat(dataId, \"\\\"]\"));\n    if (!element) {\n        console.warn('Element with data-codevideo-id not found', dataId);\n        return DEFAULT_MOUSE_POSITION;\n    }\n    var rect = element.getBoundingClientRect();\n    // Calculate center point\n    var centerX = rect.left + rect.width / 2;\n    var centerY = rect.top + rect.height / 2;\n    // If randomization is disabled, just return the center point\n    if (!options.randomize) {\n        console.log(\"Exact center of element found at: \".concat(centerX, \", \").concat(centerY));\n        return convertToContainerCoordinates({ x: centerX, y: centerY }, containerRef);\n    }\n    // Calculate standard deviations based on element dimensions\n    var stdDevX = rect.width * options.stdDevPercent;\n    var stdDevY = rect.height * options.stdDevPercent;\n    // Define safe boundaries (with padding) to ensure we're 100% within the element\n    var padding = Math.min(5, rect.width * 0.1, rect.height * 0.1);\n    var minX = rect.left + padding;\n    var maxX = rect.right - padding;\n    var minY = rect.top + padding;\n    var maxY = rect.bottom - padding;\n    // Generate and clamp coordinates until we have a valid point\n    var x, y;\n    // Generate random point using Gaussian distribution\n    x = generateGaussian(centerX, stdDevX);\n    y = generateGaussian(centerY, stdDevY);\n    // Clamp coordinates to GUARANTEE they stay within the element boundaries\n    x = Math.max(minX, Math.min(maxX, x));\n    y = Math.max(minY, Math.min(maxY, y));\n    console.log(\"Random point within element: \".concat(x, \", \").concat(y));\n    return convertToContainerCoordinates({ x: x, y: y }, containerRef);\n};\n\nvar getNewMousePosition = function (targetMousePosition, currentAction, containerRef) {\n    var _a;\n    var newPosition = { x: targetMousePosition.x, y: targetMousePosition.y };\n    switch (currentAction.name) {\n        // movement actions\n        case 'mouse-move-file-explorer':\n            newPosition = getGaussianCoordinatesByCodeVideoDataID(FILE_EXPLORER_ID, containerRef);\n            break;\n        case 'mouse-move-terminal':\n            newPosition = getCoordinatesOfTerminalInput(containerRef);\n            break;\n        case 'mouse-move-editor':\n            newPosition = getCoordinatesOfEditor(containerRef);\n            break;\n        case 'mouse-move-file-explorer-file':\n        case 'mouse-move-file-explorer-folder':\n            console.log('🚀 [getNewMousePosition] Handling file/folder movement:', JSON.stringify({\n                actionName: currentAction.name,\n                actionValue: currentAction.value\n            }));\n            newPosition = getCoordinatesOfFileOrFolder(currentAction.value, containerRef);\n            console.log('🚀 [getNewMousePosition] Result position:', JSON.stringify(newPosition));\n            break;\n        case 'mouse-move-to-coordinates-pixels':\n            newPosition = parseCoordinatesFromMouseCoordinateAction(currentAction.value, containerRef);\n            break;\n        case 'mouse-move-to-coordinates-percent':\n            var percentages = parseCoordinatesFromMouseCoordinateAction(currentAction.value, containerRef);\n            // convert x and y percentage to pixels\n            var rect = (_a = containerRef === null || containerRef === void 0 ? void 0 : containerRef.current) === null || _a === void 0 ? void 0 : _a.getBoundingClientRect();\n            if (rect) {\n                newPosition = {\n                    x: rect.width * percentages.x,\n                    y: (rect === null || rect === void 0 ? void 0 : rect.height) * percentages.y\n                };\n            }\n            break;\n        // file explorer context menu movements\n        case 'mouse-move-file-explorer-context-menu-new-file':\n            newPosition = getGaussianCoordinatesByCodeVideoDataID(\"file-explorer-context-menu-new-file\", containerRef);\n            break;\n        case 'mouse-move-file-explorer-context-menu-new-folder':\n            newPosition = getGaussianCoordinatesByCodeVideoDataID(\"file-explorer-context-menu-new-folder\", containerRef);\n            break;\n        // file context menu movements\n        case 'mouse-move-file-explorer-file-context-menu-rename':\n            newPosition = getGaussianCoordinatesByCodeVideoDataID(\"file-explorer-file-context-menu-rename\", containerRef);\n            break;\n        case 'mouse-move-file-explorer-file-context-menu-delete':\n            newPosition = getGaussianCoordinatesByCodeVideoDataID(\"file-explorer-file-context-menu-delete\", containerRef);\n            break;\n        // folder context menu movements\n        case 'mouse-move-file-explorer-folder-context-menu-new-file':\n            newPosition = getGaussianCoordinatesByCodeVideoDataID(\"file-explorer-folder-context-menu-new-file\", containerRef);\n            break;\n        case 'mouse-move-file-explorer-folder-context-menu-new-folder':\n            newPosition = getGaussianCoordinatesByCodeVideoDataID(\"file-explorer-folder-context-menu-new-folder\", containerRef);\n            break;\n        case 'mouse-move-file-explorer-folder-context-menu-rename':\n            newPosition = getGaussianCoordinatesByCodeVideoDataID(\"file-explorer-folder-context-menu-rename\", containerRef);\n            break;\n        case 'mouse-move-file-explorer-folder-context-menu-delete':\n            newPosition = getGaussianCoordinatesByCodeVideoDataID(\"file-explorer-folder-context-menu-delete\", containerRef);\n            break;\n        // editor tab movements\n        case 'mouse-move-editor-tab':\n            newPosition = getGaussianCoordinatesByCodeVideoDataID(\"editor-tab-\".concat(currentAction.value), containerRef);\n            break;\n        case 'mouse-move-editor-tab-close':\n            newPosition = getGaussianCoordinatesByCodeVideoDataID(\"editor-tab-close-\".concat(currentAction.value), containerRef);\n            break;\n        // unsaved changes dialog movements\n        case 'mouse-move-unsaved-changes-dialog-button-save':\n            newPosition = getGaussianCoordinatesByCodeVideoDataID(\"unsaved-changes-dialog-button-save\", containerRef);\n            break;\n        case 'mouse-move-unsaved-changes-dialog-button-dont-save':\n            newPosition = getGaussianCoordinatesByCodeVideoDataID(\"unsaved-changes-dialog-button-dont-save\", containerRef);\n            break;\n        case 'mouse-move-unsaved-changes-dialog-button-cancel':\n            newPosition = getGaussianCoordinatesByCodeVideoDataID(\"unsaved-changes-dialog-button-cancel\", containerRef);\n            break;\n        // Note: All GUI related click actions should be derived directly from the virtual layer!!!!\n    }\n    // Safety check to ensure we never return undefined or NaN coordinates\n    if (!newPosition) {\n        console.warn('New position is undefined, falling back to target position:', JSON.stringify(targetMousePosition));\n        return { x: targetMousePosition.x, y: targetMousePosition.y };\n    }\n    if (!newPosition.x) {\n        console.warn('New position x is undefined, falling back to target position:', JSON.stringify(targetMousePosition));\n        return { x: targetMousePosition.x, y: targetMousePosition.y };\n    }\n    if (!newPosition.y) {\n        console.warn('New position y is undefined, falling back to target position:', JSON.stringify(targetMousePosition));\n        return { x: targetMousePosition.x, y: targetMousePosition.y };\n    }\n    return newPosition;\n};\n\nvar simulateHumanTypingWithReactSetterCallback = function (setter_1, text_1) {\n    var args_1 = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        args_1[_i - 2] = arguments[_i];\n    }\n    return __awaiter(void 0, __spreadArray([setter_1, text_1], args_1, true), void 0, function (setter, text, typingPauseMs) {\n        var characters, i;\n        if (typingPauseMs === void 0) { typingPauseMs = KEYBOARD_TYPING_PAUSE_MS; }\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    characters = text.split(\"\");\n                    i = 0;\n                    _a.label = 1;\n                case 1:\n                    if (!(i < characters.length)) return [3 /*break*/, 4];\n                    setter(function (prev) { return prev + characters[i]; });\n                    return [4 /*yield*/, sleep(typingPauseMs)];\n                case 2:\n                    _a.sent();\n                    _a.label = 3;\n                case 3:\n                    i++;\n                    return [3 /*break*/, 1];\n                case 4: return [2 /*return*/];\n            }\n        });\n    });\n};\n\n// define the human typing here in the puppeteer environment\nvar simulateHumanTypingInMonaco = function (editor, charactersToType, typingPauseMs) {\n    if (typingPauseMs === void 0) { typingPauseMs = KEYBOARD_TYPING_PAUSE_MS; }\n    return new Promise(function (resolve) {\n        var characters = charactersToType.split(\"\");\n        var index = 0;\n        function typeNextCharacter() {\n            if (index < characters.length) {\n                var char = characters[index];\n                var selection = editor.getSelection();\n                editor.executeEdits(\"simulateTyping\", [\n                    {\n                        range: {\n                            startLineNumber: (selection === null || selection === void 0 ? void 0 : selection.selectionStartLineNumber) || 1,\n                            startColumn: (selection === null || selection === void 0 ? void 0 : selection.selectionStartColumn) || 1,\n                            endLineNumber: (selection === null || selection === void 0 ? void 0 : selection.endLineNumber) || 1,\n                            endColumn: (selection === null || selection === void 0 ? void 0 : selection.endColumn) || 1,\n                        },\n                        text: char || \"\",\n                        forceMoveMarkers: true,\n                    },\n                ]);\n                // editor.setPosition({\n                //   lineNumber: selection?.endLineNumber || 1,\n                //   column: selection?.endColumn || 1\n                // });\n                // this keeps the line we are currently typing in the center of the screen\n                editor.revealPositionInCenter({\n                    lineNumber: (selection === null || selection === void 0 ? void 0 : selection.endLineNumber) || 1,\n                    column: (selection === null || selection === void 0 ? void 0 : selection.endColumn) || 1\n                });\n                // trigger a focus to actually highlight where the caret is\n                editor.focus();\n                index++;\n                setTimeout(typeNextCharacter, typingPauseMs);\n            }\n            else {\n                resolve();\n            }\n        }\n        typeNextCharacter();\n    });\n};\n\nvar executeActionPlaybackForMonacoInstance = function (editor_1, project_1, currentActionIndex_1, currentLessonIndex_1, action_1, isSoundOn_1, setEditors_1, setCurrentEditor_1, setCurrentFileName_1, setCurrentCode_1, setCurrentCaretPosition_1, setTerminalBuffer_1, mousePosition_1, containerRef_1, setMousePosition_1, setCaptionText_1, speakActionAudios_1, setNewFileInputValue_1, setNewFolderInputValue_1, setRenameFileInputValue_1, setRenameFolderInputValue_1) {\n    var args_1 = [];\n    for (var _i = 21; _i < arguments.length; _i++) {\n        args_1[_i - 21] = arguments[_i];\n    }\n    return __awaiter(void 0, __spreadArray([editor_1, project_1, currentActionIndex_1, currentLessonIndex_1, action_1, isSoundOn_1, setEditors_1, setCurrentEditor_1, setCurrentFileName_1, setCurrentCode_1, setCurrentCaretPosition_1, setTerminalBuffer_1, mousePosition_1, containerRef_1, setMousePosition_1, setCaptionText_1, speakActionAudios_1, setNewFileInputValue_1, setNewFolderInputValue_1, setRenameFileInputValue_1, setRenameFolderInputValue_1], args_1, true), void 0, function (editor, project, currentActionIndex, currentLessonIndex, action, isSoundOn, setEditors, setCurrentEditor, setCurrentFileName, setCurrentCode, setCurrentCaretPosition, setTerminalBuffer, mousePosition, containerRef, setMousePosition, setCaptionText, speakActionAudios, setNewFileInputValue, setNewFolderInputValue, setRenameFileInputValue, setRenameFolderInputValue, keyboardTypingPauseMs, standardPauseMs, longPauseMs) {\n        var startTime, _a, editors, currentEditor, currentFilename, currentCaretPosition, currentCode, model, clickModel, newPosition, times, pos, _loop_1, i;\n        var _b, _c, _d;\n        if (keyboardTypingPauseMs === void 0) { keyboardTypingPauseMs = KEYBOARD_TYPING_PAUSE_MS; }\n        if (standardPauseMs === void 0) { standardPauseMs = STANDARD_PAUSE_MS; }\n        return __generator(this, function (_e) {\n            switch (_e.label) {\n                case 0:\n                    startTime = -1;\n                    _a = reconstituteAllPartsOfState(project, currentActionIndex, currentLessonIndex), editors = _a.editors, currentEditor = _a.currentEditor, currentFilename = _a.currentFilename, currentCaretPosition = _a.currentCaretPosition, currentCode = _a.currentCode;\n                    // OPEN FILE ANIMATION, STATE NEEDS TO BE SET HERE BEFORE TYPING OR WE ALWAYS TYPE ONE CHARACTER TOO LATE\n                    switch (action.name) {\n                        case 'file-explorer-open-file':\n                            console.log(\"SET CURRENT FILE to \", action.value);\n                            setEditors(editors);\n                            setCurrentEditor(currentEditor);\n                            setCurrentFileName(currentFilename);\n                            setCurrentCode(currentCode);\n                            setCurrentCaretPosition(currentCaretPosition);\n                            model = editor.getModel();\n                            if (model && model.getValue() !== currentCode) {\n                                model.setValue(currentCode);\n                            }\n                            break;\n                        // for this we actually only need to set when clicking on a file...\n                        case 'mouse-left-click':\n                            // if we are clicking on a file, we need to set the editor content to the current\n                            setCurrentCode(currentCode);\n                            clickModel = editor.getModel();\n                            if (clickModel && clickModel.getValue() !== currentCode) {\n                                clickModel.setValue(currentCode);\n                            }\n                            break;\n                    }\n                    // before continuing, wait a little bit so file explorer can update the DOM\n                    // TODO: how can we do this properly without needing a hardcode sleep?\n                    // NEED TO DO THIS OR WE GET COORDINATE FINDING ISSUES WITH THE MOUSE\n                    return [4 /*yield*/, sleep(standardPauseMs)];\n                case 1:\n                    // before continuing, wait a little bit so file explorer can update the DOM\n                    // TODO: how can we do this properly without needing a hardcode sleep?\n                    // NEED TO DO THIS OR WE GET COORDINATE FINDING ISSUES WITH THE MOUSE\n                    _e.sent();\n                    newPosition = getNewMousePosition(mousePosition, action, containerRef);\n                    // Safety check before setting mouse position\n                    if (newPosition && newPosition.x !== undefined && newPosition.y !== undefined &&\n                        !isNaN(newPosition.x) && !isNaN(newPosition.y)) {\n                        setMousePosition(newPosition);\n                    }\n                    else {\n                        console.warn('Invalid mouse position from getNewMousePosition, keeping current position:', newPosition);\n                    }\n                    times = isRepeatableAction(action.name) ? parseInt(action.value) : 1;\n                    pos = editor.getPosition();\n                    console.log(\"Editor position is at line \".concat(pos === null || pos === void 0 ? void 0 : pos.lineNumber, \", column \").concat(pos === null || pos === void 0 ? void 0 : pos.column));\n                    _loop_1 = function (i) {\n                        var _f, mp3Url, waitDuration, terminalOutput, terminalLines, latestLine_1, _loop_2, i_1, deleteCount, j, scrollUpDistance, currentLine, targetLine, scrollDownDistance, currentLineDown, targetLineDown;\n                        return __generator(this, function (_g) {\n                            switch (_g.label) {\n                                case 0:\n                                    _f = true;\n                                    switch (_f) {\n                                        case action.name.startsWith(\"external-\"): return [3 /*break*/, 1];\n                                        case action.name.startsWith(\"slides-\"): return [3 /*break*/, 1];\n                                        case action.name === \"author-speak-before\": return [3 /*break*/, 2];\n                                        case action.name === \"author-speak-during\": return [3 /*break*/, 2];\n                                        case action.name === \"author-speak-after\": return [3 /*break*/, 2];\n                                        case action.name === \"author-wait\": return [3 /*break*/, 6];\n                                        case action.name === \"file-explorer-type-new-file-input\": return [3 /*break*/, 8];\n                                        case action.name === \"file-explorer-enter-new-file-input\": return [3 /*break*/, 9];\n                                        case action.name === \"file-explorer-type-new-folder-input\": return [3 /*break*/, 10];\n                                        case action.name === \"file-explorer-enter-new-folder-input\": return [3 /*break*/, 11];\n                                        case action.name === \"file-explorer-type-rename-file-input\": return [3 /*break*/, 12];\n                                        case action.name === \"file-explorer-enter-rename-file-input\": return [3 /*break*/, 13];\n                                        case action.name === \"file-explorer-type-rename-folder-input\": return [3 /*break*/, 14];\n                                        case action.name === \"file-explorer-enter-rename-folder-input\": return [3 /*break*/, 15];\n                                        case action.name === 'terminal-type': return [3 /*break*/, 16];\n                                        case action.name === \"editor-arrow-down\" && pos !== null: return [3 /*break*/, 21];\n                                        case action.name === \"editor-arrow-up\" && pos !== null: return [3 /*break*/, 23];\n                                        case action.name === \"editor-tab\" && pos !== null: return [3 /*break*/, 25];\n                                        case action.name === \"editor-arrow-left\" && pos !== null: return [3 /*break*/, 27];\n                                        case action.name === \"editor-arrow-right\" && pos !== null: return [3 /*break*/, 29];\n                                        case action.name === \"editor-enter\": return [3 /*break*/, 31];\n                                        case action.name === \"editor-command-right\" && pos !== null: return [3 /*break*/, 33];\n                                        case action.name === \"editor-space\": return [3 /*break*/, 35];\n                                        case action.name === \"editor-backspace\": return [3 /*break*/, 37];\n                                        case action.name === \"editor-type\": return [3 /*break*/, 39];\n                                        case action.name === \"editor-scroll-up\": return [3 /*break*/, 41];\n                                        case action.name === \"editor-scroll-down\": return [3 /*break*/, 43];\n                                        case action.name.startsWith(\"mouse-move-\"): return [3 /*break*/, 45];\n                                    }\n                                    return [3 /*break*/, 47];\n                                case 1: \n                                // no op - but do a long pause\n                                // await sleep(longPauseMs);\n                                return [3 /*break*/, 48];\n                                case 2:\n                                    setCaptionText(action.value);\n                                    mp3Url = (_b = speakActionAudios.find(function (audio) { return audio.text === action.value; })) === null || _b === void 0 ? void 0 : _b.mp3Url;\n                                    if (!(action.name === \"author-speak-during\")) return [3 /*break*/, 3];\n                                    // Fire and forget - don't await\n                                    speakText(action.value, isSoundOn ? 1 : 0, mp3Url);\n                                    return [3 /*break*/, 5];\n                                case 3: \n                                // Default behavior for author-speak-before and other author actions - await completion\n                                return [4 /*yield*/, speakText(action.value, isSoundOn ? 1 : 0, mp3Url)];\n                                case 4:\n                                    // Default behavior for author-speak-before and other author actions - await completion\n                                    _g.sent();\n                                    _g.label = 5;\n                                case 5: return [3 /*break*/, 48];\n                                case 6:\n                                    waitDuration = parseInt(action.value) || 1000;\n                                    console.log(\"Waiting for \".concat(waitDuration, \"ms\"));\n                                    return [4 /*yield*/, sleep(waitDuration)];\n                                case 7:\n                                    _g.sent();\n                                    return [3 /*break*/, 48];\n                                case 8:\n                                    simulateHumanTypingWithReactSetterCallback(setNewFileInputValue, action.value, keyboardTypingPauseMs);\n                                    return [3 /*break*/, 48];\n                                case 9:\n                                    setNewFileInputValue(\"\");\n                                    return [3 /*break*/, 48];\n                                case 10:\n                                    simulateHumanTypingWithReactSetterCallback(setNewFolderInputValue, action.value, keyboardTypingPauseMs);\n                                    return [3 /*break*/, 48];\n                                case 11:\n                                    setNewFolderInputValue(\"\");\n                                    return [3 /*break*/, 48];\n                                case 12:\n                                    simulateHumanTypingWithReactSetterCallback(setRenameFileInputValue, action.value, keyboardTypingPauseMs);\n                                    return [3 /*break*/, 48];\n                                case 13:\n                                    setRenameFileInputValue(\"\");\n                                    return [3 /*break*/, 48];\n                                case 14:\n                                    simulateHumanTypingWithReactSetterCallback(setRenameFolderInputValue, action.value, keyboardTypingPauseMs);\n                                    return [3 /*break*/, 48];\n                                case 15:\n                                    setRenameFolderInputValue(\"\");\n                                    return [3 /*break*/, 48];\n                                case 16:\n                                    terminalOutput = action.value;\n                                    terminalLines = terminalOutput.split('\\n');\n                                    latestLine_1 = terminalLines[terminalLines.length - 1];\n                                    if (!latestLine_1) return [3 /*break*/, 20];\n                                    _loop_2 = function (i_1) {\n                                        return __generator(this, function (_h) {\n                                            switch (_h.label) {\n                                                case 0:\n                                                    setTerminalBuffer(function (prev) { return prev + latestLine_1[i_1]; });\n                                                    return [4 /*yield*/, sleep(keyboardTypingPauseMs)];\n                                                case 1:\n                                                    _h.sent();\n                                                    return [2 /*return*/];\n                                            }\n                                        });\n                                    };\n                                    i_1 = 0;\n                                    _g.label = 17;\n                                case 17:\n                                    if (!(i_1 < latestLine_1.length)) return [3 /*break*/, 20];\n                                    return [5 /*yield**/, _loop_2(i_1)];\n                                case 18:\n                                    _g.sent();\n                                    _g.label = 19;\n                                case 19:\n                                    i_1++;\n                                    return [3 /*break*/, 17];\n                                case 20: return [3 /*break*/, 48];\n                                case 21:\n                                    // @ts-ignore\n                                    pos.lineNumber = pos.lineNumber + 1;\n                                    editor.setPosition(pos);\n                                    return [4 /*yield*/, sleep(keyboardTypingPauseMs)];\n                                case 22:\n                                    _g.sent();\n                                    return [3 /*break*/, 48];\n                                case 23:\n                                    // @ts-ignore\n                                    pos.lineNumber = pos.lineNumber - 1;\n                                    editor.setPosition(pos);\n                                    return [4 /*yield*/, sleep(keyboardTypingPauseMs)];\n                                case 24:\n                                    _g.sent();\n                                    return [3 /*break*/, 48];\n                                case 25:\n                                    // @ts-ignore\n                                    pos.lineNumber = pos.lineNumber + 2;\n                                    editor.setPosition(pos);\n                                    return [4 /*yield*/, sleep(keyboardTypingPauseMs)];\n                                case 26:\n                                    _g.sent();\n                                    return [3 /*break*/, 48];\n                                case 27:\n                                    // @ts-ignore\n                                    pos.column = pos.column - 1;\n                                    editor.setPosition(pos);\n                                    return [4 /*yield*/, sleep(keyboardTypingPauseMs)];\n                                case 28:\n                                    _g.sent();\n                                    return [3 /*break*/, 48];\n                                case 29:\n                                    // @ts-ignore\n                                    pos.column = pos.column + 1;\n                                    editor.setPosition(pos);\n                                    return [4 /*yield*/, sleep(keyboardTypingPauseMs)];\n                                case 30:\n                                    _g.sent();\n                                    return [3 /*break*/, 48];\n                                case 31: return [4 /*yield*/, simulateHumanTypingInMonaco(editor, \"\\n\", keyboardTypingPauseMs)];\n                                case 32:\n                                    _g.sent();\n                                    return [3 /*break*/, 48];\n                                case 33:\n                                    // simulate moving to the end of the current line\n                                    // @ts-ignore\n                                    pos.column = 100000;\n                                    editor.setPosition(pos);\n                                    return [4 /*yield*/, sleep(keyboardTypingPauseMs)];\n                                case 34:\n                                    _g.sent();\n                                    return [3 /*break*/, 48];\n                                case 35: return [4 /*yield*/, simulateHumanTypingInMonaco(editor, \" \", keyboardTypingPauseMs)];\n                                case 36:\n                                    _g.sent();\n                                    return [3 /*break*/, 48];\n                                case 37:\n                                    deleteCount = parseInt(action.value) || 1;\n                                    for (j = 0; j < deleteCount; j++) {\n                                        // @ts-ignore - test to see if this works\n                                        editor.trigger(1, \"deleteLeft\");\n                                    }\n                                    return [4 /*yield*/, sleep(keyboardTypingPauseMs)];\n                                case 38:\n                                    _g.sent();\n                                    return [3 /*break*/, 48];\n                                case 39: return [4 /*yield*/, simulateHumanTypingInMonaco(editor, action.value, keyboardTypingPauseMs)];\n                                case 40:\n                                    _g.sent();\n                                    return [3 /*break*/, 48];\n                                case 41:\n                                    scrollUpDistance = parseInt(action.value) || 3;\n                                    currentLine = ((_c = editor.getPosition()) === null || _c === void 0 ? void 0 : _c.lineNumber) || 1;\n                                    targetLine = Math.max(1, currentLine - scrollUpDistance);\n                                    // Use Monaco's smooth reveal animation\n                                    editor.revealLineInCenterIfOutsideViewport(targetLine);\n                                    return [4 /*yield*/, sleep(standardPauseMs)];\n                                case 42:\n                                    _g.sent(); // Small delay for animation\n                                    return [3 /*break*/, 48];\n                                case 43:\n                                    scrollDownDistance = parseInt(action.value) || 3;\n                                    currentLineDown = ((_d = editor.getPosition()) === null || _d === void 0 ? void 0 : _d.lineNumber) || 1;\n                                    targetLineDown = currentLineDown + scrollDownDistance;\n                                    // Use Monaco's smooth reveal animation\n                                    editor.revealLineInCenterIfOutsideViewport(targetLineDown);\n                                    return [4 /*yield*/, sleep(standardPauseMs)];\n                                case 44:\n                                    _g.sent(); // Small delay for animation\n                                    return [3 /*break*/, 48];\n                                case 45: \n                                // do the standard delay for mouse movement - padded with 300ms so it allows time for the animation to complete\n                                return [4 /*yield*/, sleep(standardPauseMs + 300)];\n                                case 46:\n                                    // do the standard delay for mouse movement - padded with 300ms so it allows time for the animation to complete\n                                    _g.sent();\n                                    return [3 /*break*/, 48];\n                                case 47:\n                                    // no op - but still do default delay\n                                    // await sleep(standardPauseMs);\n                                    console.warn(\"Unable to apply action\", JSON.stringify(action));\n                                    return [3 /*break*/, 48];\n                                case 48: return [2 /*return*/];\n                            }\n                        });\n                    };\n                    i = 0;\n                    _e.label = 2;\n                case 2:\n                    if (!(i < times)) return [3 /*break*/, 5];\n                    return [5 /*yield**/, _loop_1(i)];\n                case 3:\n                    _e.sent();\n                    _e.label = 4;\n                case 4:\n                    i++;\n                    return [3 /*break*/, 2];\n                case 5: return [2 /*return*/, startTime];\n            }\n        });\n    });\n};\n\n/**\n * Represents a powerful IDE with file explorer, multiple editors, and terminal\n * @param props\n * @returns\n */\nfunction CodeVideoIDE(props) {\n    var _this = this;\n    var theme = props.theme, project = props.project, mode = props.mode, allowFocusInEditor = props.allowFocusInEditor, defaultLanguage = props.defaultLanguage, currentActionIndex = props.currentActionIndex, currentLessonIndex = props.currentLessonIndex, isSoundOn = props.isSoundOn, withCaptions = props.withCaptions, actionFinishedCallback = props.actionFinishedCallback, playBackCompleteCallback = props.playBackCompleteCallback, speakActionAudios = props.speakActionAudios, fileExplorerWidth = props.fileExplorerWidth, terminalHeight = props.terminalHeight, mouseColor = props.mouseColor, fontSizePx = props.fontSizePx, monacoLoadedCallback = props.monacoLoadedCallback, isEmbedMode = props.isEmbedMode, requestStepModeCallback = props.requestStepModeCallback, requestNextActionCallback = props.requestNextActionCallback, requestPreviousActionCallback = props.requestPreviousActionCallback, requestPlaybackStartCallback = props.requestPlaybackStartCallback, _a = props.isFileExplorerVisible, isFileExplorerVisible = _a === void 0 ? true : _a, _b = props.isTerminalVisible, isTerminalVisible = _b === void 0 ? true : _b, _c = props.keyboardTypingPauseMs, keyboardTypingPauseMs = _c === void 0 ? KEYBOARD_TYPING_PAUSE_MS : _c, _d = props.standardPauseMs, standardPauseMs = _d === void 0 ? STANDARD_PAUSE_MS : _d, _e = props.longPauseMs, longPauseMs = _e === void 0 ? LONG_PAUSE_MS : _e, _f = props.resolution, resolution = _f === void 0 ? '1080p' : _f, _g = props.showDevBox, showDevBox = _g === void 0 ? false : _g;\n    var isRecording = mode === 'record';\n    var _h = useState(), editors = _h[0], setEditors = _h[1];\n    var _j = useState(), currentEditor = _j[0], setCurrentEditor = _j[1];\n    var _k = useState(), currentFileName = _k[0], setCurrentFileName = _k[1];\n    var _l = useState(), currentFileStructure = _l[0], setCurrentFileStructure = _l[1];\n    var _m = useState(''), currentCode = _m[0], setCurrentCode = _m[1];\n    var _o = useState(''), terminalBuffer = _o[0], setTerminalBuffer = _o[1];\n    var _p = useState(DEFAULT_MOUSE_POSITION), targetMousePosition = _p[0], setTargetMousePosition = _p[1];\n    var _q = useState(DEFAULT_MOUSE_POSITION), currentMousePosition = _q[0], setCurrentMousePosition = _q[1];\n    var _r = useState(DEFAULT_CARET_POSITION), currentCaretPosition = _r[0], setCurrentCaretPosition = _r[1];\n    var _s = useState(''), captionText = _s[0], setCaptionText = _s[1];\n    var _t = useState(defaultLanguage); _t[0]; var setCurrentEditorLanguage = _t[1];\n    var _u = useState(isEmbedMode || false), showEmbedOverlay = _u[0], setShowEmbedOverlay = _u[1];\n    var _v = useState(false), isFileExplorerContextMenuVisible = _v[0], setIsFileExplorerContextMenuVisible = _v[1];\n    var _w = useState(false), isFileContextMenuVisible = _w[0], setIsFileContextMenuVisible = _w[1];\n    var _x = useState(false), isFolderContextMenuVisible = _x[0], setIsFolderContextMenuVisible = _x[1];\n    var _y = useState(false), isNewFileInputVisible = _y[0], setIsNewFileInputVisible = _y[1];\n    var _z = useState(false), isNewFolderInputVisible = _z[0], setIsNewFolderInputVisible = _z[1];\n    var _0 = useState(\"\"), newFileInputValue = _0[0], setNewFileInputValue = _0[1];\n    var _1 = useState(\"\"), newFolderInputValue = _1[0], setNewFolderInputValue = _1[1];\n    var _2 = useState(\"\"), originalFileBeingRenamed = _2[0], setOriginalFileBeingRenamed = _2[1];\n    var _3 = useState(\"\"), originalFolderBeingRenamed = _3[0], setOriginalFolderBeingRenamed = _3[1];\n    var _4 = useState(\"\"), renameFileInputValue = _4[0], setRenameFileInputValue = _4[1];\n    var _5 = useState(\"\"), renameFolderInputValue = _5[0], setRenameFolderInputValue = _5[1];\n    var _6 = useState(\"\"), currentHoveredFileName = _6[0], setCurrentHoveredFileName = _6[1];\n    var _7 = useState(\"\"), currentHoveredFolderName = _7[0], setCurrentHoveredFolderName = _7[1];\n    var _8 = useState(\"\"), newFileParentPath = _8[0], setNewFileParentPath = _8[1];\n    var _9 = useState(\"\"), newFolderParentPath = _9[0], setNewFolderParentPath = _9[1];\n    var _10 = useState(\"\"); _10[0]; var setCurrentHoveredEditorTabFileName = _10[1];\n    var _11 = useState(false), isUnsavedChangesDialogOpen = _11[0], setIsUnsavedChangesDialogOpen = _11[1];\n    var _12 = useState(\"\"), unsavedFileName = _12[0], setUnsavedFileName = _12[1];\n    var _13 = useState(false), isSlideDisplayStep = _13[0], setIsSlideDisplayStep = _13[1];\n    var _14 = useState(\"\"), slideMarkdown = _14[0], setSlideMarkdown = _14[1];\n    var _15 = useState(false), isExternalWebPreviewDisplayStep = _15[0], setIsExternalWebPreviewDisplayStep = _15[1];\n    var _16 = useState([]), webPreviewFilesState = _16[0], setWebPreviewFilesState = _16[1];\n    var _17 = useState(false), isExternalBrowserDisplayStep = _17[0], setIsExternalBrowserDisplayStep = _17[1];\n    var _18 = useState(null), externalBrowserStepUrlState = _18[0], setExternalBrowserStepUrlState = _18[1];\n    var _19 = useState(-1), prevActionIndex = _19[0], setPrevActionIndex = _19[1];\n    var _20 = useState(false), showBlockCaret = _20[0], setShowBlockCaret = _20[1];\n    var _21 = useState(0), currentExternalBrowserScrollPosition = _21[0], setCurrentExternalBrowserScrollPosition = _21[1];\n    var containerRef = useRef(null);\n    var monacoEditorRef = useRef(undefined);\n    var globalMonacoRef = useRef(undefined);\n    // Store editor view state to preserve caret position when overlays are shown/hidden\n    var editorViewStateRef = useRef(null);\n    var isRestoringViewStateRef = useRef(false);\n    // for cleanup TODO\n    // const modelUrisRef = useRef<Set<string>>(new Set());\n    // const prevMode = useRef<GUIMode>(mode);\n    // const isInitialMount = useRef(true);\n    var applyAnimation = function () { return __awaiter(_this, void 0, void 0, function () {\n        var actions, currentAction, scrollPosition;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    actions = extractActionsFromProject(project, currentLessonIndex);\n                    currentAction = currentActionIndex >= 0 && currentActionIndex < actions.length ? actions[currentActionIndex] : null;\n                    if (!currentAction) {\n                        playBackCompleteCallback && playBackCompleteCallback();\n                        return [2 /*return*/];\n                    }\n                    if (!monacoEditorRef.current) return [3 /*break*/, 3];\n                    return [4 /*yield*/, executeActionPlaybackForMonacoInstance(monacoEditorRef.current, project, currentActionIndex, currentLessonIndex, currentAction, isSoundOn, setEditors, setCurrentEditor, setCurrentFileName, setCurrentCode, setCurrentCaretPosition, setTerminalBuffer, targetMousePosition, containerRef, setTargetMousePosition, setCaptionText, speakActionAudios, setNewFileInputValue, setNewFolderInputValue, setRenameFileInputValue, setRenameFolderInputValue, keyboardTypingPauseMs, standardPauseMs, longPauseMs)];\n                case 1:\n                    _a.sent();\n                    if (!(currentAction.name === \"external-browser-scroll\")) return [3 /*break*/, 3];\n                    scrollPosition = parseInt(currentAction.value) || 0;\n                    setCurrentExternalBrowserScrollPosition(scrollPosition);\n                    return [4 /*yield*/, sleep(standardPauseMs)];\n                case 2:\n                    _a.sent();\n                    _a.label = 3;\n                case 3:\n                    updateState();\n                    actionFinishedCallback && actionFinishedCallback();\n                    return [2 /*return*/];\n            }\n        });\n    }); };\n    // Handle scroll actions for step mode\n    var handleStepModeScrollActions = function () {\n        var actions = extractActionsFromProject(project, currentLessonIndex);\n        var currentAction = currentActionIndex >= 0 && currentActionIndex < actions.length ? actions[currentActionIndex] : null;\n        if (!currentAction) {\n            return;\n        }\n        switch (currentAction.name) {\n            case \"editor-scroll-up\":\n                if (monacoEditorRef.current) {\n                    var scrollUpDistance = parseInt(currentAction.value) || 3; // Default to 3 lines\n                    var currentPosition = monacoEditorRef.current.getPosition();\n                    var currentLine = (currentPosition === null || currentPosition === void 0 ? void 0 : currentPosition.lineNumber) || 1;\n                    monacoEditorRef.current.revealLineInCenter(Math.max(1, currentLine - scrollUpDistance));\n                }\n                break;\n            case \"editor-scroll-down\":\n                if (monacoEditorRef.current) {\n                    var scrollDownDistance = parseInt(currentAction.value) || 3; // Default to 3 lines\n                    var currentPositionDown = monacoEditorRef.current.getPosition();\n                    var currentLineDown = (currentPositionDown === null || currentPositionDown === void 0 ? void 0 : currentPositionDown.lineNumber) || 1;\n                    monacoEditorRef.current.revealLineInCenter(currentLineDown + scrollDownDistance);\n                }\n                break;\n            case \"external-browser-scroll\":\n                var scrollPosition = parseInt(currentAction.value) || 0;\n                setCurrentExternalBrowserScrollPosition(scrollPosition);\n                break;\n        }\n    };\n    var updateState = function () {\n        var _a = reconstituteAllPartsOfState(project, currentActionIndex, currentLessonIndex), editors = _a.editors, currentEditor = _a.currentEditor, currentFilename = _a.currentFilename, fileExplorerSnapshot = _a.fileExplorerSnapshot, currentCode = _a.currentCode, currentCaretPosition = _a.currentCaretPosition, currentTerminalBuffer = _a.currentTerminalBuffer, captionText = _a.captionText, actions = _a.actions, mouseSnapshot = _a.mouseSnapshot, isUnsavedChangesDialogOpen = _a.isUnsavedChangesDialogOpen, unsavedFileName = _a.unsavedFileName;\n        setEditors(editors);\n        setCurrentEditor(currentEditor);\n        setCurrentFileName(currentFilename);\n        setCurrentFileStructure(fileExplorerSnapshot.fileStructure);\n        // In step mode, update code first, then caret position after a brief delay\n        if (mode === 'step') {\n            setCurrentCode(currentCode);\n            // Use setTimeout to ensure caret is set after Monaco processes the content change\n            setTimeout(function () {\n                setCurrentCaretPosition(currentCaretPosition);\n            }, 0);\n            // Only set input values in step mode, not replay mode where animation handles it\n            setNewFileInputValue(fileExplorerSnapshot.newFileInputValue);\n            setNewFolderInputValue(fileExplorerSnapshot.newFolderInputValue);\n            // Handle scroll actions for step mode after state update\n            setTimeout(function () {\n                handleStepModeScrollActions();\n            }, 0); // Execute on next tick to ensure editor is ready\n            // Only update mouse position in step mode, not in replay mode\n            // This prevents double mouse movement animations in replay mode\n            updateMouseStateAndSideEffects(actions);\n        }\n        setTerminalBuffer(currentTerminalBuffer);\n        setCaptionText(captionText);\n        setIsFileExplorerContextMenuVisible(fileExplorerSnapshot.isFileExplorerContextMenuOpen);\n        setIsFileContextMenuVisible(fileExplorerSnapshot.isFileContextMenuOpen);\n        setIsFolderContextMenuVisible(fileExplorerSnapshot.isFolderContextMenuOpen);\n        setIsNewFileInputVisible(fileExplorerSnapshot.isNewFileInputVisible);\n        setIsNewFolderInputVisible(fileExplorerSnapshot.isNewFolderInputVisible);\n        setOriginalFileBeingRenamed(fileExplorerSnapshot.originalFileBeingRenamed);\n        setOriginalFolderBeingRenamed(fileExplorerSnapshot.originalFolderBeingRenamed);\n        setCurrentHoveredFileName(mouseSnapshot.currentHoveredFileName);\n        setCurrentHoveredFolderName(mouseSnapshot.currentHoveredFolderName);\n        setNewFileParentPath(fileExplorerSnapshot.newFileParentPath);\n        setNewFolderParentPath(fileExplorerSnapshot.newFolderParentPath);\n        setCurrentHoveredEditorTabFileName(mouseSnapshot.currentHoveredEditorTabFileName);\n        setIsUnsavedChangesDialogOpen(isUnsavedChangesDialogOpen);\n        setUnsavedFileName(unsavedFileName);\n    };\n    // This is copied basically in animation way down logic below, could be refactored\n    var updateMouseStateAndSideEffects = function (actions) {\n        if (currentActionIndex === 0 && mode === 'step') {\n            if (!(containerRef === null || containerRef === void 0 ? void 0 : containerRef.current)) {\n                return;\n            }\n            var rect = containerRef.current.getBoundingClientRect();\n            setTargetMousePosition({\n                x: rect.width / 2,\n                y: rect.height / 2,\n            });\n            return;\n        }\n        var currentAction = currentActionIndex >= 0 && currentActionIndex < actions.length ? actions[currentActionIndex] : null;\n        if (!currentAction)\n            return;\n        var newPosition = getNewMousePosition(targetMousePosition, currentAction, containerRef);\n        // Safety check to prevent undefined coordinates\n        if (!newPosition || isNaN(newPosition.x) || isNaN(newPosition.y) ||\n            newPosition.x === undefined || newPosition.y === undefined) {\n            console.warn('Invalid mouse position detected, keeping current position:', newPosition);\n            return;\n        }\n        console.log(\"Action: \".concat(currentAction.name, \", New position: x=\").concat(newPosition.x, \", y=\").concat(newPosition.y));\n        setTargetMousePosition(newPosition);\n    };\n    // current code update in replay mode - now handled by Monaco model management effect\n    // to prevent conflicts with typing animations\n    useEffect(function () {\n        // This effect is now mostly handled by the Monaco model management effect above\n        // to prevent conflicts between typing animations and content updates\n    }, [currentCode, mode]);\n    // this effect handles the logic for displaying slides, web previews, and external browser steps\n    // we want to continue display those even if followed by an author action\n    useEffect(function () {\n        var actions = extractActionsFromProject(project, currentLessonIndex);\n        var currentAction = currentActionIndex >= 0 && currentActionIndex < actions.length ? actions[currentActionIndex] : null;\n        // Determine if we're moving forward or backward through actions\n        var isSteppingForward = currentActionIndex > prevActionIndex;\n        if (currentAction) {\n            if (currentAction.name === 'slide-display') {\n                // When current action is a slide-display, always show it\n                setIsSlideDisplayStep(true);\n                setSlideMarkdown(currentAction.value);\n            }\n            else if (currentAction.name === 'external-web-preview') {\n                // When current action is external-web-preview, always show it\n                setIsExternalWebPreviewDisplayStep(true);\n                var virtualIDE = new VirtualIDE(project);\n                virtualIDE.applyActions(actions.slice(0, currentActionIndex + 1));\n                setWebPreviewFilesState(virtualIDE.getFullFilePathsAndContents());\n            }\n            else if (currentAction.name === 'external-browser' || currentAction.name === 'external-browser-scroll') {\n                // When current action is external-browser, always show it\n                setIsExternalBrowserDisplayStep(true);\n                setExternalBrowserStepUrlState(currentAction.value);\n            }\n            else if (currentAction.name.startsWith('author-')) {\n                // For author actions, maintain slide/web preview state when stepping forward\n                // but hide them when stepping backward\n                if (!isSteppingForward) {\n                    setIsSlideDisplayStep(false);\n                    setSlideMarkdown(\"\");\n                    setIsExternalWebPreviewDisplayStep(false);\n                    setWebPreviewFilesState([]);\n                    setIsExternalBrowserDisplayStep(false);\n                    setExternalBrowserStepUrlState(null);\n                }\n                // When stepping forward, keep any currently displayed slide/web preview\n            }\n            else {\n                // For any other action, always hide slides and web previews\n                setIsSlideDisplayStep(false);\n                setSlideMarkdown(\"\");\n                setIsExternalWebPreviewDisplayStep(false);\n                setWebPreviewFilesState([]);\n                setIsExternalBrowserDisplayStep(false);\n                setExternalBrowserStepUrlState(null);\n            }\n        }\n        else {\n            // No action at this index, hide everything\n            setIsSlideDisplayStep(false);\n            setSlideMarkdown(\"\");\n            setIsExternalWebPreviewDisplayStep(false);\n            setWebPreviewFilesState([]);\n            setIsExternalBrowserDisplayStep(false);\n            setExternalBrowserStepUrlState(null);\n        }\n        // Update the previous action index for next comparison - moved to end and add dependency check\n        if (mode === 'step' || currentActionIndex > 0) {\n            setPrevActionIndex(currentActionIndex);\n        }\n    }, [currentActionIndex, project, currentLessonIndex, mode]);\n    // Effect to handle terminal caret based on current action\n    useEffect(function () {\n        var actions = extractActionsFromProject(project, currentLessonIndex);\n        var currentAction = currentActionIndex >= 0 && currentActionIndex < actions.length ? actions[currentActionIndex] : null;\n        if (currentAction && currentAction.name.startsWith('terminal-')) {\n            setShowBlockCaret(true);\n            // Keep block caret for 2 seconds after terminal action\n            var timer_1 = setTimeout(function () {\n                setShowBlockCaret(false);\n            }, 2000);\n            return function () { return clearTimeout(timer_1); };\n        }\n        else {\n            setShowBlockCaret(false);\n        }\n    }, [currentActionIndex, project, currentLessonIndex]);\n    // whenever issoundon changes or currentActionIndex, and we are in step mode, and the current action includes 'speak', we should speak\n    useEffect(function () {\n        var _a;\n        var actions = extractActionsFromProject(project, currentLessonIndex);\n        var currentAction = currentActionIndex >= 0 && currentActionIndex < actions.length ? actions[currentActionIndex] : null;\n        if (isSoundOn && mode === 'step' && currentAction && currentAction.name.startsWith('author-')) {\n            // try to find a match by the sha256 hash of the action.value in the speakActionAudios array\n            var action_1 = currentAction;\n            var mp3Url = (_a = speakActionAudios.find(function (audio) { return audio.text === action_1.value; })) === null || _a === void 0 ? void 0 : _a.mp3Url;\n            // if audio element was not found, it is undefined and we default to the speech synthesis\n            speakText(currentAction.value, 1, mp3Url);\n        }\n        else {\n            stopSpeaking();\n        }\n    }, [isSoundOn, project, currentActionIndex, currentLessonIndex]);\n    // update virtual when current action index changes\n    useEffect(function () {\n        // normal step by step mode OR initial replay state - can update state immediately\n        if (mode === 'step') {\n            updateState();\n            return;\n        }\n        // if playback mode, we need to animate the typing on the editor, then we can apply the action to maintain state, then we call the actionFinishedCallback\n        if (mode === 'replay') {\n            // need to handle the first reset\n            if (currentActionIndex === 0) {\n                updateState();\n            }\n            // this in turn calls updateState once the animation is complete, and then calls actionFinishedCallback\n            applyAnimation();\n        }\n    }, [mode, currentActionIndex, project]);\n    var handleEditorDidMount = function (monacoEditor, monaco) {\n        monacoEditorRef.current = monacoEditor;\n        globalMonacoRef.current = monaco;\n        // Don't create a model here - let the model management useEffect handle it\n        // This ensures proper file switching behavior in replay mode\n        // Ensure theme is applied after a short delay\n        // monaco.editor.defineTheme(\n        //   \"Monokai\",\n        //   Monokai as monaco.editor.IStandaloneThemeData\n        // );\n        // setTimeout(() => {\n        //   monaco.editor.setTheme('Monokai');\n        // }, 1);\n        monacoLoadedCallback && monacoLoadedCallback();\n    };\n    // caret position effect - now works for both replay and step modes since Monaco editor is always rendered\n    useEffect(function () {\n        // Don't interfere if we're in the middle of restoring view state\n        if (isRestoringViewStateRef.current) {\n            return;\n        }\n        if (monacoEditorRef.current && (mode === 'step' || mode === 'replay')) {\n            // Use setTimeout to ensure caret positioning happens after Monaco has finished updating content\n            // This is especially important in step mode where content can change significantly\n            var timer_2 = setTimeout(function () {\n                if (monacoEditorRef.current) {\n                    monacoEditorRef.current.setPosition({\n                        lineNumber: currentCaretPosition.row,\n                        column: currentCaretPosition.col\n                    });\n                    // This only scrolls if the position is not already visible.\n                    monacoEditorRef.current.revealPosition({\n                        lineNumber: currentCaretPosition.row,\n                        column: currentCaretPosition.col\n                    });\n                    // trigger a focus to actually highlight where the caret is - if allowFocusInEditor is true\n                    if (allowFocusInEditor) {\n                        monacoEditorRef.current.focus();\n                    }\n                }\n            }, 0); // Execute on next tick to ensure Monaco has finished content updates\n            return function () { return clearTimeout(timer_2); };\n        }\n    }, [currentCaretPosition, allowFocusInEditor, mode]);\n    // Additional effect to handle caret positioning after content changes in step mode\n    useEffect(function () {\n        if (mode === 'step' && monacoEditorRef.current && !isRestoringViewStateRef.current) {\n            // Use a longer timeout for content changes to ensure Monaco has finished all updates\n            var timer_3 = setTimeout(function () {\n                if (monacoEditorRef.current) {\n                    monacoEditorRef.current.setPosition({\n                        lineNumber: currentCaretPosition.row,\n                        column: currentCaretPosition.col\n                    });\n                    monacoEditorRef.current.revealPositionInCenter({\n                        lineNumber: currentCaretPosition.row,\n                        column: currentCaretPosition.col\n                    });\n                    if (allowFocusInEditor) {\n                        monacoEditorRef.current.focus();\n                    }\n                }\n            }, 10); // Slightly longer delay for content changes\n            return function () { return clearTimeout(timer_3); };\n        }\n    }, [currentCode, mode, currentCaretPosition, allowFocusInEditor]);\n    // Save/restore editor view state when overlays are shown/hidden to prevent caret position regression\n    useEffect(function () {\n        var isOverlayActive = isSlideDisplayStep || isExternalWebPreviewDisplayStep || isExternalBrowserDisplayStep;\n        if (monacoEditorRef.current) {\n            if (isOverlayActive && !editorViewStateRef.current) {\n                // Save view state before showing overlay (only if not already saved)\n                console.log('Saving editor view state before overlay, current position:', monacoEditorRef.current.getPosition());\n                editorViewStateRef.current = monacoEditorRef.current.saveViewState();\n            }\n            else if (!isOverlayActive && editorViewStateRef.current) {\n                // Restore view state after hiding overlay\n                var savedState_1 = editorViewStateRef.current;\n                console.log('Restoring editor view state after overlay');\n                // Clear the saved state first to prevent re-triggering\n                editorViewStateRef.current = null;\n                // Set flag to prevent caret position effect from interfering\n                isRestoringViewStateRef.current = true;\n                // Use setTimeout to ensure the editor has finished any re-rendering\n                setTimeout(function () {\n                    if (monacoEditorRef.current && savedState_1) {\n                        console.log('Actually restoring view state, current position before restore:', monacoEditorRef.current.getPosition());\n                        // First restore the view state to get scroll position and other state\n                        monacoEditorRef.current.restoreViewState(savedState_1);\n                        console.log('Position after restore:', monacoEditorRef.current.getPosition());\n                        console.log('Expected position:', { row: currentCaretPosition.row, col: currentCaretPosition.col });\n                        // Then set the current caret position to ensure it's at the right place\n                        monacoEditorRef.current.setPosition({\n                            lineNumber: currentCaretPosition.row,\n                            column: currentCaretPosition.col\n                        });\n                        // Reveal the position to ensure it's visible\n                        monacoEditorRef.current.revealPositionInCenter({\n                            lineNumber: currentCaretPosition.row,\n                            column: currentCaretPosition.col\n                        });\n                        console.log('Final position after manual set:', monacoEditorRef.current.getPosition());\n                        // Clear the flag after restoration is complete\n                        isRestoringViewStateRef.current = false;\n                    }\n                }, 0);\n            }\n        }\n    }, [isSlideDisplayStep, isExternalWebPreviewDisplayStep, isExternalBrowserDisplayStep, currentCaretPosition]);\n    // TODO: figure out highlights! (breaks due to SSR)\n    // const currentHighlightCoordinates = currentFile ? currentFile.highlightCoordinates : null;\n    // // highlight effect (only when not recording)\n    // useEffect(() => {\n    //   // if (typeof window !== \"undefined\" && !isRecording && monacoEditorRef.current && currentHighlightCoordinates) {\n    //   // TODO: this line breaks SSR:\n    //   // maybe we can hack our own highlight functionality...\n    //   //   monacoEditorRef.current.createDecorationsCollection([\n    //   //     {\n    //   //       range: new monaco.Range(\n    //   //         currentHighlightCoordinates.start.row,\n    //   //         currentHighlightCoordinates.start.col,\n    //   //         currentHighlightCoordinates.end.row,\n    //   //         currentHighlightCoordinates.end.col\n    //   //       ),\n    //   //       options: { inlineClassName: 'highlighted-code' }\n    //   //     }\n    //   //   ]);\n    //   //   // log out decorations for debugging\n    //   //   // console.log(monacoEditorRef.current.getVisibleRanges());\n    //   //   // trigger a focus to actually highlight where the highlight is\n    //   //   // monacoEditorRef.current.focus();\n    //   // }\n    // }, [currentHighlightCoordinates]);\n    // Gemini says this is not needed: let's see:\n    // always auto-scroll to line in center when the caret row position changes\n    // useEffect(() => {\n    //   if (monacoEditorRef.current) {\n    //     monacoEditorRef.current.revealLineInCenter(currentCaretPosition.row);\n    //   }\n    // }, [currentCaretPosition.row]);\n    // Monaco model management for proper file switching\n    // this useEffect FROM CLAUDE:\n    useEffect(function () {\n        if (monacoEditorRef.current && globalMonacoRef.current) {\n            var monaco_1 = globalMonacoRef.current;\n            var editor = monacoEditorRef.current;\n            // If there's no current editor or no editors at all, clear the model\n            if (!(currentEditor === null || currentEditor === void 0 ? void 0 : currentEditor.filename) || !editors || editors.length === 0) {\n                if (editor.getModel()) {\n                    editor.setModel(null);\n                    console.log('Cleared Monaco editor model - no active editors');\n                }\n                return;\n            }\n            // Handle normal file switching when there are editors\n            if (currentCode !== null) {\n                var filename = currentEditor.filename;\n                // Create a unique URI for this file\n                var uri = monaco_1.Uri.file(filename);\n                // Check if a model already exists for this file\n                var model = monaco_1.editor.getModel(uri);\n                if (!model) {\n                    // Create a new model for this file\n                    var language = getLanguageFromFilename(filename);\n                    model = monaco_1.editor.createModel(currentCode, language, uri);\n                    console.log(\"Created new Monaco model for file: \".concat(filename, \" with language: \").concat(language));\n                }\n                else {\n                    // In replay mode, don't update model content here since executeActionPlaybackForMonacoInstance\n                    // handles the typing animation. Only update in step mode or when file content changes significantly.\n                    if (mode === 'step' && model.getValue() !== currentCode) {\n                        model.setValue(currentCode);\n                        console.log(\"Updated Monaco model content for file: \".concat(filename, \" (step mode)\"));\n                    }\n                    else if (mode === 'replay') {\n                        // In replay mode, only update if the model is completely empty or if we're switching files\n                        // This prevents overriding the typing animation from executeActionPlaybackForMonacoInstance\n                        if (model.getValue() === '' && currentCode !== '') {\n                            model.setValue(currentCode);\n                            console.log(\"Initialized Monaco model content for file: \".concat(filename, \" (replay mode)\"));\n                        }\n                    }\n                }\n                // Set the model on the editor if it's not already set\n                if (editor.getModel() !== model) {\n                    editor.setModel(model);\n                    console.log(\"Switched Monaco editor to model for file: \".concat(filename));\n                }\n            }\n        }\n    }, [currentEditor === null || currentEditor === void 0 ? void 0 : currentEditor.filename, currentCode, editors, mode]);\n    // update the language of the editor based on the current filename every time it changes\n    useEffect(function () {\n        if (currentFileName) {\n            var detectedLanguage = getLanguageFromFilename(currentFileName);\n            setCurrentEditorLanguage(detectedLanguage);\n            // If we have an active editor model, update its language\n            if (monacoEditorRef.current && globalMonacoRef.current) {\n                var model = monacoEditorRef.current.getModel();\n                if (model) {\n                    globalMonacoRef.current.editor.setModelLanguage(model, detectedLanguage);\n                }\n            }\n        }\n    }, [currentFileName]);\n    // if embedMode is 'true', we use space bar to request playback, left arrow to request previous frame, and right arrow to request next frame\n    useEffect(function () {\n        if (isEmbedMode) {\n            var handleKeyDown_1 = function (e) {\n                if (e.key === 'ArrowRight') {\n                    setShowEmbedOverlay(false);\n                    requestStepModeCallback && requestStepModeCallback('step');\n                    requestNextActionCallback && requestNextActionCallback();\n                }\n                else if (e.key === 'ArrowLeft') {\n                    setShowEmbedOverlay(false);\n                    requestStepModeCallback && requestStepModeCallback('step');\n                    requestPreviousActionCallback && requestPreviousActionCallback();\n                }\n                else if (e.key === ' ') {\n                    setShowEmbedOverlay(false);\n                    requestPlaybackStartCallback && requestPlaybackStartCallback();\n                }\n            };\n            window.addEventListener('keydown', handleKeyDown_1);\n            return function () {\n                window.removeEventListener('keydown', handleKeyDown_1);\n            };\n        }\n    }, [isEmbedMode]);\n    // useful for debugging\n    // // before rendering log out all relevant stuff\n    // // current file\n    // console.log('currentFile', currentFile);\n    // // current file structure\n    // console.log('currentFileStructure', currentFileStructure);\n    // // current code\n    console.log('currentCode', currentCode);\n    // // terminal buffer\n    // console.log('terminalBuffer', terminalBuffer);\n    // // mouse position\n    // console.log('mousePosition', mousePosition);\n    // // current caret position\n    // console.log('currentCaretPosition', currentCaretPosition);\n    // // caption text\n    // console.log('captionText', captionText);\n    // current filepath\n    // console.log(\"currentFileName\", currentFileName)\n    // console.log(\"isUnsavedChangesDialogOpen\", isUnsavedChangesDialogOpen)\n    // console.log(\"unsavedFileName\", unsavedFileName)\n    // if we are in 4k mode, double the fontsize\n    var renderFontSizePx = fontSizePx && resolution === \"4K\" ? fontSizePx * 2 : fontSizePx;\n    // Use state variables for web preview and external browser display\n    // These are now managed by the useEffect above to support continuation during author actions\n    var webPreviewFiles = webPreviewFilesState;\n    var externalBrowserStepUrl = externalBrowserStepUrlState;\n    var actions = extractActionsFromProject(project, currentLessonIndex);\n    var currentAction = currentActionIndex >= 0 && currentActionIndex < actions.length ? actions[currentActionIndex] : null;\n    return (jsxs(Flex, { direction: \"column\", style: {\n            height: '100%',\n            width: '100%',\n            fontSize: renderFontSizePx ? \"\".concat(renderFontSizePx, \"px\") : undefined,\n            // necessary so embed overlay can be positioned absolutely\n            position: 'relative'\n        }, id: CODEVIDEO_IDE_ID, children: [jsxs(Flex, { direction: \"row\", style: {\n                    height: '100%',\n                    // borderTopLeftRadius: 'var(--radius-3)',\n                    // borderTopRightRadius: 'var(--radius-3)',\n                    overflow: 'hidden',\n                    // necessary so mouse overlay can be positioned absolutely\n                    position: 'relative',\n                }, ref: containerRef, children: [isFileExplorerVisible && jsx(FileExplorer, { theme: theme, currentFileName: currentFileName, fileStructure: currentFileStructure, fileExplorerWidth: fileExplorerWidth, currentMousePosition: currentMousePosition, isFileExplorerContextMenuVisible: isFileExplorerContextMenuVisible, isFileContextMenuVisible: isFileContextMenuVisible, isFolderContextMenuVisible: isFolderContextMenuVisible, isNewFileInputVisible: isNewFileInputVisible, isNewFolderInputVisible: isNewFolderInputVisible, newFileInputValue: newFileInputValue, newFolderInputValue: newFolderInputValue, originalFileBeingRenamed: originalFileBeingRenamed, originalFolderBeingRenamed: originalFolderBeingRenamed, renameFileInputValue: renameFileInputValue, renameFolderInputValue: renameFolderInputValue, currentHoveredFileName: currentHoveredFileName, currentHoveredFolderName: currentHoveredFolderName, newFileParentPath: newFileParentPath, newFolderParentPath: newFolderParentPath }), jsxs(Flex, { \"data-codevideo-id\": EDITOR_AREA_ID, \"data-testid\": \"editor-area\", direction: \"column\", width: \"100%\", children: [jsx(EditorTabs, { theme: theme, editors: editors || [], currentEditor: currentEditor }), jsxs(Box, { \"data-codevideo-id\": EDITOR_ID, style: {\n                                    flex: 1,\n                                    position: 'relative',\n                                    userSelect: isRecording ? 'auto' : 'none'\n                                }, children: [jsx(Box, { style: {\n                                            display: editors && editors.length === 0 ? 'block' : 'none',\n                                            backgroundColor: theme === 'light' ? 'var(--gray-5)' : 'var(--gray-4)',\n                                            height: '100%',\n                                            width: '100%'\n                                        } }), jsx(Box, { style: {\n                                            display: editors && editors.length === 0 ? 'none' : 'block',\n                                            backgroundColor: theme === 'light' ? 'var(--gray-5)' : 'var(--gray-4)',\n                                            height: '100%',\n                                            width: '100%',\n                                            pointerEvents: isRecording ? 'auto' : 'none',\n                                            cursor: isRecording ? 'auto' : 'none',\n                                            userSelect: isRecording ? 'auto' : 'none',\n                                        }, children: jsx(Editor, { path: currentEditor === null || currentEditor === void 0 ? void 0 : currentEditor.filename, theme: theme === 'light' ? 'vs' : 'vs-dark', className: \"no-mouse \".concat(editors && editors.length === 0 ? 'display-none' : 'display-block'), \n                                            // value in replay mode is handled by setting the model value directly\n                                            // in step mode, we use the currentCode state variable\n                                            value: isRecording || mode === 'replay' ? undefined : currentCode, defaultValue: isRecording ? currentCode : undefined, defaultLanguage: defaultLanguage, options: {\n                                                automaticLayout: true,\n                                                minimap: { enabled: true },\n                                                scrollBeyondLastLine: true,\n                                                fontSize: renderFontSizePx ? renderFontSizePx : 14,\n                                                fontFamily: 'Fira Code, monospace',\n                                                fontLigatures: true,\n                                                readOnly: mode === 'step',\n                                                lineNumbers: 'on',\n                                                renderWhitespace: 'selection',\n                                                wrappingStrategy: 'advanced',\n                                                wordWrap: 'on',\n                                                wordWrapColumn: 80,\n                                                bracketPairColorization: { enabled: true },\n                                                matchBrackets: 'never',\n                                                formatOnPaste: true,\n                                                formatOnType: true,\n                                            }, onMount: handleEditorDidMount }) })] }), isTerminalVisible && jsx(Terminal, { theme: theme, terminalBuffer: terminalBuffer, terminalHeight: terminalHeight, fontSizePx: renderFontSizePx, showBlockCaret: showBlockCaret })] }), isSlideDisplayStep && (jsx(Box, { style: {\n                            position: 'absolute',\n                            top: 0,\n                            left: 0,\n                            width: '100%',\n                            height: '100%',\n                            zIndex: 1000,\n                            backgroundColor: 'var(--gray-1)' // Ensure solid background\n                        }, children: jsx(SlideViewer, { hljsTheme: 'monokai', slideMarkdown: slideMarkdown, fontSizePx: renderFontSizePx }) })), isExternalBrowserDisplayStep && externalBrowserStepUrl && (jsx(Box, { style: {\n                            position: 'absolute',\n                            top: 0,\n                            left: 0,\n                            width: '100%',\n                            height: '100%',\n                            zIndex: 1000,\n                            backgroundColor: 'var(--gray-1)' // Ensure solid background\n                        }, children: jsx(ExternalWebViewer, { url: externalBrowserStepUrl, mode: mode, scrollPosition: currentExternalBrowserScrollPosition }) })), isExternalWebPreviewDisplayStep && (jsx(Box, { style: {\n                            position: 'absolute',\n                            top: 0,\n                            left: 0,\n                            width: '100%',\n                            height: '100%',\n                            zIndex: 1000,\n                            backgroundColor: 'var(--gray-1)' // Ensure solid background\n                        }, children: jsx(WebPreview, { files: webPreviewFiles }) }))] }), jsx(UnsavedChangesDialog, { isUnsavedChangesDialogOpen: isUnsavedChangesDialogOpen, unsavedFileName: unsavedFileName }), !showEmbedOverlay && jsx(MouseOverlay, { mode: mode, mouseVisible: true, targetMousePosition: targetMousePosition, maximumAnimationDuration: standardPauseMs, onCurrentPositionChange: setCurrentMousePosition, onAnimationFinished: function () {\n                    // TOOD?\n                }, mouseColor: mouseColor }), !showEmbedOverlay && withCaptions && jsx(CaptionOverlay, { captionText: captionText, fontSizePx: renderFontSizePx }), showDevBox && jsx(DevBox, { variables: {\n                    // currentCode,\n                    // terminalBuffer,\n                    currentMousePosition: currentMousePosition,\n                    currentCaretPosition: currentCaretPosition,\n                    // captionText,\n                    currentFileName: currentFileName,\n                    currentCode: currentCode.substring(0, 50) + '...',\n                    actionLength: actions.length,\n                    currentActionIndex: currentActionIndex,\n                    currentAction: currentAction\n                    // isUnsavedChangesDialogOpen,\n                    // unsavedFileName,\n                    // currentFileStructure\n                } }), showEmbedOverlay && jsx(EmbedOverlay, {})] }));\n}\n\nexport { CODEVIDEO_IDE_ID, CodeVideoIDE, EDITOR_AREA_ID, EDITOR_ID, EXTERNAL_WEB_VIEWER_ID, FILE_EXPLORER_ID, SLIDE_ID, TERMINAL_ID };\n"],"names":["CODEVIDEO_IDE_ID","LONG_PAUSE_MS","STANDARD_PAUSE_MS","KEYBOARD_TYPING_PAUSE_MS","DEFAULT_CARET_POSITION","row","col","DEFAULT_MOUSE_POSITION","x","y","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","_","label","sent","trys","ops","g","create","Iterator","verb","Symbol","iterator","v","op","TypeError","pop","push","__spreadArray","to","from","pack","ar","l","Array","slice","concat","EditorTabs","props","editors","theme","currentEditor","jsx","style","backgroundColor","height","borderBottom","pointerEvents","userSelect","children","map","editor","absoluteFileName","filename","baseFileName","split","isActive","jsxs","align","px","py","borderRight","position","fontFamily","color","fontWeight","isSaved","ml","padding","lineHeight","minWidth","width","borderRadius","SuppressedError","FILE_EXPLORER_ID","EDITOR_AREA_ID","EDITOR_ID","TERMINAL_ID","ExternalWebViewer","url","mode","scrollPosition","_a","scrollDuration","_b","useState","hasError","setHasError","_c","hasLoaded","setHasLoaded","iframeRef","useRef","prevScrollPositionRef","useEffect","timer","setTimeout","clearTimeout","current","iframeWindow_1","contentWindow","scrollTo","top","behavior","startPosition_1","startTime_1","performance","now","animateScroll_1","currentTime","elapsedTime","progress","Math","pow","newPosition","requestAnimationFrame","error","console","JSON","stringify","justify","size","ref","src","title","border","sandbox","onLoad","onError","sleep","ms","speakText","text","volume","mp3Url","speakTextFallback","response","audioBlob","audioUrl_1","audio","error_1","fallbackError_1","stopSpeaking","fetch","method","headers","model","voice","input","response_format","speed","ok","Error","status","blob","URL","createObjectURL","Audio","onended","revokeObjectURL","onerror","event","play","warn","log","audioElement","type","target","catch","message","e_1","name","stack","String","getProperty","jsonValue","speechSynthesis","window","utterance","SpeechSynthesisUtterance","onend","speak","cancel","audioElements","document","getElementsByTagName","pause","getLanguageFromFilename","extension","toLowerCase","extensionMap","FileIcon","ext","toUpperCase","Js","Go","FileExplorerContextMenu","isVisible","currentMousePosition","newFileRef","newFolderRef","hoveredItem","setHoveredItem","menuPosition","setMenuPosition","undefined","fileRect","getBoundingClientRect","left","right","bottom","folderRect","checkIntersection","boxShadow","zIndex","overflow","direction","cursor","FileContextMenu","renameRef","deleteRef","FolderContextMenu","deleteRect","FileExplorer","effectiveFileParentPath","effectiveFolderParentPath","shouldShowRootFileInput","shouldShowRootFolderInput","isFileExplorerContextMenuVisible","isFileContextMenuVisible","isFolderContextMenuVisible","isNewFileInputVisible","isNewFolderInputVisible","newFolderInputValue","newFileInputValue","currentFileName","originalFileBeingRenamed","originalFolderBeingRenamed","renameFileInputValue","renameFolderInputValue","currentHoveredFileName","currentHoveredFolderName","fileStructure","fileExplorerWidth","newFileParentPath","newFolderParentPath","getEffectiveParentPath","inputType","resolveFileOrFolderText","readOnly","fontSize","renderNewFileInput","effectiveParentPath","inputId","gap","mt","autoFocus","renderNewFolderInput","renderFileTree","structure","path","level","entries","sort","a","b","aIsDir","localeCompare","item","fullPath","isDirectory","leftMargin","nextLevel","isHighlight","shouldShowFileInput","shouldShowFolderInput","file","folder","Fragment","flexGrow","minHeight","Terminal","terminalBuffer","terminalHeight","fontSizePx","showBlockCaret","terminalRef","scrollTop","scrollHeight","borderTop","scrollBehavior","whiteSpace","wordBreak","display","marginBottom","boxSizing","calculateCubicBezierPoint","p0","p1","p2","p3","_i","points_1","point","isNaN","mt2","mt3","t2","t3","MouseOverlay","mouseVisible","targetMousePosition","maximumAnimationDuration","mouseColor","arcHeight","numberOfCurves","onAnimationFinished","onCurrentPositionChange","overlayRef","safeTargetPosition","currentPosition","setCurrentPosition","_d","prevPosition","setPrevPosition","_e","isAnimating","setIsAnimating","_f","setPathPoints","animationRef","lastTargetPositionRef","startPosition","curvesToUse","floor","random","controlPoints","start","end","points","baseDistance","hypot","curveCount","max","min","controlPoint","segment","perpFactor","baseX","baseY","dx","dy","len","generateControlPoints","distance","MAX_DURATION","calculatedDuration","animationPoints","numSamples","tmp","j","k","currentPoint","nextPoint","samplePathPoints","validAnimationPoints","filter","isFinite","toFixed","startTime","duration","animateFrame","timestamp","elapsed","frameIndex","cancelAnimationFrame","safeCurrentPosition","id","transform","transition","viewBox","version","xmlns","d","fill","stroke","strokeWidth","strokeLinejoin","CaptionOverlay","captionText","maxWidth","EmbedOverlay","inset","alignItems","justifyContent","mb","href","UnsavedChangesDialog","isUnsavedChangesDialogOpen","unsavedFileName","textAlign","outline","DevBox","variables","maxHeight","key","marked","async","emptyLangClass","langPrefix","highlight","code","lang","info","language","getLanguage","setOptions","gfm","breaks","ProjectType","SlideViewer","slideMarkdown","hljsTheme","backgroundImage","_g","backgroundSize","_h","_j","themeId","existing","getElementById","versionString","link","createElement","rel","head","appendChild","html","useMemo","raw","parse","sanitize","slideContainerStyle","margin","backgroundRepeat","backgroundPosition","slideStyle","dangerouslySetInnerHTML","__html","WASM_URLS","esbuildInitialized","esbuildInitializing","esbuildInitPromise","WebPreview","files","esbuildReady","setEsbuildReady","esbuildError","setEsbuildError","isMounted","error_2","lastError","WASM_URLS_1","wasmURL","worker","vfs_1","files_1","entryHtmlFile","projectType","scriptEntry","bundledCode_1","error_3","Map","startsWith","set","content","find","endsWith","HTML","some","TSX","JSX","replace","match","cssPath","cssContent","get","scriptPath","jsContent","test","bundle","write","format","platform","entryPoints","plugins","vfs","setup","build","_this","onResolve","args","external","has","namespace","contents","loader","define","outputFiles","bodyTag","srcdoc","reconstituteAllPartsOfState","project","currentActionIndex","currentLessonIndex","actions","sanitizedCurrentActionIndex","actionsToApply","virtualIDE","applyActions","courseSnapshot","getCourseSnapshot","editorSnapshot","caretPosition","highlightCoordinates","currentFilename","fileExplorerSnapshot","currentCode","currentCaretPosition","currentTerminalBuffer","virtualTerminals","getBuffer","join","authorSnapshot","authors","currentSpeechCaption","mouseSnapshot","convertToContainerCoordinates","containerRef","containerRect","getCoordinatesOfFileOrFolder","fileOrFolderPath","selector","readyState","querySelectorAll","allFileExplorerElements","forEach","el","getAttribute","debugDOMState","fileElement","querySelector","rect","absoluteCoords","parseCoordinatesFromMouseCoordinateAction","parts","parseInt","generateGaussian","mean","stdDev","u1","u2","sqrt","cos","PI","getGaussianCoordinatesByCodeVideoDataID","dataId","options","randomize","stdDevPercent","element","centerX","centerY","stdDevX","stdDevY","minX","maxX","minY","maxY","getNewMousePosition","currentAction","terminal","getCoordinatesOfTerminalInput","getCoordinatesOfEditor","actionName","actionValue","percentages","simulateHumanTypingWithReactSetterCallback","setter_1","text_1","args_1","setter","typingPauseMs","characters","prev","simulateHumanTypingInMonaco","charactersToType","index","typeNextCharacter","char","selection","getSelection","executeEdits","range","startLineNumber","selectionStartLineNumber","startColumn","selectionStartColumn","endLineNumber","endColumn","forceMoveMarkers","revealPositionInCenter","lineNumber","column","focus","executeActionPlaybackForMonacoInstance","editor_1","project_1","currentActionIndex_1","currentLessonIndex_1","action_1","isSoundOn_1","setEditors_1","setCurrentEditor_1","setCurrentFileName_1","setCurrentCode_1","setCurrentCaretPosition_1","setTerminalBuffer_1","mousePosition_1","containerRef_1","setMousePosition_1","setCaptionText_1","speakActionAudios_1","setNewFileInputValue_1","setNewFolderInputValue_1","setRenameFileInputValue_1","setRenameFolderInputValue_1","action","isSoundOn","setEditors","setCurrentEditor","setCurrentFileName","setCurrentCode","setCurrentCaretPosition","setTerminalBuffer","mousePosition","setMousePosition","setCaptionText","speakActionAudios","setNewFileInputValue","setNewFolderInputValue","setRenameFileInputValue","setRenameFolderInputValue","keyboardTypingPauseMs","standardPauseMs","longPauseMs","clickModel","times","pos","_loop_1","getModel","getValue","setValue","getPosition","waitDuration","terminalOutput","terminalLines","latestLine_1","_loop_2","i_1","deleteCount","scrollUpDistance","currentLine","targetLine","scrollDownDistance","currentLineDown","targetLineDown","setPosition","trigger","revealLineInCenterIfOutsideViewport","CodeVideoIDE","allowFocusInEditor","defaultLanguage","withCaptions","actionFinishedCallback","playBackCompleteCallback","monacoLoadedCallback","isEmbedMode","requestStepModeCallback","requestNextActionCallback","requestPreviousActionCallback","requestPlaybackStartCallback","isFileExplorerVisible","isTerminalVisible","resolution","showDevBox","isRecording","_k","_l","currentFileStructure","setCurrentFileStructure","_m","_o","_p","setTargetMousePosition","_q","setCurrentMousePosition","_r","_s","_t","setCurrentEditorLanguage","_u","showEmbedOverlay","setShowEmbedOverlay","_v","setIsFileExplorerContextMenuVisible","_w","setIsFileContextMenuVisible","_x","setIsFolderContextMenuVisible","_y","setIsNewFileInputVisible","_z","setIsNewFolderInputVisible","_0","_1","_2","setOriginalFileBeingRenamed","_3","setOriginalFolderBeingRenamed","_4","_5","_6","setCurrentHoveredFileName","_7","setCurrentHoveredFolderName","_8","setNewFileParentPath","_9","setNewFolderParentPath","_10","setCurrentHoveredEditorTabFileName","_11","setIsUnsavedChangesDialogOpen","_12","setUnsavedFileName","_13","isSlideDisplayStep","setIsSlideDisplayStep","_14","setSlideMarkdown","_15","isExternalWebPreviewDisplayStep","setIsExternalWebPreviewDisplayStep","_16","webPreviewFilesState","setWebPreviewFilesState","_17","isExternalBrowserDisplayStep","setIsExternalBrowserDisplayStep","_18","externalBrowserStepUrlState","setExternalBrowserStepUrlState","_19","prevActionIndex","setPrevActionIndex","_20","setShowBlockCaret","_21","currentExternalBrowserScrollPosition","setCurrentExternalBrowserScrollPosition","monacoEditorRef","globalMonacoRef","editorViewStateRef","isRestoringViewStateRef","updateState","revealLineInCenter","currentPositionDown","handleStepModeScrollActions","updateMouseStateAndSideEffects","isFileExplorerContextMenuOpen","isFileContextMenuOpen","isFolderContextMenuOpen","currentHoveredEditorTabFileName","isSteppingForward","getFullFilePathsAndContents","timer_1","timer_2","revealPosition","timer_3","isOverlayActive","saveViewState","savedState_1","restoreViewState","monaco_1","setModel","uri","Uri","createModel","detectedLanguage","setModelLanguage","handleKeyDown_1","addEventListener","removeEventListener","renderFontSizePx","webPreviewFiles","externalBrowserStepUrl","flex","className","defaultValue","automaticLayout","minimap","enabled","scrollBeyondLastLine","fontLigatures","lineNumbers","renderWhitespace","wrappingStrategy","wordWrap","wordWrapColumn","bracketPairColorization","matchBrackets","formatOnPaste","formatOnType","onMount","monacoEditor","monaco","substring","actionLength"],"sourceRoot":""}