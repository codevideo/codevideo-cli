"use strict";(self.webpackChunkcodevideo_ide_react_examples=self.webpackChunkcodevideo_ide_react_examples||[]).push([[670],{4246:function(e,t,n){n.d(t,{Zv:function(){return be}});var r=n(5893),o=n(7294),i=n(9253),a=n(5564),l=n(4144),s=n(2396),c=n(251),u=n(9674),d=n(723),f=n(1556),p=n(9838),h=n(8069),v=n(3246),g=n(2469),x=n(7441),m=n(2537),y=n(637),b=n(2424),w=n(4981),j=n(8364),S="codevideo-ide-react",C=5e3,k=1e3,F=50,E={row:1,col:1},P={x:960,y:540},N=function(){return N=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},N.apply(this,arguments)};function M(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function l(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))}function O(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&l[0]?r.return:l[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,l[1])).done)return o;switch(r=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(s){l=[6,s],r=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}}function A(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function I(e){var t=e.editors,n=e.theme,o=e.currentEditor;return 0===t.length?(0,r.jsx)(a.x,{style:{backgroundColor:"light"===n?"var(--gray-5)":"var(--gray-4)",height:"30px",borderBottom:"1px solid var(--gray-7)"}}):(0,r.jsx)(l.k,{"data-testid":"editor-tabs",style:{backgroundColor:"light"===n?"var(--gray-5)":"var(--gray-4)",height:"40px",borderBottom:"1px solid var(--gray-7)",pointerEvents:"none",userSelect:"none"},children:t.map((function(e){var t=e.filename,i=t.split("/").pop(),c=(null==o?void 0:o.filename)===e.filename;return(0,r.jsxs)(l.k,{"data-codevideo-id":"editor-tab-".concat(t),align:"center",px:"4",py:"3",style:{borderRight:"1px solid var(--gray-7)",backgroundColor:c?"light"===n?"var(--gray-3)":"var(--gray-6)":"transparent",borderBottom:c?"2px solid var(--mint-9)":"none",position:"relative"},children:[(0,r.jsx)(s.x,{style:{fontFamily:"Fira Code, monospace",color:c?"var(--gray-12)":"#CCCECC",fontWeight:c?"500":"400"},children:i}),e.isSaved?(0,r.jsx)(a.x,{"data-codevideo-id":"editor-tab-close-".concat(t),ml:"2",style:{color:c?"var(--gray-10)":"var(--gray-8)",padding:0,lineHeight:1,minWidth:"auto"},children:"×"}):(0,r.jsx)(a.x,{"data-codevideo-id":"editor-tab-close-".concat(t),ml:"2",style:{width:"8px",height:"8px",backgroundColor:c?"var(--mint-9)":"var(--gray-8)",borderRadius:"9999px"}})]},e.filename)}))})}"function"==typeof SuppressedError&&SuppressedError;var R="file-explorer",T="editor-area",z="editor",L="terminal",V=function(e){var t=e.url,n=e.mode,i=e.scrollPosition,c=e.scrollDuration,u=void 0===c?1e3:c,d=(0,o.useState)(!1),f=d[0],p=d[1],h=(0,o.useState)(!1),v=h[0],g=h[1],x=(0,o.useRef)(null),m=(0,o.useRef)(0);return(0,o.useEffect)((function(){var e=setTimeout((function(){v||p(!0)}),1e4);return function(){return clearTimeout(e)}}),[v]),(0,o.useEffect)((function(){if(v&&x.current)try{var e=x.current.contentWindow;if(!e)return;if("step"===n)e.scrollTo({top:i,behavior:"auto"});else{var t=m.current,r=performance.now(),o=function(n){var a=n-r;if(a>=u)e.scrollTo({top:i,behavior:"auto"});else{var l=a/u,s=l<.5?4*l*l*l:1-Math.pow(-2*l+2,3)/2,c=t+(i-t)*s;e.scrollTo({top:c,behavior:"auto"}),requestAnimationFrame(o)}};requestAnimationFrame(o)}m.current=i}catch(a){console.error("Failed to scroll iframe content:",JSON.stringify(a))}}),[i,n,v,u]),(0,r.jsx)(a.x,{"data-codevideo-id":"external-web-viewer","data-testid":"external-web-viewer",style:{width:"100%",height:"100vh"},children:f?(0,r.jsx)(l.k,{align:"center",justify:"center",style:{height:"100%"},children:(0,r.jsxs)(s.x,{size:"5",style:{color:"var(--gray-10)"},children:["Failed to load external content from ",t,". The site may be invalid or not allow iframes."]})}):(0,r.jsx)("iframe",{ref:x,src:t,title:"External Web Viewer",style:{width:"100%",height:"100%",border:0},sandbox:"allow-same-origin allow-scripts allow-popups",onLoad:function(){return g(!0)},onError:function(){return p(!0)}})})},B=function(e){return M(void 0,void 0,void 0,(function(){return O(this,(function(t){return[2,new Promise((function(t){return setTimeout(t,e)}))]}))}))},W=function(e,t,n){return M(void 0,void 0,void 0,(function(){return O(this,(function(r){return n?[2,U(e,t,n)]:[2,new Promise((function(n,r){return M(void 0,void 0,void 0,(function(){var o,i,a,l,s,c;return O(this,(function(u){switch(u.label){case 0:return u.trys.push([0,4,,9]),D(),[4,fetch("http://localhost:3000/api/v1/audio/speech",{method:"POST",headers:{accept:"*/*",Authorization:"Bearer 123456","Content-Type":"application/json"},body:JSON.stringify({model:"model",voice:"af_sky",input:e,response_format:"mp3",speed:1.1})})];case 1:if(!(o=u.sent()).ok)throw new Error("HTTP error! status: ".concat(o.status));return[4,o.blob()];case 2:return i=u.sent(),a=URL.createObjectURL(i),(l=new Audio(a)).volume=t,l.onended=function(){URL.revokeObjectURL(a),n()},l.onerror=function(e){URL.revokeObjectURL(a),r(new Error("Audio playback error: ".concat(e)))},[4,l.play()];case 3:return u.sent(),[3,9];case 4:s=u.sent(),console.warn("Local speech API failed, falling back to browser speech synthesis:",s),u.label=5;case 5:return u.trys.push([5,7,,8]),[4,U(e,t)];case 6:return u.sent(),n(),[3,8];case 7:return c=u.sent(),r(c),[3,8];case 8:return[3,9];case 9:return[2]}}))}))}))]}))}))},U=function(e,t,n){return M(void 0,void 0,void 0,(function(){return O(this,(function(r){return[2,new Promise((function(r,o){if(D(),n){console.log("Creating audio element for MP3 URL:",n),console.log("Volume",t);var i=new Audio(n);return i.volume=t,i.onended=function(){r()},i.onerror=function(e){if("string"==typeof e)console.error("Audio playback error:",e);else try{console.error("Audio error event:",e.type),e.target&&e.target.error&&console.error("Error details:",e.target.error)}catch(e){console.error("Failed to extract error details:",e)}r()},void i.play().catch((function(e){return M(void 0,void 0,void 0,(function(){var t,n;return O(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),e instanceof Error?console.error("".concat(e.name,": ").concat(e.message,"\nStack: ").concat(e.stack)):console.error(String(e)),console.error(String(e)),[4,e.getProperty("message")];case 1:return[4,o.sent().jsonValue()];case 2:return t=o.sent(),console.error("Failed to play audio:",t),[3,4];case 3:return n=o.sent(),console.error("Failed to extract error message:",n),[3,4];case 4:return r(),[2]}}))}))}))}var a=window.speechSynthesis,l=new SpeechSynthesisUtterance(e);l.volume=t,l.onend=function(){r()},l.onerror=function(e){r()},a.speak(l)}))]}))}))},D=function(){window.speechSynthesis.cancel();for(var e=document.getElementsByTagName("audio"),t=0;t<e.length;t++)e[t].pause()};function J(e){var t;if(!e)return"plaintext";var n=null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase(),r={js:"javascript",jsx:"javascript",ts:"typescript",tsx:"typescript",py:"python",html:"html",css:"css",json:"json",md:"markdown",php:"php",java:"java",c:"c",cpp:"cpp",cs:"csharp",go:"go",rb:"ruby",rs:"rust",sh:"shell",sql:"sql",yaml:"yaml",yml:"yaml"};return n&&n in r?r[n]:"plaintext"}function H(e){var t,n=e.filename;if(!n)return(0,r.jsx)(v.N3x,{height:"20"});var o=null===(t=n.split(".").pop())||void 0===t?void 0:t.toLowerCase();if("LICENSE"===n.toUpperCase())return(0,r.jsx)(v.CzQ,{height:"20"});if("README"===n.toUpperCase())return(0,r.jsx)(v.UGj,{height:"20"});switch(o){case"js":return(0,r.jsx)(v.Js,{height:"20"});case"ts":return(0,r.jsx)(v.o5Y,{height:"20"});case"go":return(0,r.jsx)(v.Go,{height:"20"});case"sh":case"zsh":return(0,r.jsx)(v.N27,{height:"20"});case"yaml":return(0,r.jsx)(v.Q3K,{height:"20"});case"cs":return(0,r.jsx)(v.GzR,{height:"20"});case"cpp":return(0,r.jsx)(v.z2J,{height:"20"});case"jsx":return(0,r.jsx)(v.n5l,{height:"20"});case"tsx":return(0,r.jsx)(v.Yq3,{height:"20"});case"env":case"toml":return(0,r.jsx)(v.XVo,{height:"20"});case"gitignore":return(0,r.jsx)(v.H_,{height:"20"});case"md":case"md":return(0,r.jsx)(v.UGj,{height:"20"});case"py":return(0,r.jsx)(v.ixX,{height:"20"});case"rs":return(0,r.jsx)(v.Tie,{height:"20"});case"txt":return(0,r.jsx)(v.xvT,{height:"20"});case"pdf":return(0,r.jsx)(v.g5M,{height:"20"});default:return(0,r.jsx)(v.N3x,{height:"20"})}}var q=function(e){var t=e.isVisible,n=e.currentMousePosition,i=(0,o.useRef)(null),c=(0,o.useRef)(null),u=(0,o.useState)(null),d=u[0],f=u[1],p=(0,o.useState)(P),h=p[0],v=p[1];return(0,o.useEffect)((function(){t&&n&&void 0!==n.x&&void 0!==n.y&&v({x:n.x,y:n.y})}),[t]),(0,o.useEffect)((function(){if(t&&n&&void 0!==n.x&&void 0!==n.y){!function(){if(i.current){var e=i.current.getBoundingClientRect();if(n.x>=e.left&&n.x<=e.right&&n.y>=e.top&&n.y<=e.bottom)return void f("file")}if(c.current){var t=c.current.getBoundingClientRect();if(n.x>=t.left&&n.x<=t.right&&n.y>=t.top&&n.y<=t.bottom)return void f("folder")}f(null)}()}}),[t,n]),t?(0,r.jsx)(a.x,{style:{position:"fixed",left:"".concat(h.x,"px"),top:"".concat(h.y,"px"),backgroundColor:"var(--gray-4)",border:"1px solid var(--mint-7)",borderRadius:"var(--radius-2)",width:"180px",boxShadow:"var(--shadow-3)",zIndex:1e3,overflow:"hidden"},children:(0,r.jsxs)(l.k,{direction:"column",children:[(0,r.jsx)(a.x,{"data-codevideo-id":"file-explorer-context-menu-new-file",ref:i,style:{padding:"8px 12px",cursor:"pointer",backgroundColor:"file"===d?"var(--mint-3)":"transparent",userSelect:"none"},children:(0,r.jsx)(s.x,{size:"2",children:"New File..."})}),(0,r.jsx)(a.x,{"data-codevideo-id":"file-explorer-context-menu-new-folder",ref:c,style:{padding:"8px 12px",cursor:"pointer",backgroundColor:"folder"===d?"var(--mint-3)":"transparent",userSelect:"none"},children:(0,r.jsx)(s.x,{size:"2",children:"New Folder..."})})]})}):null},_=function(e){var t=e.isVisible,n=e.currentMousePosition,i=(0,o.useRef)(null),c=(0,o.useRef)(null),u=(0,o.useState)(null),d=u[0],f=u[1],p=(0,o.useState)(P),h=p[0],v=p[1];return(0,o.useEffect)((function(){t&&n&&void 0!==n.x&&void 0!==n.y&&v({x:n.x,y:n.y})}),[t]),(0,o.useEffect)((function(){if(t&&n&&void 0!==n.x&&void 0!==n.y){!function(){if(i.current){var e=i.current.getBoundingClientRect();if(n.x>=e.left&&n.x<=e.right&&n.y>=e.top&&n.y<=e.bottom)return void f("rename")}if(c.current){var t=c.current.getBoundingClientRect();if(n.x>=t.left&&n.x<=t.right&&n.y>=t.top&&n.y<=t.bottom)return void f("delete")}f(null)}()}}),[t,n]),t?(0,r.jsx)(a.x,{style:{position:"fixed",left:"".concat(h.x,"px"),top:"".concat(h.y,"px"),backgroundColor:"var(--gray-4)",border:"1px solid var(--mint-7)",borderRadius:"var(--radius-2)",width:"180px",boxShadow:"var(--shadow-3)",zIndex:1e3,overflow:"hidden"},children:(0,r.jsxs)(l.k,{direction:"column",children:[(0,r.jsx)(a.x,{"data-codevideo-id":"file-explorer-file-context-menu-rename",ref:i,style:{padding:"8px 12px",cursor:"pointer",backgroundColor:"rename"===d?"var(--mint-3)":"transparent",userSelect:"none"},children:(0,r.jsx)(s.x,{size:"2",children:"Rename..."})}),(0,r.jsx)(a.x,{"data-codevideo-id":"file-explorer-file-context-menu-delete",ref:c,style:{padding:"8px 12px",cursor:"pointer",backgroundColor:"delete"===d?"var(--mint-3)":"transparent",userSelect:"none"},children:(0,r.jsx)(s.x,{size:"2",children:"Delete"})})]})}):null},G=function(e){var t=e.isVisible,n=e.currentMousePosition,i=(0,o.useRef)(null),c=(0,o.useRef)(null),u=(0,o.useRef)(null),d=(0,o.useRef)(null),f=(0,o.useState)(null),p=f[0],h=f[1],v=(0,o.useState)(P),g=v[0],x=v[1];return(0,o.useEffect)((function(){t&&n&&void 0!==n.x&&void 0!==n.y&&x({x:n.x,y:n.y})}),[t]),(0,o.useEffect)((function(){if(t&&n&&void 0!==n.x&&void 0!==n.y){!function(){if(i.current){var e=i.current.getBoundingClientRect();if(n.x>=e.left&&n.x<=e.right&&n.y>=e.top&&n.y<=e.bottom)return void h("file")}if(c.current){var t=c.current.getBoundingClientRect();if(n.x>=t.left&&n.x<=t.right&&n.y>=t.top&&n.y<=t.bottom)return void h("folder")}if(u.current){var r=u.current.getBoundingClientRect();if(n.x>=r.left&&n.x<=r.right&&n.y>=r.top&&n.y<=r.bottom)return void h("rename")}if(d.current){r=d.current.getBoundingClientRect();if(n.x>=r.left&&n.x<=r.right&&n.y>=r.top&&n.y<=r.bottom)return void h("delete")}h(null)}()}}),[t,n]),t?(0,r.jsx)(a.x,{style:{position:"fixed",left:"".concat(g.x,"px"),top:"".concat(g.y,"px"),backgroundColor:"var(--gray-4)",border:"1px solid var(--mint-7)",borderRadius:"var(--radius-2)",width:"180px",boxShadow:"var(--shadow-3)",zIndex:1e3,overflow:"hidden"},children:(0,r.jsxs)(l.k,{direction:"column",children:[(0,r.jsx)(a.x,{"data-codevideo-id":"file-explorer-folder-context-menu-new-file",ref:i,style:{padding:"8px 12px",cursor:"pointer",backgroundColor:"file"===p?"var(--mint-3)":"transparent",userSelect:"none"},children:(0,r.jsx)(s.x,{size:"2",children:"New File..."})}),(0,r.jsx)(a.x,{"data-codevideo-id":"file-explorer-folder-context-menu-new-folder",ref:c,style:{padding:"8px 12px",cursor:"pointer",backgroundColor:"folder"===p?"var(--mint-3)":"transparent",userSelect:"none"},children:(0,r.jsx)(s.x,{size:"2",children:"New Folder..."})}),(0,r.jsx)(a.x,{"data-codevideo-id":"file-explorer-folder-context-menu-rename",ref:u,style:{padding:"8px 12px",cursor:"pointer",backgroundColor:"rename"===p?"var(--mint-3)":"transparent",userSelect:"none"},children:(0,r.jsx)(s.x,{size:"2",children:"Rename..."})}),(0,r.jsx)(a.x,{"data-codevideo-id":"file-explorer-folder-context-menu-delete",ref:d,style:{padding:"8px 12px",cursor:"pointer",backgroundColor:"delete"===p?"var(--mint-3)":"transparent",userSelect:"none"},children:(0,r.jsx)(s.x,{size:"2",children:"Delete"})})]})}):null};function X(e){var t,n,o,i,u=e.theme,d=e.isFileExplorerContextMenuVisible,f=e.isFileContextMenuVisible,p=e.isFolderContextMenuVisible,h=e.isNewFileInputVisible,g=e.isNewFolderInputVisible,x=e.currentMousePosition,m=e.newFolderInputValue,y=e.newFileInputValue,b=e.currentFileName,w=e.originalFileBeingRenamed,j=e.originalFolderBeingRenamed,S=e.renameFileInputValue,C=e.renameFolderInputValue,k=e.currentHoveredFileName,F=e.currentHoveredFolderName,E=e.fileStructure,P=e.fileExplorerWidth,N=e.newFileParentPath,M=e.newFolderParentPath,O=function(e){return"file"===e?N||(M?(console.log("[FileExplorer] Using newFolderParentPath for file input:",M),M):""):M||(N?(console.log("[FileExplorer] Using newFileParentPath for folder input:",N),N):"")},A=function(e){return e===w?(0,r.jsx)(c.f,{value:S,readOnly:!0}):e===j?(0,r.jsx)(c.f,{value:C,readOnly:!0}):(0,r.jsx)(s.x,{style:{fontFamily:"Fira Code, monospace",color:"#CCCECC",fontSize:"0.9em"},children:e})},I=function(){if(!h)return null;var e=O("file"),t="new-file-input-".concat(e||"root");return console.log("[FileExplorer] Rendering file input with ID: ".concat(t,", value: ").concat(y,", effectiveParentPath: ").concat(e)),(0,r.jsxs)(l.k,{"data-codevideo-id":t,align:"center",gap:"2",mt:"1",children:[(0,r.jsx)(v.xvT,{height:"20"}),(0,r.jsx)(c.f,{value:y,readOnly:!0,autoFocus:!0,style:{fontFamily:"Fira Code, monospace",fontSize:"0.9em"}})]})},T=function(){if(!g)return null;var e=O("folder"),t="new-folder-input-".concat(e||"root");return console.log("[FileExplorer] Rendering folder input with ID: ".concat(t,", value: ").concat(m,", effectiveParentPath: ").concat(e)),(0,r.jsxs)(l.k,{"data-codevideo-id":t,align:"center",gap:"2",mt:"1",children:[(0,r.jsx)(v.gt0,{height:"20"}),(0,r.jsx)(c.f,{value:m,readOnly:!0,autoFocus:!0,style:{fontFamily:"Fira Code, monospace",fontSize:"0.9em"}})]})},z=function(e,t,n){void 0===t&&(t=""),0===n&&(console.log("[FileExplorer] Root level structure keys:",Object.keys(e)),console.log("[FileExplorer] Full structure:",JSON.stringify(e,null,2)));var o=Object.entries(e).sort((function(e,t){var n="directory"===e[1].type;return n===("directory"===t[1].type)?e[0].localeCompare(t[0]):n?-1:1}));return 0===n&&console.log("[FileExplorer] Sorted entries:",o.map((function(e){var t=e[0],n=e[1];return"".concat(t," (").concat(n.type,")")}))),o.map((function(e,o){var i=e[0],s=e[1];console.log('[FileExplorer] Processing entry: name="'.concat(i,'", type="').concat(s.type,'", path="').concat(t,'", level=').concat(n));var c=t?"".concat(t,"/").concat(i):i,d="directory"===s.type,f=0===n?"0":"4",p=n+1,x=d&&F===c||!d&&k===c||b===c&&!k&&!F,m=O("file"),y=O("folder"),w=h&&m===c&&d,j=g&&y===c&&d;return(w||j)&&console.log("[FileExplorer] Directory ".concat(c," should show inputs:"),{file:w,folder:j}),(0,r.jsxs)(a.x,{ml:f,children:[(0,r.jsxs)(l.k,{"data-codevideo-id":"file-explorer-".concat(c),align:"center",gap:"2",style:{backgroundColor:x?"light"===u?"var(--gray-3)":"var(--gray-6)":"transparent",width:"100%",padding:"2px 4px",borderRadius:"4px"},children:[d?(0,r.jsx)(v.gt0,{height:"20"}):(0,r.jsx)(H,{filename:i}),A(i)]}),d&&(0,r.jsxs)(a.x,{ml:"4",children:[w&&I(),j&&T(),s.children&&z(s.children,c,p)]})]},"".concat(n,"-").concat(o,"-").concat(c))}))};return E?(0,r.jsxs)(a.x,{p:"1","data-testid":"file-explorer",style:{height:"100%",width:P?"".concat(P,"px"):"250px",borderRight:"1px solid var(--gray-7)",backgroundColor:"light"===u?"var(--gray-5)":"var(--gray-4)",pointerEvents:"none",userSelect:"none"},children:[(0,r.jsxs)(a.x,{p:"2",children:[z(E,"",0),(t=O("file"),n=O("folder"),o=h&&(""===t||null==t),i=g&&(""===n||null==n),(o||i)&&console.log("[FileExplorer] Showing root level inputs:",{file:o,folder:i,effectiveFileParentPath:t,effectiveFolderParentPath:n}),(0,r.jsxs)(r.Fragment,{children:[o&&I(),i&&T()]}))]}),(0,r.jsx)(a.x,{"data-codevideo-id":R,style:{flexGrow:1,minHeight:"20px"}}),(0,r.jsx)(q,{isVisible:d,currentMousePosition:x}),(0,r.jsx)(_,{isVisible:f,currentMousePosition:x}),(0,r.jsx)(G,{isVisible:p,currentMousePosition:x})]}):(0,r.jsx)(r.Fragment,{})}function Z(e){var t=e.theme,n=e.terminalBuffer,i=e.terminalHeight,l=e.fontSizePx,s=void 0===l?14:l,c=e.showBlockCaret,u=void 0!==c&&c,d=(0,o.useRef)(null);return(0,o.useEffect)((function(){d.current&&(d.current.scrollTop=d.current.scrollHeight)}),[n]),0===n.length?(0,r.jsx)(a.x,{style:{backgroundColor:"light"===t?"var(--gray-5)":"var(--gray-4)",height:i?"".concat(i,"px"):"150px",borderTop:"1px solid var(--gray-7)"}}):(0,r.jsx)(a.x,{"data-codevideo-id":L,"data-testid":"terminal",ref:d,style:{borderTop:"1px solid var(--gray-7)",height:i?"".concat(i,"px"):"150px",backgroundColor:"light"===t?"var(--gray-5)":"var(--gray-4)",fontFamily:"Fira Code, monospace",fontSize:"".concat(s,"px"),padding:"8px",position:"relative",overflow:"auto",scrollBehavior:"smooth"},children:(0,r.jsxs)(a.x,{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontWeight:"bold",width:"100%"},children:[n,(0,r.jsx)(a.x,{style:{display:"inline-block",width:"".concat(.6*s,"px"),height:"".concat(s,"px"),marginBottom:"-2px",backgroundColor:u?"var(--gray-12)":"transparent",border:u?"none":"1px solid var(--gray-12)",boxSizing:"border-box"}})]})})}var Y=function(e,t,n,r,o){for(var i=0,a=[t,n,r,o];i<a.length;i++){var l=a[i];if(!l||void 0===l.x||void 0===l.y||isNaN(l.x)||isNaN(l.y))return console.warn("Invalid point provided to calculateCubicBezierPoint:",{p0:t,p1:n,p2:r,p3:o}),{x:0,y:0}}var s=1-e,c=s*s,u=c*s,d=e*e,f=d*e;return{x:u*t.x+3*c*e*n.x+3*s*d*r.x+f*o.x,y:u*t.y+3*c*e*n.y+3*s*d*r.y+f*o.y}},Q=function(e){var t=e.mode,n=e.mouseVisible,i=e.targetMousePosition,l=e.maximumAnimationDuration,s=e.mouseColor,c=e.arcHeight,u=void 0===c?.3:c,d=e.numberOfCurves,f=void 0===d?1:d,p=e.onAnimationFinished,h=e.onCurrentPositionChange,v=(0,o.useRef)(null),g=i&&void 0!==i.x&&void 0!==i.y?i:{x:0,y:0},x=(0,o.useState)(g),m=x[0],y=x[1],b=(0,o.useState)(g),w=b[0],j=b[1],S=(0,o.useState)(!1),C=S[0],k=S[1],F=(0,o.useState)([]);F[0];var E=F[1],P=(0,o.useRef)(null),N=(0,o.useRef)(g);if((0,o.useEffect)((function(){h&&h(m)}),[m,h]),(0,o.useEffect)((function(){if(i&&void 0!==i.x&&void 0!==i.y){if(!(C||i&&N.current&&i.x===N.current.x&&i.y===N.current.y)){if(N.current=i,"replay"!==t)return y(i),void j(i);if(w&&i&&w.x===i.x&&w.y===i.y)return y(i),void j(i);var e=m;if(e&&i&&void 0!==e.x&&void 0!==e.y&&void 0!==i.x&&void 0!==i.y){var n=1===f?Math.floor(3*Math.random())+1:f,r=function(e,t,n,r){var o=[],i=Math.hypot(t.x-e.x,t.y-e.y);o.push(e);var a=Math.max(1,Math.min(3,n));if(1===a){var l={x:(e.x+t.x)/2,y:Math.min(e.y,t.y)-i*r};o.push(l,l)}else for(var s=1/(a+1),c=1;c<=a;c++){var u=c*s,d=c%2==1?-1:1,f=.5*Math.random()+.5,p=e.x+(t.x-e.x)*u,h=e.y+(t.y-e.y)*u,v=-(t.y-e.y),g=t.x-e.x,x=Math.hypot(v,g);l=x>0?{x:p+v/x*i*r*d*f,y:h+g/x*i*r*d*f}:{x:p,y:h},o.push(l)}return o.push(t),o}(e,i,n,u);if(j(e),r&&0!==r.length){var o=Math.hypot(i.x-e.x,i.y-e.y),a=l,s=Math.max(300,Math.min(a,o/600*1e3)),c=function(e,t){for(var n=[],r=0;r<t;r++){var o=r/(t-1);if(4===e.length)n.push(Y(o,e[0],e[1],e[2],e[3]));else if(e.length>4){for(var i=A([],e,!0),a=i.length,l=1;l<a;l++)for(var s=0;s<a-l;s++){var c=i[s],u=i[s+1];isNaN(c.x)||isNaN(c.y)||isNaN(u.x)||isNaN(u.y)?console.warn("NaN values detected in control points, skipping interpolation"):i[s]={x:(1-o)*c.x+o*u.x,y:(1-o)*c.y+o*u.y}}n.push(i[0])}}return n}(r,Math.max(30,Math.min(240,Math.floor(s/1e3*120))));if(c&&0!==c.length){var d=c.filter((function(e){return e&&"number"==typeof e.x&&!isNaN(e.x)&&isFinite(e.x)&&"number"==typeof e.y&&!isNaN(e.y)&&isFinite(e.y)}));if(0!==d.length){console.log("🎬 Distance: ".concat(o.toFixed(1),"px, Duration: ").concat(s,"ms, Points: ").concat(d.length,", Velocity: ").concat((o/(s/1e3)).toFixed(1),"px/s")),E(d),k(!0);var h=null,v=s,g=function(e){h||(h=e);var t=e-h,n=Math.min(t/v,1),r=Math.min(Math.floor(n*(d.length-1)),d.length-1),o=d[r];if(!o||void 0===o.x||void 0===o.y)return console.warn("Invalid animation position detected, ending animation:",o),k(!1),void(p&&p());y(o),n<1?P.current=requestAnimationFrame(g):(k(!1),p&&p())};return P.current=requestAnimationFrame(g),function(){null!==P.current&&cancelAnimationFrame(P.current)}}console.warn("No valid animation points after filtering, skipping animation")}else console.warn("No valid animation points generated, skipping animation")}else console.warn("No valid control points generated, skipping animation")}else console.warn("Invalid positions for animation, skipping:",{startPosition:e,targetMousePosition:i})}}else console.warn("Invalid targetMousePosition provided to MouseOverlay:",i)}),[null==i?void 0:i.x,null==i?void 0:i.y,t]),(0,o.useEffect)((function(){"step"===t&&i&&void 0!==i.x&&void 0!==i.y&&(y(i),j(i),k(!1),N.current=i)}),[t,i]),!n)return(0,r.jsx)(r.Fragment,{});var M={x:isNaN(m.x)||void 0===m.x?0:m.x,y:isNaN(m.y)||void 0===m.y?0:m.y};return(0,r.jsx)(a.x,{id:"mouse-overlay","data-testid":"mouse-overlay",ref:v,style:{transform:"translate(".concat(M.x,"px, ").concat(M.y,"px) scale(0.8)"),transition:C?void 0:"replay"===t?"transform 0.05s linear":void 0,zIndex:1e4,position:"absolute",pointerEvents:"none",userSelect:"none"},children:(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M 0,0 L 0,20 L 4.5,15.5 L 8.75,23 L 11,22 L 6.75,15 L 13.75,15 Z",fill:s||"black",stroke:"white",strokeWidth:"1.5",strokeLinejoin:"round"})})})};function K(e){var t=e.captionText,n=e.fontSizePx;return(0,r.jsx)(r.Fragment,{children:t&&(0,r.jsx)(a.x,{"data-testid":"caption-overlay",style:{width:"100%",color:"white",position:"absolute",bottom:65,zIndex:10001},children:(0,r.jsx)(l.k,{justify:"center",align:"center",children:(0,r.jsx)(a.x,{style:{maxWidth:"80%",backgroundColor:"var(--black-a9)",padding:"4px 8px"},children:n?(0,r.jsx)(s.x,{style:{fontSize:1.5*n},children:t}):(0,r.jsx)(s.x,{size:"6",children:t})})})})})}function $(){return(0,r.jsx)(a.x,{"data-testid":"embed-overlay",style:{zIndex:1e10,position:"absolute",pointerEvents:"none",userSelect:"none",backgroundColor:"var(--black-a9)",inset:0},children:(0,r.jsxs)(l.k,{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},direction:"column",gap:"2",children:[(0,r.jsx)(a.x,{children:(0,r.jsxs)(s.x,{size:"9",children:["/>"," CodeVideo Software Tutorial"]})}),(0,r.jsx)(a.x,{children:(0,r.jsxs)(s.x,{size:"2",mb:"9",children:["Create your own at ",(0,r.jsx)(u.r,{href:"https://studio.codevideo.io",target:"_blank",children:"studio.codevideo.io"})]})}),(0,r.jsx)(a.x,{children:(0,r.jsxs)(s.x,{size:"6",children:["Press ",(0,r.jsx)(d.T,{children:"Space"})," to playback"]})}),(0,r.jsx)(a.x,{children:(0,r.jsxs)(s.x,{size:"6",children:["Press the ",(0,r.jsx)(d.T,{children:"◀"})," and ",(0,r.jsx)(d.T,{children:"▶"})," arrow keys to move through the steps."]})})]})})}function ee(e){var t=e.isUnsavedChangesDialogOpen,n=e.unsavedFileName;return t?(0,r.jsx)(a.x,{"data-testid":"unsaved-changes-dialog",style:{zIndex:9999,position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",userSelect:"none",backgroundColor:"var(--black-a7)"},children:(0,r.jsxs)(a.x,{style:{backgroundColor:"var(--gray-4)",borderRadius:"var(--radius-4)",boxShadow:"var(--shadow-5)",padding:"24px",maxWidth:"350px",width:"100%"},children:[(0,r.jsxs)(l.k,{direction:"column",align:"center",justify:"center",children:[(0,r.jsx)(g.LPM,{height:"36",width:"36"}),(0,r.jsxs)(s.x,{size:"2",mt:"4",style:{textAlign:"center"},children:["Do you want to save the changes you made to ",(0,r.jsx)(f.E,{children:n}),"?"]}),(0,r.jsx)(s.x,{size:"1",mb:"4",style:{textAlign:"center"},children:"Your changes will be lost if you don't save them."})]}),(0,r.jsxs)(l.k,{direction:"column",children:[(0,r.jsx)(p.z,{"data-codevideo-id":"unsaved-changes-dialog-button-save",color:"mint",style:{outline:"none"},children:"Save"}),(0,r.jsx)(p.z,{"data-codevideo-id":"unsaved-changes-dialog-button-dont-save",color:"gray",mt:"1",style:{outline:"none"},children:"Don't Save"}),(0,r.jsx)(p.z,{"data-codevideo-id":"unsaved-changes-dialog-button-cancel",color:"gray",mt:"4",style:{outline:"none"},children:"Cancel"})]})]})}):(0,r.jsx)(r.Fragment,{})}function te(e){var t=e.variables;return(0,r.jsx)(a.x,{style:{position:"absolute",bottom:"16px",left:"16px",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",fontFamily:'Fira Code, Monaco, Consolas, "Courier New", monospace',fontSize:"12px",padding:"12px",borderRadius:"6px",maxWidth:"400px",maxHeight:"300px",overflow:"auto",zIndex:1e3,border:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)"},children:Object.entries(t).map((function(e){var t=e[0],n=e[1];return(0,r.jsxs)("div",{style:{marginBottom:"4px",wordBreak:"break-word"},children:[(0,r.jsx)("span",{style:{color:"#88c0d0"},children:t}),(0,r.jsx)("span",{style:{color:"#d8dee9"},children:": "}),(0,r.jsx)("span",{style:{color:"#a3be8c"},children:"string"==typeof n?'"'.concat(n,'"'):JSON.stringify(n,null,0)})]},t)}))})}var ne=new x.M2((0,m.G)({async:!1,emptyLangClass:"hljs",langPrefix:"hljs language-",highlight:function(e,t,n){var r=y.Z.getLanguage(t)?t:"plaintext";return y.Z.highlight(e,{language:r}).value}}));ne.setOptions({gfm:!0,breaks:!1});var re,oe=function(e){var t=e.slideMarkdown,n=e.hljsTheme,i=void 0===n?"github":n,l=e.fontSize,s=void 0===l?"1rem":l,c=e.fontSizePx,u=e.fontFamily,d=void 0===u?'-apple-system, BlinkMacSystemFont, "Segoe UI (Custom)", Roboto, "Helvetica Neue", "Open Sans (Custom)", system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji"':u,f=e.color,p=void 0===f?"black":f,h=e.backgroundColor,v=void 0===h?"white":h,g=e.backgroundImage,x=e.backgroundSize,m=void 0===x?"cover":x,w=e.padding,j=void 0===w?"2rem":w,S=e.maxWidth,C=void 0===S?"800px":S,k=e.style;(0,o.useEffect)((function(){var e="hljs-theme-stylesheet",t=document.getElementById(e),n=y.Z.versionString,r="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/".concat(n,"/styles/").concat(i,".min.css");if(t)t.href=r;else{var o=document.createElement("link");o.id=e,o.rel="stylesheet",o.href=r,document.head.appendChild(o)}}),[i]);var F=(0,o.useMemo)((function(){var e=ne.parse(t,{async:!1});return b.Z.sanitize(e)}),[t]),E=N(N({fontSize:c?"".concat(c,"px"):s,fontFamily:d,color:p,backgroundColor:v,padding:j,margin:"0 auto"},g?{backgroundImage:"url(".concat(g,")"),backgroundSize:m,backgroundRepeat:"no-repeat",backgroundPosition:"center"}:{}),k),P={minWidth:C,maxWidth:C};return(0,r.jsx)(a.x,{"data-codevideo-id":"slide","data-testid":"slide-viewer",style:{width:"100%",height:"100vh"},children:(0,r.jsx)(a.x,{style:N(N({},E),{height:"100%",width:"100%",display:"flex",alignItems:"start",justifyContent:"center"}),children:(0,r.jsx)(a.x,{style:P,dangerouslySetInnerHTML:{__html:F}})})})},ie=["https://unpkg.com/esbuild-wasm@0.25.5/esbuild.wasm","https://cdn.jsdelivr.net/npm/esbuild-wasm@0.25.5/esbuild.wasm"],ae=!1,le=!1,se=null;!function(e){e.HTML="html",e.JSX="jsx",e.TSX="tsx"}(re||(re={}));var ce=function(e){var t=e.files,n=e.height,i=void 0===n?"100vh":n,a=(0,o.useRef)(null),l=(0,o.useState)(ae),s=l[0],c=l[1],u=(0,o.useState)(null),d=u[0],f=u[1];return(0,o.useEffect)((function(){if(!ae){var e=!0;return M(void 0,void 0,void 0,(function(){var t;return O(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,M(void 0,void 0,void 0,(function(){return O(this,(function(e){return ae?[2]:(le&&se||(le=!0,se=M(void 0,void 0,void 0,(function(){var e,t,n,r,o;return O(this,(function(i){switch(i.label){case 0:e=null,t=0,n=ie,i.label=1;case 1:if(!(t<n.length))return[3,6];r=n[t],i.label=2;case 2:return i.trys.push([2,4,,5]),[4,w.initialize({wasmURL:r,worker:!1})];case 3:return i.sent(),console.log("Successfully initialized esbuild with ".concat(r)),ae=!0,le=!1,[2];case 4:return o=i.sent(),console.warn("Failed to initialize esbuild with ".concat(r,":"),o),e=o instanceof Error?o:new Error(String(o)),[3,5];case 5:return t++,[3,1];case 6:throw le=!1,e||new Error("Failed to initialize esbuild with any WASM URL")}}))}))),[2,se])}))}))];case 1:return n.sent(),e&&c(!0),[3,3];case 2:return t=n.sent(),console.error("Failed to initialize esbuild:",JSON.stringify(t)),e&&f(t instanceof Error?t.message:"Unknown error"),[3,3];case 3:return[2]}}))})),function(){e=!1}}c(!0)}),[]),(0,o.useEffect)((function(){0!==t.length&&M(void 0,void 0,void 0,(function(){var e,n,r,o,i,l,c,u,d,f,p,h,v,g;return O(this,(function(x){switch(x.label){case 0:for(x.trys.push([0,5,,6]),e=new Map,n=0,r=t;n<r.length;n++)o=r[n],i=o.path.startsWith("/")?o.path:"/".concat(o.path),e.set(i,o.content);if(l=t.find((function(e){return e.path.endsWith(".html")})),c=(null==l?void 0:l.content)||"<!DOCTYPE html><html><head></head><body></body></html>",u=re.HTML,t.some((function(e){return e.path.endsWith(".tsx")}))?u=re.TSX:t.some((function(e){return e.path.endsWith(".jsx")}))&&(u=re.JSX),u!==re.HTML&&!s)return[2];switch(u){case re.HTML:return[3,1];case re.JSX:case re.TSX:return[3,2]}return[3,4];case 1:return c=(c=c.replace(/<link[^>]+href="([^"]+\.css)"[^>]*>/g,(function(t,n){var r=e.get("/".concat(n.replace(/^\.\//,"")));return r?"<style>\n".concat(r,"\n</style>"):t}))).replace(/<script[^>]+src="([^"]+)"[^>]*><\/script>/g,(function(t,n){var r=e.get("/".concat(n.replace(/^\.\//,"")));return r?"<script>\n".concat(r,"\n<\/script>"):t})),[3,4];case 2:return d=null!==(g=null===(v=t.find((function(e){return/\.(t|j)sx$/.test(e.path)})))||void 0===v?void 0:v.path)&&void 0!==g?g:"index.tsx",[4,w.build({bundle:!0,write:!1,format:"iife",platform:"browser",entryPoints:["/".concat(d)],plugins:[(m=e,{name:"virtual-fs",setup:function(e){var t=this;e.onResolve({filter:/.*/},(function(e){if("react"===e.path||"react-dom"===e.path)return{path:e.path,external:!0};var t=e.path.startsWith("/")?e.path:"/".concat(e.path.replace(/^\.\//,""));return m.has(t)?{path:t,namespace:"vfs"}:void 0})),e.onLoad({filter:/.*/,namespace:"vfs"},(function(e){return M(t,void 0,void 0,(function(){var t,n,r,o;return O(this,(function(i){return t=null!==(r=m.get(e.path))&&void 0!==r?r:"",n=null!==(o=e.path.split(".").pop())&&void 0!==o?o:"js",[2,{contents:t,loader:"ts"===n?"ts":"tsx"===n?"tsx":"jsx"===n?"jsx":"js"}]}))}))}))}})],external:["react","react-dom"],target:["es2020"],define:{"process.env.NODE_ENV":'"development"'}})];case 3:return f=x.sent(),p=f.outputFiles[0].text,c=(c=(c=c.replace(/<body[^>]*>[\s\S]*<\/body>/i,(function(e){return e.replace(/<script\b[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<\/body>/i,"<script>".concat(p,"<\/script></body>"))}))).replace(/<link[^>]+href="([^"]+\.css)"[^>]*>/g,(function(t,n){var r=e.get("/".concat(n.replace(/^\.\//,"")));return r?"<style>\n".concat(r,"\n</style>"):t}))).replace(/<\/head>/i,'<script src="'.concat("https://esm.sh/react@18?bundle",'"><\/script><script src="').concat("https://esm.sh/react-dom@18?bundle",'"><\/script></head>')),[3,4];case 4:return a.current&&(a.current.srcdoc=c),[3,6];case 5:return h=x.sent(),console.error("Bundle error:",JSON.stringify(h)),a.current&&(a.current.srcdoc='<body style="font-family: monospace; color: #e74c3c;"><h3>Bundle Error:</h3><pre>'.concat(h instanceof Error?h.message:"Unknown error","</pre></body>")),[3,6];case 6:return[2]}var m}))}))}),[t,s]),d?(0,r.jsxs)("div",{style:{padding:"20px",color:"#e74c3c",fontFamily:"monospace"},children:[(0,r.jsx)("h3",{children:"WebPreview Error:"}),(0,r.jsx)("pre",{children:d})]}):!s&&t.some((function(e){return/\.(t|j)sx$/.test(e.path)}))?(0,r.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:i,fontFamily:"sans-serif"},children:"Initializing Preview Environment..."}):(0,r.jsx)("div",{style:{width:"100%",height:i},"data-testid":"web-preview",children:(0,r.jsx)("iframe",{ref:a,style:{width:"100%",height:"100%",border:"0"},sandbox:"allow-scripts allow-same-origin",title:"Web Preview"})})},ue=function(e,t,n){var r,o,i=(0,h.EJ)(e,n),a=t;t>=i.length&&(a=i.length-1),t<0&&(a=0);var l=i.slice(0,a+1),s=new j.e(e,void 0,!1);(0,h.T0)(e)&&e.initialSnapshot&&(console.log("[reconstituteAllPartsOfState] Detected lesson project WITH initial snapshot, initial snapshot should have been applied."),console.log("[reconstituteAllPartsOfState] virtualIDE.virtualEditors.length: ".concat(s.virtualEditors.length)),console.log("[reconstituteAllPartsOfState] project.initialSnapshot.editorSnapshot.editors.length: ".concat(e.initialSnapshot.editorSnapshot.editors.length))),s.applyActions(l);var c=s.getCourseSnapshot(),u=c.editorSnapshot.editors,d=(null==u?void 0:u.find((function(e){return e.isActive})))||(null==u?void 0:u[0])||{filename:"",content:"",caretPosition:E,highlightCoordinates:null,isActive:!1,isSaved:!1};return{editors:u,currentEditor:d,currentFilename:d.filename,fileExplorerSnapshot:c.fileExplorerSnapshot,currentCode:d?d.content:"",currentCaretPosition:d.caretPosition,currentTerminalBuffer:s.virtualTerminals.length>0&&(null===(r=s.virtualTerminals[0])||void 0===r?void 0:r.getBuffer().join("\n"))||"",captionText:(null===(o=null==c?void 0:c.authorSnapshot.authors[0])||void 0===o?void 0:o.currentSpeechCaption)||"",actions:i,mouseSnapshot:null==c?void 0:c.mouseSnapshot,isUnsavedChangesDialogOpen:c.isUnsavedChangesDialogOpen,unsavedFileName:c.unsavedFileName}},de=function(e,t){if(!t)return P;if(!(null==t?void 0:t.current))return e;if(!e||void 0===e.x||void 0===e.y||isNaN(e.x)||isNaN(e.y))return console.warn("Invalid point provided to convertToContainerCoordinates:",e),P;var n=t.current.getBoundingClientRect();console.log("🔧 [convertToContainerCoordinates] Container rect:",JSON.stringify({left:n.left,top:n.top,width:n.width,height:n.height})),console.log("🔧 [convertToContainerCoordinates] Input point:",JSON.stringify(e));var r=e.x-n.left,o=e.y-n.top;return console.log("🔧 [convertToContainerCoordinates] Converted coordinates:",JSON.stringify({x:r,y:o})),{x:r,y:o}},fe=function(e,t){try{if(!t)return P;console.log("🎯 [getCoordinatesOfFileOrFolder] Looking for:",e);var n='[data-codevideo-id="file-explorer-'.concat(e,'"]');console.log("🔍 [getCoordinatesOfFileOrFolder] Selector:",n),function(){var e,t;console.log("🔍 DOM Debug Info:"),console.log("- Document ready state:",document.readyState),console.log("- Body children count:",(null===(t=null===(e=document.body)||void 0===e?void 0:e.children)||void 0===t?void 0:t.length)||0),console.log("- FileExplorer elements:",document.querySelectorAll('[data-codevideo-id="file-explorer"]').length),console.log("- All data-codevideo-id elements:",document.querySelectorAll("[data-codevideo-id]").length);var n=document.querySelectorAll('[data-codevideo-id^="file-explorer-"]');console.log("📋 Available file explorer elements:"),n.forEach((function(e){console.log("  - ".concat(e.getAttribute("data-codevideo-id")))}))}(),console.log("🔍 [getCoordinatesOfFileOrFolder] About to call document.querySelector...");var r=document.querySelector(n);if(console.log("🔍 [getCoordinatesOfFileOrFolder] document.querySelector completed successfully"),console.log("🔍 [getCoordinatesOfFileOrFolder] Element found:",!!r),!r){console.log("❌ [getCoordinatesOfFileOrFolder] Element not found");var o=document.querySelectorAll('[data-codevideo-id^="file-explorer-"]');return console.log("📋 [getCoordinatesOfFileOrFolder] Available file explorer elements:"),o.forEach((function(e){console.log("  - ".concat(e.getAttribute("data-codevideo-id")))})),P}console.log("✅ [getCoordinatesOfFileOrFolder] Found element, about to get bounding rect...");var i=r.getBoundingClientRect();console.log("✅ [getCoordinatesOfFileOrFolder] Got bounding rect successfully"),console.log("📐 [getCoordinatesOfFileOrFolder] Element rect:",JSON.stringify({left:i.left,top:i.top,width:i.width,height:i.height,right:i.right,bottom:i.bottom}));var a={x:i.left+i.width/2,y:i.top+i.height/2};console.log("📍 [getCoordinatesOfFileOrFolder] Absolute center coords:",JSON.stringify(a)),console.log("🔍 [getCoordinatesOfFileOrFolder] About to call convertToContainerCoordinates...");var l=de(a,t);return console.log("🔍 [getCoordinatesOfFileOrFolder] convertToContainerCoordinates completed successfully"),console.log("🎯 [getCoordinatesOfFileOrFolder] Final container-relative coords:",JSON.stringify(l)),l}catch(s){return console.error("❗ [getCoordinatesOfFileOrFolder] Error name:",null==s?void 0:s.name),console.error("❗ [getCoordinatesOfFileOrFolder] Error message:",null==s?void 0:s.message),console.error("❗ [getCoordinatesOfFileOrFolder] Error stack:",null==s?void 0:s.stack),console.error("❗ [getCoordinatesOfFileOrFolder] Full error object:",s),P}},pe=function(e,t){if(!t)return P;var n=e.split(",");return 2==n.length?de({x:n[0]?parseInt(n[0]):0,y:n[1]?parseInt(n[1]):0},t):{x:0,y:0}},he=function(e,t){var n=Math.random(),r=Math.random();return Math.sqrt(-2*Math.log(n))*Math.cos(2*Math.PI*r)*t+e},ve=function(e,t,n){if(void 0===n&&(n={randomize:!0,stdDevPercent:.15}),!t)return P;var r=document.querySelector('[data-codevideo-id="'.concat(e,'"]'));if(!r)return console.warn("Element with data-codevideo-id not found",e),P;var o=r.getBoundingClientRect(),i=o.left+o.width/2,a=o.top+o.height/2;if(!n.randomize)return console.log("Exact center of element found at: ".concat(i,", ").concat(a)),de({x:i,y:a},t);var l,s,c=o.width*n.stdDevPercent,u=o.height*n.stdDevPercent,d=Math.min(5,.1*o.width,.1*o.height),f=o.left+d,p=o.right-d,h=o.top+d,v=o.bottom-d;return l=he(i,c),s=he(a,u),l=Math.max(f,Math.min(p,l)),s=Math.max(h,Math.min(v,s)),console.log("Random point within element: ".concat(l,", ").concat(s)),de({x:l,y:s},t)},ge=function(e,t,n){var r,o={x:e.x,y:e.y};switch(t.name){case"mouse-move-file-explorer":o=ve(R,n);break;case"mouse-move-terminal":o=function(e){if(!e)return P;var t=document.querySelector('[data-codevideo-id="terminal"]');if(!t)return P;var n=t.getBoundingClientRect();return de({x:n.left+20,y:n.top+20},e)}(n);break;case"mouse-move-editor":o=function(e){if(!e)return P;var t=document.querySelector('[data-codevideo-id="editor"]');if(!t)return P;var n=t.getBoundingClientRect();return de({x:n.left+50,y:n.top+50},e)}(n);break;case"mouse-move-file-explorer-file":case"mouse-move-file-explorer-folder":console.log("🚀 [getNewMousePosition] Handling file/folder movement:",JSON.stringify({actionName:t.name,actionValue:t.value})),o=fe(t.value,n),console.log("🚀 [getNewMousePosition] Result position:",JSON.stringify(o));break;case"mouse-move-to-coordinates-pixels":o=pe(t.value,n);break;case"mouse-move-to-coordinates-percent":var i=pe(t.value,n),a=null===(r=null==n?void 0:n.current)||void 0===r?void 0:r.getBoundingClientRect();a&&(o={x:a.width*i.x,y:(null==a?void 0:a.height)*i.y});break;case"mouse-move-file-explorer-context-menu-new-file":o=ve("file-explorer-context-menu-new-file",n);break;case"mouse-move-file-explorer-context-menu-new-folder":o=ve("file-explorer-context-menu-new-folder",n);break;case"mouse-move-file-explorer-file-context-menu-rename":o=ve("file-explorer-file-context-menu-rename",n);break;case"mouse-move-file-explorer-file-context-menu-delete":o=ve("file-explorer-file-context-menu-delete",n);break;case"mouse-move-file-explorer-folder-context-menu-new-file":o=ve("file-explorer-folder-context-menu-new-file",n);break;case"mouse-move-file-explorer-folder-context-menu-new-folder":o=ve("file-explorer-folder-context-menu-new-folder",n);break;case"mouse-move-file-explorer-folder-context-menu-rename":o=ve("file-explorer-folder-context-menu-rename",n);break;case"mouse-move-file-explorer-folder-context-menu-delete":o=ve("file-explorer-folder-context-menu-delete",n);break;case"mouse-move-editor-tab":o=ve("editor-tab-".concat(t.value),n);break;case"mouse-move-editor-tab-close":o=ve("editor-tab-close-".concat(t.value),n);break;case"mouse-move-unsaved-changes-dialog-button-save":o=ve("unsaved-changes-dialog-button-save",n);break;case"mouse-move-unsaved-changes-dialog-button-dont-save":o=ve("unsaved-changes-dialog-button-dont-save",n);break;case"mouse-move-unsaved-changes-dialog-button-cancel":o=ve("unsaved-changes-dialog-button-cancel",n)}return o?o.x?o.y?o:(console.warn("New position y is undefined, falling back to target position:",JSON.stringify(e)),{x:e.x,y:e.y}):(console.warn("New position x is undefined, falling back to target position:",JSON.stringify(e)),{x:e.x,y:e.y}):(console.warn("New position is undefined, falling back to target position:",JSON.stringify(e)),{x:e.x,y:e.y})},xe=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return M(void 0,A([e,t],n,!0),void 0,(function(e,t,n){var r,o;return void 0===n&&(n=F),O(this,(function(i){switch(i.label){case 0:r=t.split(""),o=0,i.label=1;case 1:return o<r.length?(e((function(e){return e+r[o]})),[4,B(n)]):[3,4];case 2:i.sent(),i.label=3;case 3:return o++,[3,1];case 4:return[2]}}))}))},me=function(e,t,n){return void 0===n&&(n=F),new Promise((function(r){var o=t.split(""),i=0;!function t(){if(i<o.length){var a=o[i],l=e.getSelection();e.executeEdits("simulateTyping",[{range:{startLineNumber:(null==l?void 0:l.selectionStartLineNumber)||1,startColumn:(null==l?void 0:l.selectionStartColumn)||1,endLineNumber:(null==l?void 0:l.endLineNumber)||1,endColumn:(null==l?void 0:l.endColumn)||1},text:a||"",forceMoveMarkers:!0}]),e.revealPositionInCenter({lineNumber:(null==l?void 0:l.endLineNumber)||1,column:(null==l?void 0:l.endColumn)||1}),e.focus(),i++,setTimeout(t,n)}else r()}()}))},ye=function(e,t,n,r,o,i,a,l,s,c,u,d,f,p,v,g,x,m,y,b,w){for(var j=[],S=21;S<arguments.length;S++)j[S-21]=arguments[S];return M(void 0,A([e,t,n,r,o,i,a,l,s,c,u,d,f,p,v,g,x,m,y,b,w],j,!0),void 0,(function(e,t,n,r,o,i,a,l,s,c,u,d,f,p,v,g,x,m,y,b,w,j,S,C){var E,P,N,M,A,I,R,T,z,L,V,U,D,J,H,q,_;return void 0===j&&(j=F),void 0===S&&(S=k),O(this,(function(C){switch(C.label){case 0:switch(E=-1,P=ue(t,n,r),N=P.editors,M=P.currentEditor,A=P.currentFilename,I=P.currentCaretPosition,R=P.currentCode,o.name){case"file-explorer-open-file":console.log("SET CURRENT FILE to ",o.value),a(N),l(M),s(A),c(R),u(I),(T=e.getModel())&&T.getValue()!==R&&T.setValue(R);break;case"mouse-left-click":c(R),(z=e.getModel())&&z.getValue()!==R&&z.setValue(R)}return[4,B(S)];case 1:C.sent(),!(L=ge(f,o,p))||void 0===L.x||void 0===L.y||isNaN(L.x)||isNaN(L.y)?console.warn("Invalid mouse position from getNewMousePosition, keeping current position:",L):v(L),V=(0,h.xQ)(o.name)?parseInt(o.value):1,U=e.getPosition(),console.log("Editor position is at line ".concat(null==U?void 0:U.lineNumber,", column ").concat(null==U?void 0:U.column)),D=function(t){var n,r,a,l,s,c,u,f,p,h,v,C,k,F,E;return O(this,(function(t){switch(t.label){case 0:switch(!0,!0){case o.name.startsWith("external-"):case o.name.startsWith("slides-"):return[3,1];case"author-speak-before"===o.name:case"author-speak-during"===o.name:case"author-speak-after"===o.name:return[3,2];case"author-wait"===o.name:return[3,6];case"file-explorer-type-new-file-input"===o.name:return[3,8];case"file-explorer-enter-new-file-input"===o.name:return[3,9];case"file-explorer-type-new-folder-input"===o.name:return[3,10];case"file-explorer-enter-new-folder-input"===o.name:return[3,11];case"file-explorer-type-rename-file-input"===o.name:return[3,12];case"file-explorer-enter-rename-file-input"===o.name:return[3,13];case"file-explorer-type-rename-folder-input"===o.name:return[3,14];case"file-explorer-enter-rename-folder-input"===o.name:return[3,15];case"terminal-type"===o.name:return[3,16];case"editor-arrow-down"===o.name&&null!==U:return[3,21];case"editor-arrow-up"===o.name&&null!==U:return[3,23];case"editor-tab"===o.name&&null!==U:return[3,25];case"editor-arrow-left"===o.name&&null!==U:return[3,27];case"editor-arrow-right"===o.name&&null!==U:return[3,29];case"editor-enter"===o.name:return[3,31];case"editor-command-right"===o.name&&null!==U:return[3,33];case"editor-space"===o.name:return[3,35];case"editor-backspace"===o.name:return[3,37];case"editor-type"===o.name:return[3,39];case"editor-scroll-up"===o.name:return[3,41];case"editor-scroll-down"===o.name:return[3,43];case o.name.startsWith("mouse-move-"):return[3,45]}return[3,47];case 1:return[3,48];case 2:return g(o.value),n=null===(H=x.find((function(e){return e.text===o.value})))||void 0===H?void 0:H.mp3Url,"author-speak-during"!==o.name?[3,3]:(W(o.value,i?1:0,n),[3,5]);case 3:return[4,W(o.value,i?1:0,n)];case 4:t.sent(),t.label=5;case 5:return[3,48];case 6:return r=parseInt(o.value)||1e3,console.log("Waiting for ".concat(r,"ms")),[4,B(r)];case 7:return t.sent(),[3,48];case 8:return xe(m,o.value,j),[3,48];case 9:return m(""),[3,48];case 10:return xe(y,o.value,j),[3,48];case 11:return y(""),[3,48];case 12:return xe(b,o.value,j),[3,48];case 13:return b(""),[3,48];case 14:return xe(w,o.value,j),[3,48];case 15:return w(""),[3,48];case 16:if(a=o.value,l=a.split("\n"),!(s=l[l.length-1]))return[3,20];c=function(e){return O(this,(function(t){switch(t.label){case 0:return d((function(t){return t+s[e]})),[4,B(j)];case 1:return t.sent(),[2]}}))},u=0,t.label=17;case 17:return u<s.length?[5,c(u)]:[3,20];case 18:t.sent(),t.label=19;case 19:return u++,[3,17];case 20:return[3,48];case 21:return U.lineNumber=U.lineNumber+1,e.setPosition(U),[4,B(j)];case 22:return t.sent(),[3,48];case 23:return U.lineNumber=U.lineNumber-1,e.setPosition(U),[4,B(j)];case 24:return t.sent(),[3,48];case 25:return U.lineNumber=U.lineNumber+2,e.setPosition(U),[4,B(j)];case 26:return t.sent(),[3,48];case 27:return U.column=U.column-1,e.setPosition(U),[4,B(j)];case 28:return t.sent(),[3,48];case 29:return U.column=U.column+1,e.setPosition(U),[4,B(j)];case 30:return t.sent(),[3,48];case 31:return[4,me(e,"\n",j)];case 32:return t.sent(),[3,48];case 33:return U.column=1e5,e.setPosition(U),[4,B(j)];case 34:return t.sent(),[3,48];case 35:return[4,me(e," ",j)];case 36:return t.sent(),[3,48];case 37:for(f=parseInt(o.value)||1,p=0;p<f;p++)e.trigger(1,"deleteLeft");return[4,B(j)];case 38:return t.sent(),[3,48];case 39:return[4,me(e,o.value,j)];case 40:return t.sent(),[3,48];case 41:return h=parseInt(o.value)||3,v=(null===(q=e.getPosition())||void 0===q?void 0:q.lineNumber)||1,C=Math.max(1,v-h),e.revealLineInCenterIfOutsideViewport(C),[4,B(S)];case 42:return t.sent(),[3,48];case 43:return k=parseInt(o.value)||3,F=(null===(_=e.getPosition())||void 0===_?void 0:_.lineNumber)||1,E=F+k,e.revealLineInCenterIfOutsideViewport(E),[4,B(S)];case 44:return t.sent(),[3,48];case 45:return[4,B(S+300)];case 46:return t.sent(),[3,48];case 47:return console.warn("Unable to apply action",JSON.stringify(o)),[3,48];case 48:return[2]}}))},J=0,C.label=2;case 2:return J<V?[5,D(J)]:[3,5];case 3:C.sent(),C.label=4;case 4:return J++,[3,2];case 5:return[2,E]}}))}))};function be(e){var t=this,n=e.theme,s=e.project,c=e.mode,u=e.allowFocusInEditor,d=e.defaultLanguage,f=e.currentActionIndex,p=e.currentLessonIndex,v=e.isSoundOn,g=e.withCaptions,x=e.actionFinishedCallback,m=e.playBackCompleteCallback,y=e.speakActionAudios,b=e.fileExplorerWidth,w=e.terminalHeight,N=e.mouseColor,A=e.fontSizePx,R=e.monacoLoadedCallback,L=e.isEmbedMode,U=e.requestStepModeCallback,H=e.requestNextActionCallback,q=e.requestPreviousActionCallback,_=e.requestPlaybackStartCallback,G=e.isFileExplorerVisible,Y=void 0===G||G,ne=e.isTerminalVisible,re=void 0===ne||ne,ie=e.keyboardTypingPauseMs,ae=void 0===ie?F:ie,le=e.standardPauseMs,se=void 0===le?k:le,de=e.longPauseMs,fe=void 0===de?C:de,pe=e.resolution,he=void 0===pe?"1080p":pe,ve=e.showDevBox,xe=void 0!==ve&&ve,me="record"===c,be=(0,o.useState)(),we=be[0],je=be[1],Se=(0,o.useState)(),Ce=Se[0],ke=Se[1],Fe=(0,o.useState)(),Ee=Fe[0],Pe=Fe[1],Ne=(0,o.useState)(),Me=Ne[0],Oe=Ne[1],Ae=(0,o.useState)(""),Ie=Ae[0],Re=Ae[1],Te=(0,o.useState)(""),ze=Te[0],Le=Te[1],Ve=(0,o.useState)(P),Be=Ve[0],We=Ve[1],Ue=(0,o.useState)(P),De=Ue[0],Je=Ue[1],He=(0,o.useState)(E),qe=He[0],_e=He[1],Ge=(0,o.useState)(""),Xe=Ge[0],Ze=Ge[1],Ye=(0,o.useState)(d);Ye[0];var Qe=Ye[1],Ke=(0,o.useState)(L||!1),$e=Ke[0],et=Ke[1],tt=(0,o.useState)(!1),nt=tt[0],rt=tt[1],ot=(0,o.useState)(!1),it=ot[0],at=ot[1],lt=(0,o.useState)(!1),st=lt[0],ct=lt[1],ut=(0,o.useState)(!1),dt=ut[0],ft=ut[1],pt=(0,o.useState)(!1),ht=pt[0],vt=pt[1],gt=(0,o.useState)(""),xt=gt[0],mt=gt[1],yt=(0,o.useState)(""),bt=yt[0],wt=yt[1],jt=(0,o.useState)(""),St=jt[0],Ct=jt[1],kt=(0,o.useState)(""),Ft=kt[0],Et=kt[1],Pt=(0,o.useState)(""),Nt=Pt[0],Mt=Pt[1],Ot=(0,o.useState)(""),At=Ot[0],It=Ot[1],Rt=(0,o.useState)(""),Tt=Rt[0],zt=Rt[1],Lt=(0,o.useState)(""),Vt=Lt[0],Bt=Lt[1],Wt=(0,o.useState)(""),Ut=Wt[0],Dt=Wt[1],Jt=(0,o.useState)(""),Ht=Jt[0],qt=Jt[1],_t=(0,o.useState)("");_t[0];var Gt=_t[1],Xt=(0,o.useState)(!1),Zt=Xt[0],Yt=Xt[1],Qt=(0,o.useState)(""),Kt=Qt[0],$t=Qt[1],en=(0,o.useState)(!1),tn=en[0],nn=en[1],rn=(0,o.useState)(""),on=rn[0],an=rn[1],ln=(0,o.useState)(!1),sn=ln[0],cn=ln[1],un=(0,o.useState)([]),dn=un[0],fn=un[1],pn=(0,o.useState)(!1),hn=pn[0],vn=pn[1],gn=(0,o.useState)(null),xn=gn[0],mn=gn[1],yn=(0,o.useState)(-1),bn=yn[0],wn=yn[1],jn=(0,o.useState)(!1),Sn=jn[0],Cn=jn[1],kn=(0,o.useState)(0),Fn=kn[0],En=kn[1],Pn=(0,o.useRef)(null),Nn=(0,o.useRef)(void 0),Mn=(0,o.useRef)(void 0),On=(0,o.useRef)(null),An=(0,o.useRef)(!1),In=(0,h.EJ)(s,p),Rn=function(){return M(t,void 0,void 0,(function(){var e,t,n;return O(this,(function(r){switch(r.label){case 0:return console.log("[applyAnimation] Starting animation for action index:",f,"in lesson index:",p),console.log("[applyAnimation] Project type:",Array.isArray(s)?"actions array":typeof s),console.log("[applyAnimation] Project length/structure:",Array.isArray(s)?s.length:Object.keys(s||{}).length),console.log("[applyAnimation] Extracted actions for current lesson:",In.length,"actions."),In.length>0&&console.log("[applyAnimation] First few actions:",In.slice(0,3).map((function(e){var t;return{name:e.name,value:(null===(t=e.value)||void 0===t?void 0:t.substring(0,50))+"..."}}))),0===In.length?(console.log("[applyAnimation] No actions found - project may not be fully loaded yet. Skipping animation."),console.log("[applyAnimation] Project data:",s),[2]):(e=f>=0&&f<In.length?In[f]:null)?(console.log("[applyAnimation] About to execute action:",e.name,"with value:",(null===(n=e.value)||void 0===n?void 0:n.substring(0,100))+"..."),Nn.current?[4,ye(Nn.current,s,f,p,e,v,je,ke,Pe,Re,_e,Le,Be,Pn,We,Ze,y,mt,wt,Mt,It,ae,se,fe)]:[3,3]):(console.log("[applyAnimation] No current action found, calling playback complete callback."),console.log("[applyAnimation] currentActionIndex:",f,"actions.length:",In.length),m&&m(),[2]);case 1:return r.sent(),"external-browser-scroll"!==e.name?[3,3]:(t=parseInt(e.value)||0,En(t),[4,B(se)]);case 2:r.sent(),r.label=3;case 3:return zn(),x&&x(),[2]}}))}))},Tn=function(){if(s&&(!Array.isArray(s)||0!==s.length)){var e=f>=0&&f<In.length?In[f]:null;if(e)switch(e.name){case"editor-scroll-up":if(Nn.current){var t=parseInt(e.value)||3,n=Nn.current.getPosition(),r=(null==n?void 0:n.lineNumber)||1;Nn.current.revealLineInCenter(Math.max(1,r-t))}break;case"editor-scroll-down":if(Nn.current){var o=parseInt(e.value)||3,i=Nn.current.getPosition(),a=(null==i?void 0:i.lineNumber)||1;Nn.current.revealLineInCenter(a+o)}break;case"external-browser-scroll":var l=parseInt(e.value)||0;En(l)}}},zn=function(){if(!s||Array.isArray(s)&&0===s.length)return console.log("[updateState] Project is empty or not loaded yet, skipping state update"),void console.log("[updateState] Project:",s);console.log("[updateState] Updating state for action index:",f,"lesson index:",p),console.log("[updateState] Project type:",Array.isArray(s)?"actions array":typeof s);var e=ue(s,f,p),t=e.editors,n=e.currentEditor,r=e.currentFilename,o=e.fileExplorerSnapshot,i=e.currentCode,a=e.currentCaretPosition,l=e.currentTerminalBuffer,u=e.captionText,d=e.actions,h=e.mouseSnapshot,v=e.isUnsavedChangesDialogOpen,g=e.unsavedFileName;console.log("[updateState] Reconstituted state:"),console.log("  - editors count:",(null==t?void 0:t.length)||0),console.log("  - currentEditor:",(null==n?void 0:n.filename)||"none"),console.log("  - actions count:",(null==d?void 0:d.length)||0),console.log("  - fileStructure keys:",Object.keys((null==o?void 0:o.fileStructure)||{})),je(t),ke(n),Pe(r),Oe(o.fileStructure),"step"===c&&(Re(i),setTimeout((function(){_e(a)}),0),mt(o.newFileInputValue),wt(o.newFolderInputValue),setTimeout((function(){Tn()}),0),Ln(d)),Le(l),Ze(u),rt(o.isFileExplorerContextMenuOpen),at(o.isFileContextMenuOpen),ct(o.isFolderContextMenuOpen),ft(o.isNewFileInputVisible),vt(o.isNewFolderInputVisible),Ct(o.originalFileBeingRenamed),Et(o.originalFolderBeingRenamed),zt(h.currentHoveredFileName),Bt(h.currentHoveredFolderName),Dt(o.newFileParentPath),qt(o.newFolderParentPath),Gt(h.currentHoveredEditorTabFileName),Yt(v),$t(g)},Ln=function(e){if(0!==f||"step"!==c){var t=f>=0&&f<e.length?e[f]:null;if(t){var n=ge(Be,t,Pn);!n||isNaN(n.x)||isNaN(n.y)||void 0===n.x||void 0===n.y?console.warn("Invalid mouse position detected, keeping current position:",n):(console.log("Action: ".concat(t.name,", New position: x=").concat(n.x,", y=").concat(n.y)),We(n))}}else{if(!(null==Pn?void 0:Pn.current))return;var r=Pn.current.getBoundingClientRect();We({x:r.width/2,y:r.height/2})}};(0,o.useEffect)((function(){if(s&&(!Array.isArray(s)||0!==s.length)){var e=f>=0&&f<In.length?In[f]:null,t=f>bn;if(e)if("slide-display"===e.name)nn(!0),an(e.value);else if("external-web-preview"===e.name){cn(!0);var n=new j.e(s);n.applyActions(In.slice(0,f+1)),fn(n.getFullFilePathsAndContents())}else"external-browser"===e.name||"external-browser-scroll"===e.name?(vn(!0),mn(e.value)):e.name.startsWith("author-")&&t||(nn(!1),an(""),cn(!1),fn([]),vn(!1),mn(null));else nn(!1),an(""),cn(!1),fn([]),vn(!1),mn(null);("step"===c||f>0)&&wn(f)}}),[f,s,p,c]),(0,o.useEffect)((function(){if(s&&(!Array.isArray(s)||0!==s.length)){var e=f>=0&&f<In.length?In[f]:null;if(e&&e.name.startsWith("terminal-")){Cn(!0);var t=setTimeout((function(){Cn(!1)}),2e3);return function(){return clearTimeout(t)}}Cn(!1)}}),[f,s,p]),(0,o.useEffect)((function(){var e;if(s&&(!Array.isArray(s)||0!==s.length)){var t=f>=0&&f<In.length?In[f]:null;if(v&&"step"===c&&t&&t.name.startsWith("author-")){var n=t,r=null===(e=y.find((function(e){return e.text===n.value})))||void 0===e?void 0:e.mp3Url;W(t.value,1,r)}else D()}}),[v,s,f,p]),(0,o.useEffect)((function(){if(console.log("[Main useEffect] Triggered with:",{mode:c,currentActionIndex:f,projectType:Array.isArray(s)?"array":typeof s,projectLength:Array.isArray(s)?s.length:"N/A"}),!s||Array.isArray(s)&&0===s.length)return console.log("[Main useEffect] Project is empty or not loaded yet, skipping update"),void console.log("[Main useEffect] Project value:",s);if(console.log("[Main useEffect] Project appears loaded, proceeding..."),"step"===c)return console.log("[Main useEffect] Step mode - calling updateState"),void zn();if("replay"===c){if(console.log("[Main useEffect] Replay mode detected"),0===f)return console.log("[Main useEffect] First action (index 0) in replay mode"),console.log("[Main useEffect] About to extract actions from project"),console.log("[Main useEffect] Project type:",Array.isArray(s)?"array":typeof s),console.log("[Main useEffect] Project keys:",s?JSON.stringify(Object.keys(s)):"null"),console.log("[Main useEffect] currentLessonIndex:",p),console.log("[Main useEffect] Extracted actions count:",In.length),0===In.length?(console.log("[Main useEffect] No actions found in project - waiting for project to be loaded"),void console.log("[Main useEffect] Project structure:",JSON.stringify(s,null,2))):(console.log("[Main useEffect] Actions found, updating state first"),zn(),console.log("[Main useEffect] Setting 1-second timeout before starting animation"),void setTimeout((function(){console.log("[Main useEffect] Timeout expired, calling applyAnimation"),Rn()}),1e3));console.log("[Main useEffect] Non-first action in replay mode, calling applyAnimation directly"),Rn()}}),[c,f,s]);(0,o.useEffect)((function(){if(!An.current&&Nn.current&&("step"===c||"replay"===c)){var e=setTimeout((function(){Nn.current&&(Nn.current.setPosition({lineNumber:qe.row,column:qe.col}),Nn.current.revealPosition({lineNumber:qe.row,column:qe.col}),u&&Nn.current.focus())}),0);return function(){return clearTimeout(e)}}}),[qe,u,c]),(0,o.useEffect)((function(){if("step"===c&&Nn.current&&!An.current){var e=setTimeout((function(){Nn.current&&(Nn.current.setPosition({lineNumber:qe.row,column:qe.col}),Nn.current.revealPositionInCenter({lineNumber:qe.row,column:qe.col}),u&&Nn.current.focus())}),10);return function(){return clearTimeout(e)}}}),[Ie,c,qe,u]),(0,o.useEffect)((function(){var e=tn||sn||hn;if(Nn.current)if(e&&!On.current)console.log("Saving editor view state before overlay, current position:",Nn.current.getPosition()),On.current=Nn.current.saveViewState();else if(!e&&On.current){var t=On.current;console.log("Restoring editor view state after overlay"),On.current=null,An.current=!0,setTimeout((function(){Nn.current&&t&&(console.log("Actually restoring view state, current position before restore:",Nn.current.getPosition()),Nn.current.restoreViewState(t),console.log("Position after restore:",Nn.current.getPosition()),console.log("Expected position:",{row:qe.row,col:qe.col}),Nn.current.setPosition({lineNumber:qe.row,column:qe.col}),Nn.current.revealPositionInCenter({lineNumber:qe.row,column:qe.col}),console.log("Final position after manual set:",Nn.current.getPosition()),An.current=!1)}),0)}}),[tn,sn,hn,qe]),(0,o.useEffect)((function(){if(Nn.current&&Mn.current){var e=Mn.current,t=Nn.current;if(!(null==Ce?void 0:Ce.filename))return void(t.getModel()&&(t.setModel(null),console.log("Cleared Monaco editor model - no active editor")));var n=Ce.filename,r=e.Uri.file(n),o=e.editor.getModel(r);if(o)"step"===c&&o.getValue()!==Ie?(o.setValue(Ie||""),console.log("Updated Monaco model content for file: ".concat(n," (step mode), content length: ").concat((Ie||"").length))):"replay"===c&&""===o.getValue()&&Ie&&""!==Ie&&(o.setValue(Ie),console.log("Initialized Monaco model content for file: ".concat(n," (replay mode), content length: ").concat(Ie.length)));else{var i=J(n);o=e.editor.createModel(Ie||"",i,r),console.log("Created new Monaco model for file: ".concat(n," with language: ").concat(i,", content length: ").concat((Ie||"").length))}t.getModel()!==o&&(t.setModel(o),console.log("Switched Monaco editor to model for file: ".concat(n)))}}),[null==Ce?void 0:Ce.filename,Ie,c]),(0,o.useEffect)((function(){if(Ee){var e=J(Ee);if(Qe(e),Nn.current&&Mn.current){var t=Nn.current.getModel();t&&Mn.current.editor.setModelLanguage(t,e)}}}),[Ee]),(0,o.useEffect)((function(){if(L){var e=function(e){"ArrowRight"===e.key?(et(!1),U&&U("step"),H&&H()):"ArrowLeft"===e.key?(et(!1),U&&U("step"),q&&q()):" "===e.key&&(et(!1),_&&_())};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}}),[L]),console.log("currentCode",Ie);var Vn=A&&"4K"===he?2*A:A,Bn=dn,Wn=xn,Un=f>=0&&f<In.length?In[f]:null;return(0,r.jsxs)(l.k,{direction:"column",style:{height:"100%",width:"100%",fontSize:Vn?"".concat(Vn,"px"):void 0,position:"relative"},id:S,children:[(0,r.jsxs)(l.k,{direction:"row",style:{height:"100%",overflow:"hidden",position:"relative"},ref:Pn,children:[Y&&(0,r.jsx)(X,{theme:n,currentFileName:Ee,fileStructure:Me,fileExplorerWidth:b,currentMousePosition:De,isFileExplorerContextMenuVisible:nt,isFileContextMenuVisible:it,isFolderContextMenuVisible:st,isNewFileInputVisible:dt,isNewFolderInputVisible:ht,newFileInputValue:xt,newFolderInputValue:bt,originalFileBeingRenamed:St,originalFolderBeingRenamed:Ft,renameFileInputValue:Nt,renameFolderInputValue:At,currentHoveredFileName:Tt,currentHoveredFolderName:Vt,newFileParentPath:Ut,newFolderParentPath:Ht}),(0,r.jsxs)(l.k,{"data-codevideo-id":T,"data-testid":"editor-area",direction:"column",width:"100%",children:[(0,r.jsx)(I,{theme:n,editors:we||[],currentEditor:Ce}),(0,r.jsxs)(a.x,{"data-codevideo-id":z,style:{flex:1,position:"relative",userSelect:me?"auto":"none"},children:[(0,r.jsx)(a.x,{style:{display:we&&0===we.length?"block":"none",backgroundColor:"light"===n?"var(--gray-5)":"var(--gray-4)",height:"100%",width:"100%"}}),(0,r.jsx)(a.x,{style:{display:we&&0===we.length?"none":"block",backgroundColor:"light"===n?"var(--gray-5)":"var(--gray-4)",height:"100%",width:"100%",pointerEvents:me?"auto":"none",cursor:me?"auto":"none",userSelect:me?"auto":"none"},children:(0,r.jsx)(i.ML,{path:null==Ce?void 0:Ce.filename,theme:"light"===n?"vs":"vs-dark",className:"no-mouse ".concat(we&&0===we.length?"display-none":"display-block"),value:me||"replay"===c?void 0:Ie,defaultValue:me?Ie:void 0,defaultLanguage:d,options:{automaticLayout:!0,minimap:{enabled:!0},scrollBeyondLastLine:!0,fontSize:Vn||14,fontFamily:"Fira Code, monospace",fontLigatures:!0,readOnly:"step"===c,lineNumbers:"on",renderWhitespace:"selection",wrappingStrategy:"advanced",wordWrap:"on",wordWrapColumn:80,bracketPairColorization:{enabled:!0},matchBrackets:"never",formatOnPaste:!0,formatOnType:!0},onMount:function(e,t){Nn.current=e,Mn.current=t,R&&R()}})})]}),re&&(0,r.jsx)(Z,{theme:n,terminalBuffer:ze,terminalHeight:w,fontSizePx:Vn,showBlockCaret:Sn})]}),tn&&(0,r.jsx)(a.x,{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1e3,backgroundColor:"var(--gray-1)"},children:(0,r.jsx)(oe,{hljsTheme:"monokai",slideMarkdown:on,fontSizePx:Vn})}),hn&&Wn&&(0,r.jsx)(a.x,{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1e3,backgroundColor:"var(--gray-1)"},children:(0,r.jsx)(V,{url:Wn,mode:c,scrollPosition:Fn})}),sn&&(0,r.jsx)(a.x,{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1e3,backgroundColor:"var(--gray-1)"},children:(0,r.jsx)(ce,{files:Bn})})]}),(0,r.jsx)(ee,{isUnsavedChangesDialogOpen:Zt,unsavedFileName:Kt}),!$e&&(0,r.jsx)(Q,{mode:c,mouseVisible:!0,targetMousePosition:Be,maximumAnimationDuration:se,onCurrentPositionChange:Je,onAnimationFinished:function(){},mouseColor:N}),!$e&&g&&(0,r.jsx)(K,{captionText:Xe,fontSizePx:Vn}),xe&&(0,r.jsx)(te,{variables:{currentMousePosition:De,currentCaretPosition:qe,currentFileName:Ee,currentCode:Ie.substring(0,50)+"...",actionLength:In.length,currentActionIndex:f,currentAction:Un}}),$e&&(0,r.jsx)($,{})]})}}}]);
//# sourceMappingURL=fafb94f6-a3b8844d97fdec570cdc.js.map